{"version":3,"file":"index.esm.js","sources":["../src/routes.ts","../src/plugin.ts","../src/components/Cards/Group/MembersList/MembersListCard.tsx","../src/components/Cards/Group/GroupProfile/GroupProfileCard.tsx","../src/components/Cards/User/UserProfileCard/UserProfileCard.tsx","../src/components/Cards/OwnershipCard/OwnershipCard.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createExternalRouteRef } from '@backstage/core-plugin-api';\n\nexport const catalogIndexRouteRef = createExternalRouteRef({\n  id: 'catalog-index',\n});\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  createComponentExtension,\n  createPlugin,\n} from '@backstage/core-plugin-api';\nimport { catalogIndexRouteRef } from './routes';\n\nexport const orgPlugin = createPlugin({\n  id: 'org',\n  externalRoutes: {\n    catalogIndex: catalogIndexRouteRef,\n  },\n});\n\nexport const EntityGroupProfileCard = orgPlugin.provide(\n  createComponentExtension({\n    name: 'EntityGroupProfileCard',\n    component: {\n      lazy: () => import('./components').then(m => m.GroupProfileCard),\n    },\n  }),\n);\nexport const EntityMembersListCard = orgPlugin.provide(\n  createComponentExtension({\n    name: 'EntityMembersListCard',\n    component: {\n      lazy: () => import('./components').then(m => m.MembersListCard),\n    },\n  }),\n);\nexport const EntityOwnershipCard = orgPlugin.provide(\n  createComponentExtension({\n    name: 'EntityOwnershipCard',\n    component: {\n      lazy: () => import('./components').then(m => m.OwnershipCard),\n    },\n  }),\n);\nexport const EntityUserProfileCard = orgPlugin.provide(\n  createComponentExtension({\n    name: 'EntityUserProfileCard',\n    component: {\n      lazy: () => import('./components').then(m => m.UserProfileCard),\n    },\n  }),\n);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  DEFAULT_NAMESPACE,\n  GroupEntity,\n  UserEntity,\n  stringifyEntityRef,\n} from '@backstage/catalog-model';\nimport {\n  catalogApiRef,\n  entityRouteParams,\n  useEntity,\n} from '@backstage/plugin-catalog-react';\nimport {\n  Box,\n  createStyles,\n  Grid,\n  makeStyles,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport Pagination from '@material-ui/lab/Pagination';\nimport React from 'react';\nimport { generatePath } from 'react-router-dom';\nimport useAsync from 'react-use/lib/useAsync';\n\nimport {\n  Avatar,\n  InfoCard,\n  Progress,\n  ResponseErrorPanel,\n  Link,\n} from '@backstage/core-components';\nimport { useApi } from '@backstage/core-plugin-api';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      border: `1px solid ${theme.palette.divider}`,\n      boxShadow: theme.shadows[2],\n      borderRadius: '4px',\n      overflow: 'visible',\n      position: 'relative',\n      margin: theme.spacing(4, 1, 1),\n      flex: '1',\n      minWidth: '0px',\n    },\n  }),\n);\n\nconst MemberComponent = ({ member }: { member: UserEntity }) => {\n  const classes = useStyles();\n  const {\n    metadata: { name: metaName },\n    spec: { profile },\n  } = member;\n  const displayName = profile?.displayName ?? metaName;\n\n  return (\n    <Grid item container xs={12} sm={6} md={4} xl={2}>\n      <Box className={classes.card}>\n        <Box\n          display=\"flex\"\n          flexDirection=\"column\"\n          m={3}\n          alignItems=\"center\"\n          justifyContent=\"center\"\n        >\n          <Avatar\n            displayName={displayName}\n            picture={profile?.picture}\n            customStyles={{\n              position: 'absolute',\n              top: '-2rem',\n            }}\n          />\n          <Box pt={2} textAlign=\"center\">\n            <Typography variant=\"h5\">\n              <Link\n                to={generatePath(\n                  `/catalog/:namespace/user/${metaName}`,\n                  entityRouteParams(member),\n                )}\n              >\n                {displayName}\n              </Link>\n            </Typography>\n            {profile?.email && (\n              <Link to={`mailto:${profile.email}`}>{profile.email}</Link>\n            )}\n          </Box>\n        </Box>\n      </Box>\n    </Grid>\n  );\n};\n\nexport const MembersListCard = (_props: {\n  memberDisplayTitle?: string;\n  pageSize?: number;\n}) => {\n  const { entity: groupEntity } = useEntity<GroupEntity>();\n  let { memberDisplayTitle, pageSize } = _props;\n  const {\n    metadata: { name: groupName, namespace: grpNamespace },\n    spec: { profile },\n  } = groupEntity;\n  const catalogApi = useApi(catalogApiRef);\n\n  const displayName = profile?.displayName ?? groupName;\n\n  const groupNamespace = grpNamespace || DEFAULT_NAMESPACE;\n\n  const [page, setPage] = React.useState(1);\n  const pageChange = (_: React.ChangeEvent<unknown>, pageIndex: number) => {\n    setPage(pageIndex);\n  };\n  pageSize = pageSize ? pageSize : 50;\n  memberDisplayTitle = memberDisplayTitle ? memberDisplayTitle : 'Members';\n\n  const {\n    loading,\n    error,\n    value: members,\n  } = useAsync(async () => {\n    const membersList = await catalogApi.getEntities({\n      filter: {\n        kind: 'User',\n        'relations.memberof': [\n          stringifyEntityRef({\n            kind: 'group',\n            namespace: groupNamespace.toLocaleLowerCase('en-US'),\n            name: groupName.toLocaleLowerCase('en-US'),\n          }),\n        ],\n      },\n    });\n\n    return membersList.items as UserEntity[];\n  }, [catalogApi, groupEntity]);\n\n  if (loading) {\n    return <Progress />;\n  } else if (error) {\n    return <ResponseErrorPanel error={error} />;\n  }\n\n  const nbPages = Math.ceil((members?.length || 0) / pageSize);\n  const paginationLabel = nbPages < 2 ? '' : `, page ${page} of ${nbPages}`;\n\n  const pagination = (\n    <Pagination\n      count={nbPages}\n      page={page}\n      onChange={pageChange}\n      showFirstButton\n      showLastButton\n    />\n  );\n\n  return (\n    <Grid item>\n      <InfoCard\n        title={`${memberDisplayTitle} (${\n          members?.length || 0\n        }${paginationLabel})`}\n        subheader={`of ${displayName}`}\n        {...(nbPages <= 1 ? {} : { actions: pagination })}\n      >\n        <Grid container spacing={3}>\n          {members && members.length > 0 ? (\n            members\n              .slice(pageSize * (page - 1), pageSize * page)\n              .map(member => (\n                <MemberComponent member={member} key={member.metadata.uid} />\n              ))\n          ) : (\n            <Box p={2}>\n              <Typography>\n                This group has no {memberDisplayTitle.toLocaleLowerCase()}.\n              </Typography>\n            </Box>\n          )}\n        </Grid>\n      </InfoCard>\n    </Grid>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  GroupEntity,\n  RELATION_CHILD_OF,\n  RELATION_PARENT_OF,\n  ANNOTATION_LOCATION,\n  stringifyEntityRef,\n  ANNOTATION_EDIT_URL,\n} from '@backstage/catalog-model';\nimport {\n  catalogApiRef,\n  EntityRefLinks,\n  getEntityRelations,\n  useEntity,\n} from '@backstage/plugin-catalog-react';\nimport {\n  Box,\n  Grid,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Tooltip,\n  IconButton,\n} from '@material-ui/core';\nimport AccountTreeIcon from '@material-ui/icons/AccountTree';\nimport EmailIcon from '@material-ui/icons/Email';\nimport GroupIcon from '@material-ui/icons/Group';\nimport EditIcon from '@material-ui/icons/Edit';\nimport CachedIcon from '@material-ui/icons/Cached';\nimport Alert from '@material-ui/lab/Alert';\nimport React, { useCallback } from 'react';\nimport {\n  Avatar,\n  InfoCard,\n  InfoCardVariants,\n  Link,\n} from '@backstage/core-components';\nimport { alertApiRef, useApi } from '@backstage/core-plugin-api';\n\nconst CardTitle = ({ title }: { title: string }) => (\n  <Box display=\"flex\" alignItems=\"center\">\n    <GroupIcon fontSize=\"inherit\" />\n    <Box ml={1}>{title}</Box>\n  </Box>\n);\n\nexport const GroupProfileCard = ({\n  variant,\n}: {\n  variant?: InfoCardVariants;\n}) => {\n  const catalogApi = useApi(catalogApiRef);\n  const alertApi = useApi(alertApiRef);\n  const { entity: group } = useEntity<GroupEntity>();\n\n  const refreshEntity = useCallback(async () => {\n    await catalogApi.refreshEntity(stringifyEntityRef(group));\n    alertApi.post({ message: 'Refresh scheduled', severity: 'info' });\n  }, [catalogApi, alertApi, group]);\n\n  if (!group) {\n    return <Alert severity=\"error\">Group not found</Alert>;\n  }\n\n  const {\n    metadata: { name, description, annotations },\n    spec: { profile },\n  } = group;\n\n  const childRelations = getEntityRelations(group, RELATION_PARENT_OF, {\n    kind: 'Group',\n  });\n  const parentRelations = getEntityRelations(group, RELATION_CHILD_OF, {\n    kind: 'group',\n  });\n\n  const entityLocation = annotations?.[ANNOTATION_LOCATION];\n  const allowRefresh =\n    entityLocation?.startsWith('url:') || entityLocation?.startsWith('file:');\n\n  const entityMetadataEditUrl =\n    group.metadata.annotations?.[ANNOTATION_EDIT_URL];\n\n  const displayName = profile?.displayName ?? name;\n  const emailHref = profile?.email ? `mailto:${profile.email}` : '#';\n  const infoCardAction = entityMetadataEditUrl ? (\n    <IconButton\n      aria-label=\"Edit\"\n      title=\"Edit Metadata\"\n      component={Link}\n      to={entityMetadataEditUrl}\n    >\n      <EditIcon />\n    </IconButton>\n  ) : (\n    <IconButton aria-label=\"Edit\" disabled title=\"Edit Metadata\">\n      <EditIcon />\n    </IconButton>\n  );\n\n  return (\n    <InfoCard\n      title={<CardTitle title={displayName} />}\n      subheader={description}\n      variant={variant}\n      action={\n        <>\n          {allowRefresh && (\n            <IconButton\n              aria-label=\"Refresh\"\n              title=\"Schedule entity refresh\"\n              onClick={refreshEntity}\n            >\n              <CachedIcon />\n            </IconButton>\n          )}\n          {infoCardAction}\n        </>\n      }\n    >\n      <Grid container spacing={3}>\n        <Grid item xs={12} sm={2} xl={1}>\n          <Avatar displayName={displayName} picture={profile?.picture} />\n        </Grid>\n        <Grid item md={10} xl={11}>\n          <List>\n            {profile?.email && (\n              <ListItem>\n                <ListItemIcon>\n                  <Tooltip title=\"Email\">\n                    <EmailIcon />\n                  </Tooltip>\n                </ListItemIcon>\n                <ListItemText>\n                  <Link to={emailHref}>{profile.email}</Link>\n                </ListItemText>\n              </ListItem>\n            )}\n\n            {parentRelations.length ? (\n              <ListItem>\n                <ListItemIcon>\n                  <Tooltip title=\"Parent Group\">\n                    <AccountTreeIcon />\n                  </Tooltip>\n                </ListItemIcon>\n                <ListItemText>\n                  <EntityRefLinks\n                    entityRefs={parentRelations}\n                    defaultKind=\"Group\"\n                  />\n                </ListItemText>\n              </ListItem>\n            ) : null}\n\n            {childRelations.length ? (\n              <ListItem>\n                <ListItemIcon>\n                  <Tooltip title=\"Child Groups\">\n                    <GroupIcon />\n                  </Tooltip>\n                </ListItemIcon>\n                <ListItemText>\n                  <EntityRefLinks\n                    entityRefs={childRelations}\n                    defaultKind=\"Group\"\n                  />\n                </ListItemText>\n              </ListItem>\n            ) : null}\n          </List>\n        </Grid>\n      </Grid>\n    </InfoCard>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { RELATION_MEMBER_OF, UserEntity } from '@backstage/catalog-model';\nimport {\n  EntityRefLinks,\n  getEntityRelations,\n  useEntity,\n} from '@backstage/plugin-catalog-react';\nimport {\n  Box,\n  Grid,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Tooltip,\n} from '@material-ui/core';\nimport EmailIcon from '@material-ui/icons/Email';\nimport GroupIcon from '@material-ui/icons/Group';\nimport PersonIcon from '@material-ui/icons/Person';\nimport Alert from '@material-ui/lab/Alert';\nimport React from 'react';\nimport {\n  Avatar,\n  InfoCard,\n  InfoCardVariants,\n  Link,\n} from '@backstage/core-components';\n\nconst CardTitle = ({ title }: { title?: string }) =>\n  title ? (\n    <Box display=\"flex\" alignItems=\"center\">\n      <PersonIcon fontSize=\"inherit\" />\n      <Box ml={1}>{title}</Box>\n    </Box>\n  ) : null;\n\nexport const UserProfileCard = ({\n  variant,\n}: {\n  variant?: InfoCardVariants;\n}) => {\n  const { entity: user } = useEntity<UserEntity>();\n  if (!user) {\n    return <Alert severity=\"error\">User not found</Alert>;\n  }\n\n  const {\n    metadata: { name: metaName, description },\n    spec: { profile },\n  } = user;\n  const displayName = profile?.displayName ?? metaName;\n  const emailHref = profile?.email ? `mailto:${profile.email}` : undefined;\n  const memberOfRelations = getEntityRelations(user, RELATION_MEMBER_OF, {\n    kind: 'Group',\n  });\n\n  return (\n    <InfoCard\n      title={<CardTitle title={displayName} />}\n      subheader={description}\n      variant={variant}\n    >\n      <Grid container spacing={3} alignItems=\"flex-start\">\n        <Grid item xs={12} sm={2} xl={1}>\n          <Avatar displayName={displayName} picture={profile?.picture} />\n        </Grid>\n\n        <Grid item md={10} xl={11}>\n          <List>\n            {profile?.email && (\n              <ListItem>\n                <ListItemIcon>\n                  <Tooltip title=\"Email\">\n                    <EmailIcon />\n                  </Tooltip>\n                </ListItemIcon>\n                <ListItemText>\n                  <Link to={emailHref ?? ''}>{profile.email}</Link>\n                </ListItemText>\n              </ListItem>\n            )}\n\n            <ListItem>\n              <ListItemIcon>\n                <Tooltip title=\"Member of\">\n                  <GroupIcon />\n                </Tooltip>\n              </ListItemIcon>\n              <ListItemText>\n                <EntityRefLinks\n                  entityRefs={memberOfRelations}\n                  defaultKind=\"Group\"\n                />\n              </ListItemText>\n            </ListItem>\n          </List>\n        </Grid>\n      </Grid>\n    </InfoCard>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity, UserEntity } from '@backstage/catalog-model';\nimport {\n  InfoCard,\n  InfoCardVariants,\n  Link,\n  Progress,\n  ResponseErrorPanel,\n} from '@backstage/core-components';\nimport { useApi, useRouteRef } from '@backstage/core-plugin-api';\nimport {\n  catalogApiRef,\n  humanizeEntityRef,\n  isOwnerOf,\n  useEntity,\n} from '@backstage/plugin-catalog-react';\nimport { BackstageTheme } from '@backstage/theme';\nimport {\n  Box,\n  createStyles,\n  Grid,\n  makeStyles,\n  Typography,\n} from '@material-ui/core';\nimport qs from 'qs';\nimport React from 'react';\nimport pluralize from 'pluralize';\nimport useAsync from 'react-use/lib/useAsync';\nimport { catalogIndexRouteRef } from '../../../routes';\n\ntype EntityTypeProps = {\n  kind: string;\n  type: string;\n  count: number;\n};\n\nconst useStyles = makeStyles((theme: BackstageTheme) =>\n  createStyles({\n    card: {\n      border: `1px solid ${theme.palette.divider}`,\n      boxShadow: theme.shadows[2],\n      borderRadius: '4px',\n      padding: theme.spacing(2),\n      color: '#fff',\n      transition: `${theme.transitions.duration.standard}ms`,\n      '&:hover': {\n        boxShadow: theme.shadows[4],\n      },\n    },\n    bold: {\n      fontWeight: theme.typography.fontWeightBold,\n    },\n    entityTypeBox: {\n      background: (props: { type: string }) =>\n        theme.getPageTheme({ themeId: props.type }).backgroundImage,\n    },\n  }),\n);\n\nconst EntityCountTile = ({\n  counter,\n  type,\n  name,\n  url,\n}: {\n  counter: number;\n  type: string;\n  name: string;\n  url: string;\n}) => {\n  const classes = useStyles({ type });\n\n  return (\n    <Link to={url} variant=\"body2\">\n      <Box\n        className={`${classes.card} ${classes.entityTypeBox}`}\n        display=\"flex\"\n        flexDirection=\"column\"\n        alignItems=\"center\"\n      >\n        <Typography className={classes.bold} variant=\"h6\">\n          {counter}\n        </Typography>\n        <Typography className={classes.bold} variant=\"h6\">\n          {pluralize(name, counter)}\n        </Typography>\n      </Box>\n    </Link>\n  );\n};\n\nconst getQueryParams = (\n  owner: Entity,\n  selectedEntity: EntityTypeProps,\n): string => {\n  const ownerName = humanizeEntityRef(owner, { defaultKind: 'group' });\n  const { kind, type } = selectedEntity;\n  const filters = {\n    kind,\n    type,\n    owners: [ownerName],\n    user: 'all',\n  };\n  if (owner.kind === 'User') {\n    const user = owner as UserEntity;\n    filters.owners = [...filters.owners, ...user.spec.memberOf];\n  }\n  const queryParams = qs.stringify(\n    {\n      filters,\n    },\n    {\n      arrayFormat: 'repeat',\n    },\n  );\n\n  return queryParams;\n};\n\nexport const OwnershipCard = ({\n  variant,\n  entityFilterKind,\n}: {\n  variant?: InfoCardVariants;\n  entityFilterKind?: string[];\n}) => {\n  const { entity } = useEntity();\n  const catalogApi = useApi(catalogApiRef);\n  const catalogLink = useRouteRef(catalogIndexRouteRef);\n\n  const {\n    loading,\n    error,\n    value: componentsWithCounters,\n  } = useAsync(async () => {\n    const kinds = entityFilterKind ?? ['Component', 'API'];\n    const entitiesList = await catalogApi.getEntities({\n      filter: {\n        kind: kinds,\n      },\n      fields: [\n        'kind',\n        'metadata.name',\n        'metadata.namespace',\n        'spec.type',\n        'relations',\n      ],\n    });\n\n    const ownedEntitiesList = entitiesList.items.filter(component =>\n      isOwnerOf(entity, component),\n    );\n\n    const counts = ownedEntitiesList.reduce(\n      (acc: EntityTypeProps[], ownedEntity) => {\n        const match = acc.find(\n          x =>\n            x.kind === ownedEntity.kind &&\n            x.type === (ownedEntity.spec?.type ?? ownedEntity.kind),\n        );\n        if (match) {\n          match.count += 1;\n        } else {\n          acc.push({\n            kind: ownedEntity.kind,\n            type: ownedEntity.spec?.type?.toString() ?? ownedEntity.kind,\n            count: 1,\n          });\n        }\n        return acc;\n      },\n      [],\n    );\n\n    // Return top N (six) entities to be displayed in ownership boxes\n    const topN = counts.sort((a, b) => b.count - a.count).slice(0, 6);\n\n    return topN.map(topOwnedEntity => ({\n      counter: topOwnedEntity.count,\n      type: topOwnedEntity.type,\n      name: topOwnedEntity.type.toLocaleUpperCase('en-US'),\n      queryParams: getQueryParams(entity, topOwnedEntity),\n    })) as Array<{\n      counter: number;\n      type: string;\n      name: string;\n      queryParams: string;\n    }>;\n  }, [catalogApi, entity]);\n\n  if (loading) {\n    return <Progress />;\n  } else if (error) {\n    return <ResponseErrorPanel error={error} />;\n  }\n\n  return (\n    <InfoCard title=\"Ownership\" variant={variant}>\n      <Grid container>\n        {componentsWithCounters?.map(c => (\n          <Grid item xs={6} md={6} lg={4} key={c.name}>\n            <EntityCountTile\n              counter={c.counter}\n              type={c.type}\n              name={c.name}\n              url={`${catalogLink()}/?${c.queryParams}`}\n            />\n          </Grid>\n        ))}\n      </Grid>\n    </InfoCard>\n  );\n};\n"],"names":["useStyles","CardTitle"],"mappings":"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"}