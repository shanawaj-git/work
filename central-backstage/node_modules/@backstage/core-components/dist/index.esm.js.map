{"version":3,"file":"index.esm.js","sources":["../src/components/AlertDisplay/AlertDisplay.tsx","../src/components/Avatar/utils.ts","../src/components/Avatar/Avatar.tsx","../src/components/Link/Link.tsx","../src/components/Button/Button.tsx","../src/components/CopyTextButton/CopyTextButton.tsx","../src/components/CodeSnippet/CodeSnippet.tsx","../src/components/CreateButton/CreateButton.tsx","../src/components/DependencyGraph/types.ts","../src/components/DependencyGraph/DefaultNode.tsx","../src/components/DependencyGraph/constants.ts","../src/components/DependencyGraph/Node.tsx","../src/components/DependencyGraph/DefaultLabel.tsx","../src/components/DependencyGraph/Edge.tsx","../src/components/DependencyGraph/DependencyGraph.tsx","../src/components/DismissableBanner/DismissableBanner.tsx","../src/components/EmptyState/EmptyStateImage.tsx","../src/components/EmptyState/EmptyState.tsx","../src/components/EmptyState/MissingAnnotationEmptyState.tsx","../src/components/WarningPanel/WarningPanel.tsx","../src/components/ErrorPanel/ErrorPanel.tsx","../src/components/ResponseErrorPanel/ResponseErrorPanel.tsx","../src/components/FeatureDiscovery/lib/usePortal.ts","../src/components/FeatureDiscovery/lib/useShowCallout.ts","../src/components/FeatureDiscovery/FeatureCalloutCircular.tsx","../src/components/HeaderIconLinkRow/IconLinkVertical.tsx","../src/components/HeaderIconLinkRow/HeaderIconLinkRow.tsx","../src/components/HorizontalScrollGrid/HorizontalScrollGrid.tsx","../src/components/Lifecycle/Lifecycle.tsx","../src/components/LogViewer/LogViewer.tsx","../src/components/MarkdownContent/MarkdownContent.tsx","../src/components/OAuthRequestDialog/LoginRequestListItem.tsx","../src/components/OAuthRequestDialog/OAuthRequestDialog.tsx","../src/components/OverflowTooltip/OverflowTooltip.tsx","../src/components/Progress/Progress.tsx","../src/layout/BottomLink/BottomLink.tsx","../src/layout/ErrorBoundary/ErrorBoundary.tsx","../src/layout/InfoCard/InfoCard.tsx","../src/components/ProgressBars/Gauge.tsx","../src/components/ProgressBars/GaugeCard.tsx","../src/components/ProgressBars/LinearGauge.tsx","../src/components/Select/static/ClosedDropdown.tsx","../src/components/Select/static/OpenedDropdown.tsx","../src/components/Select/Select.tsx","../src/components/SimpleStepper/SimpleStepper.tsx","../src/components/SimpleStepper/SimpleStepperFooter.tsx","../src/components/SimpleStepper/SimpleStepperStep.tsx","../src/components/Status/Status.tsx","../src/components/StructuredMetadataTable/MetadataTable.tsx","../src/components/StructuredMetadataTable/StructuredMetadataTable.tsx","../src/hooks/useQueryParamState.ts","../src/hooks/useSupportConfig.ts","../src/icons/icons.tsx","../src/components/SupportButton/SupportButton.tsx","../src/layout/Sidebar/config.ts","../src/layout/Sidebar/localStorage.ts","../src/layout/Sidebar/Page.tsx","../src/layout/Sidebar/SidebarGroup.tsx","../src/layout/Sidebar/MobileSidebar.tsx","../src/layout/Sidebar/Bar.tsx","../src/layout/Sidebar/utils.ts","../src/layout/Sidebar/SidebarSubmenuItem.tsx","../src/layout/Sidebar/SidebarSubmenu.tsx","../src/layout/Sidebar/icons/DoubleArrowLeft.tsx","../src/layout/Sidebar/icons/DoubleArrowRight.tsx","../src/layout/Sidebar/Items.tsx","../src/layout/Sidebar/Intro.tsx","../src/layout/Content/Content.tsx","../src/layout/HeaderTabs/HeaderTabs.tsx","../src/components/TabbedLayout/RoutedTabs.tsx","../src/components/TabbedLayout/TabbedLayout.tsx","../src/components/Table/SubvalueCell.tsx","../src/components/Table/Filters.tsx","../src/components/Table/Table.tsx","../src/components/Tabs/utils.ts","../src/components/Tabs/TabPanel.tsx","../src/components/Tabs/TabIcon.tsx","../src/components/Tabs/Tab.tsx","../src/components/Tabs/TabBar.tsx","../src/components/Tabs/Tabs.tsx","../src/components/TrendLine/TrendLine.tsx","../src/layout/ContentHeader/ContentHeader.tsx","../src/layout/ErrorPage/MicDrop.tsx","../src/layout/ErrorPage/ErrorPage.tsx","../src/layout/Breadcrumbs/Breadcrumbs.tsx","../src/layout/Header/Header.tsx","../src/layout/HeaderLabel/HeaderLabel.tsx","../src/layout/HomepageTimer/HomepageTimer.tsx","../src/layout/ItemCard/ItemCardHeader.tsx","../src/layout/ItemCard/ItemCard.tsx","../src/layout/ItemCard/ItemCardGrid.tsx","../src/layout/Page/Page.tsx","../src/layout/Page/PageWithHeader.tsx","../src/layout/ProxiedSignInPage/types.ts","../src/layout/ProxiedSignInPage/ProxiedSignInIdentity.ts","../src/layout/ProxiedSignInPage/ProxiedSignInPage.tsx","../src/layout/SignInPage/GuestUserIdentity.ts","../src/layout/SignInPage/LegacyUserIdentity.ts","../src/layout/SignInPage/UserIdentity.ts","../src/layout/SignInPage/styles.tsx","../src/layout/SignInPage/commonProvider.tsx","../src/layout/SignInPage/guestProvider.tsx","../src/layout/SignInPage/customProvider.tsx","../src/layout/SignInPage/IdentityApiSignOutProxy.ts","../src/layout/SignInPage/providers.tsx","../src/layout/SignInPage/SignInPage.tsx","../src/layout/TabbedCard/TabbedCard.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { Alert } from '@material-ui/lab';\nimport { AlertMessage, useApi, alertApiRef } from '@backstage/core-plugin-api';\nimport pluralize from 'pluralize';\n\n/**\n * Displays alerts from {@link @backstage/core-plugin-api#AlertApi}\n *\n * @public\n * @remarks\n *\n * Shown as SnackBar at the top of the page\n */\n// TODO: improve on this and promote to a shared component for use by all apps.\nexport function AlertDisplay(_props: {}) {\n  const [messages, setMessages] = useState<Array<AlertMessage>>([]);\n  const alertApi = useApi(alertApiRef);\n\n  useEffect(() => {\n    const subscription = alertApi\n      .alert$()\n      .subscribe(message => setMessages(msgs => msgs.concat(message)));\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [alertApi]);\n\n  if (messages.length === 0) {\n    return null;\n  }\n\n  const [firstMessage] = messages;\n\n  const handleClose = () => {\n    setMessages(msgs => msgs.filter(msg => msg !== firstMessage));\n  };\n\n  return (\n    <Snackbar open anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>\n      <Alert\n        action={\n          <IconButton\n            color=\"inherit\"\n            size=\"small\"\n            onClick={handleClose}\n            data-testid=\"error-button-close\"\n          >\n            <CloseIcon />\n          </IconButton>\n        }\n        severity={firstMessage.severity}\n      >\n        <span>\n          {firstMessage.message.toString()}\n          {messages.length > 1 && (\n            <em>{` (${messages.length - 1} older ${pluralize(\n              'message',\n              messages.length - 1,\n            )})`}</em>\n          )}\n        </span>\n      </Alert>\n    </Snackbar>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function stringToColor(str: string) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xff;\n    color += `00${value.toString(16)}`.substr(-2);\n  }\n  return color;\n}\n\nexport function extractInitials(value: string) {\n  return value.match(/\\b\\w/g)?.join('').substring(0, 2);\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { CSSProperties } from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport MaterialAvatar from '@material-ui/core/Avatar';\nimport { extractInitials, stringToColor } from './utils';\n\n/** @public */\nexport type AvatarClassKey = 'avatar';\n\nconst useStyles = makeStyles(\n  (theme: Theme) =>\n    createStyles({\n      avatar: {\n        width: '4rem',\n        height: '4rem',\n        color: '#fff',\n        fontWeight: theme.typography.fontWeightBold,\n        letterSpacing: '1px',\n        textTransform: 'uppercase',\n      },\n    }),\n  { name: 'BackstageAvatar' },\n);\n\n/**\n * Properties for {@link Avatar}.\n *\n * @public\n */\nexport interface AvatarProps {\n  /**\n   * A display name, which will be used to generate initials as a fallback in case a picture is not provided.\n   */\n  displayName?: string;\n  /**\n   * URL to avatar image source\n   */\n  picture?: string;\n  /**\n   * Custom styles applied to avatar\n   */\n  customStyles?: CSSProperties;\n}\n\n/**\n *  Component rendering an Avatar\n *\n * @public\n * @remarks\n *\n * Based on https://v4.mui.com/components/avatars/#avatar with some styling adjustment and two-letter initials\n */\nexport function Avatar(props: AvatarProps) {\n  const { displayName, picture, customStyles } = props;\n  const classes = useStyles();\n  return (\n    <MaterialAvatar\n      alt={displayName}\n      src={picture}\n      className={classes.avatar}\n      style={{\n        backgroundColor: stringToColor(displayName || picture || ''),\n        ...customStyles,\n      }}\n    >\n      {displayName && extractInitials(displayName)}\n    </MaterialAvatar>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useAnalytics } from '@backstage/core-plugin-api';\nimport MaterialLink, {\n  LinkProps as MaterialLinkProps,\n} from '@material-ui/core/Link';\nimport React, { ElementType } from 'react';\nimport {\n  Link as RouterLink,\n  LinkProps as RouterLinkProps,\n} from 'react-router-dom';\n\nexport const isExternalUri = (uri: string) => /^([a-z+.-]+):/.test(uri);\n\nexport type LinkProps = MaterialLinkProps &\n  RouterLinkProps & {\n    component?: ElementType<any>;\n    noTrack?: boolean;\n  };\n\n/**\n * Given a react node, try to retrieve its text content.\n */\nconst getNodeText = (node: React.ReactNode): string => {\n  // If the node is an array of children, recurse and join.\n  if (node instanceof Array) {\n    return node.map(getNodeText).join(' ').trim();\n  }\n\n  // If the node is a react element, recurse on its children.\n  if (typeof node === 'object' && node) {\n    return getNodeText((node as React.ReactElement)?.props?.children);\n  }\n\n  // Base case: the node is just text. Return it.\n  if (['string', 'number'].includes(typeof node)) {\n    return String(node);\n  }\n\n  // Base case: just return an empty string.\n  return '';\n};\n\n/**\n * Thin wrapper on top of material-ui's Link component, which...\n * - Makes the Link use react-router\n * - Captures Link clicks as analytics events.\n */\nexport const Link = React.forwardRef<any, LinkProps>(\n  ({ onClick, noTrack, ...props }, ref) => {\n    const analytics = useAnalytics();\n    const to = String(props.to);\n    const linkText = getNodeText(props.children) || to;\n    const external = isExternalUri(to);\n    const newWindow = external && !!/^https?:/.exec(to);\n\n    const handleClick = (event: React.MouseEvent<any, MouseEvent>) => {\n      onClick?.(event);\n      if (!noTrack) {\n        analytics.captureEvent('click', linkText, { attributes: { to } });\n      }\n    };\n\n    return external ? (\n      // External links\n      <MaterialLink\n        ref={ref}\n        href={to}\n        onClick={handleClick}\n        {...(newWindow ? { target: '_blank', rel: 'noopener' } : {})}\n        {...props}\n      />\n    ) : (\n      // Interact with React Router for internal links\n      <MaterialLink\n        ref={ref}\n        component={RouterLink}\n        onClick={handleClick}\n        {...props}\n      />\n    );\n  },\n) as (props: LinkProps) => JSX.Element;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport MaterialButton, {\n  ButtonProps as MaterialButtonProps,\n} from '@material-ui/core/Button';\nimport React from 'react';\nimport { Link, LinkProps } from '../Link';\n\n/**\n * Properties for {@link Button}\n *\n * @public\n * @remarks\n *\n * See {@link https://v4.mui.com/api/button/#props | Material-UI Button Props} for all properties\n */\nexport type ButtonProps = MaterialButtonProps &\n  Omit<LinkProps, 'variant' | 'color'>;\n\n/**\n * This wrapper is here to reset the color of the Link and make typescript happy.\n */\nconst LinkWrapper = React.forwardRef<any, LinkProps>((props, ref) => (\n  <Link ref={ref} {...props} color=\"initial\" />\n));\n\n/**\n * Thin wrapper on top of material-ui's {@link https://v4.mui.com/components/buttons/ | Button} component\n *\n * @public\n * @remarks\n *\n * Makes the Button to utilise react-router\n */\nexport const Button = React.forwardRef<any, ButtonProps>((props, ref) => (\n  <MaterialButton ref={ref} component={LinkWrapper} {...props} />\n)) as (props: ButtonProps) => JSX.Element;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { errorApiRef, useApi } from '@backstage/core-plugin-api';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport CopyIcon from '@material-ui/icons/FileCopy';\nimport React, { MouseEventHandler, useEffect, useState } from 'react';\nimport useCopyToClipboard from 'react-use/lib/useCopyToClipboard';\n\n/**\n * Properties for {@link CopyTextButton}\n *\n * @public\n */\nexport interface CopyTextButtonProps {\n  /**\n   * The text to be copied\n   */\n  text: string;\n  /**\n   * Number of milliseconds that the tooltip is shown\n   *\n   * @remarks\n   *\n   * Default: 1000\n   */\n  tooltipDelay?: number;\n  /**\n   * Text to show in the tooltip when user has clicked the button\n   *\n   * @remarks\n   *\n   * Default: \"Text copied to clipboard\"\n   */\n  tooltipText?: string;\n}\n\n/**\n * Copy text button with visual feedback\n *\n * @public\n * @remarks\n *\n * Visual feedback takes form of:\n *  - a hover color\n *  - click ripple\n *  - Tooltip shown when user has clicked\n *\n * @example\n *\n * `<CopyTextButton text=\"My text that I want to be copied to the clipboard\" />`\n */\nexport function CopyTextButton(props: CopyTextButtonProps) {\n  const {\n    text,\n    tooltipDelay = 1000,\n    tooltipText = 'Text copied to clipboard',\n  } = props;\n  const errorApi = useApi(errorApiRef);\n  const [open, setOpen] = useState(false);\n  const [{ error }, copyToClipboard] = useCopyToClipboard();\n\n  useEffect(() => {\n    if (error) {\n      errorApi.post(error);\n    }\n  }, [error, errorApi]);\n\n  const handleCopyClick: MouseEventHandler = e => {\n    e.stopPropagation();\n    setOpen(true);\n    copyToClipboard(text);\n  };\n\n  return (\n    <>\n      <Tooltip\n        id=\"copy-test-tooltip\"\n        title={tooltipText}\n        placement=\"top\"\n        leaveDelay={tooltipDelay}\n        onClose={() => setOpen(false)}\n        open={open}\n      >\n        <IconButton onClick={handleCopyClick}>\n          <CopyIcon />\n        </IconButton>\n      </Tooltip>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { useTheme } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\nimport { CopyTextButton } from '../CopyTextButton';\nimport { LightAsync } from 'react-syntax-highlighter';\nimport dark from 'react-syntax-highlighter/dist/esm/styles/hljs/dark';\nimport docco from 'react-syntax-highlighter/dist/esm/styles/hljs/docco';\n\n/**\n * Properties for {@link CodeSnippet}\n *\n * @public\n */\nexport interface CodeSnippetProps {\n  /**\n   * Code Snippet text\n   */\n  text: string;\n  /**\n   * Language used by {@link CodeSnippetProps.text}\n   */\n  language: string;\n  /**\n   * Whether to show line number\n   *\n   * @remarks\n   *\n   * Default: false\n   */\n  showLineNumbers?: boolean;\n  /**\n   * Whether to show button to copy code snippet\n   *\n   * @remarks\n   *\n   * Default: false\n   */\n  showCopyCodeButton?: boolean;\n  /**\n   * Array of line numbers to highlight\n   */\n  highlightedNumbers?: number[];\n  /**\n   * Custom styles applied to code\n   *\n   * @remarks\n   *\n   * Passed to {@link https://react-syntax-highlighter.github.io/react-syntax-highlighter/ | react-syntax-highlighter}\n   */\n  customStyle?: any;\n}\n\n/**\n * Thin wrapper on top of {@link https://react-syntax-highlighter.github.io/react-syntax-highlighter/ | react-syntax-highlighter}\n * providing consistent theming and copy code button\n *\n * @public\n */\nexport function CodeSnippet(props: CodeSnippetProps) {\n  const {\n    text,\n    language,\n    showLineNumbers = false,\n    highlightedNumbers,\n    customStyle,\n    showCopyCodeButton = false,\n  } = props;\n  const theme = useTheme<BackstageTheme>();\n  const mode = theme.palette.type === 'dark' ? dark : docco;\n  const highlightColor = theme.palette.type === 'dark' ? '#256bf3' : '#e6ffed';\n\n  return (\n    <div style={{ position: 'relative' }}>\n      <LightAsync\n        customStyle={customStyle}\n        language={language}\n        style={mode}\n        showLineNumbers={showLineNumbers}\n        wrapLines\n        lineNumberStyle={{ color: theme.palette.textVerySubtle }}\n        lineProps={(lineNumber: number) =>\n          highlightedNumbers?.includes(lineNumber)\n            ? {\n                style: {\n                  backgroundColor: highlightColor,\n                },\n              }\n            : {}\n        }\n      >\n        {text}\n      </LightAsync>\n      {showCopyCodeButton && (\n        <div style={{ position: 'absolute', top: 0, right: 0 }}>\n          <CopyTextButton text={text} />\n        </div>\n      )}\n    </div>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport React from 'react';\nimport { Link as RouterLink, LinkProps } from 'react-router-dom';\nimport AddCircleOutline from '@material-ui/icons/AddCircleOutline';\n\n/**\n * Properties for {@link CreateButton}\n *\n * @public\n */\nexport type CreateButtonProps = {\n  title: string;\n} & Partial<Pick<LinkProps, 'to'>>;\n\n/**\n * Responsive Button giving consistent UX for creation of different things\n *\n * @public\n */\nexport function CreateButton(props: CreateButtonProps) {\n  const { title, to } = props;\n  const isXSScreen = useMediaQuery<BackstageTheme>(theme =>\n    theme.breakpoints.down('xs'),\n  );\n\n  if (!to) {\n    return null;\n  }\n\n  return isXSScreen ? (\n    <IconButton\n      component={RouterLink}\n      color=\"primary\"\n      title={title}\n      size=\"small\"\n      to={to}\n    >\n      <AddCircleOutline />\n    </IconButton>\n  ) : (\n    <Button component={RouterLink} variant=\"contained\" color=\"primary\" to={to}>\n      {title}\n    </Button>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Types used to customize and provide data to {@link DependencyGraph}\n *\n * @packageDocumentation\n */\n\nimport React from 'react';\n\n/**\n * Edge of {@link DependencyGraph}\n *\n * @public\n */\nexport type DependencyEdge<T = {}> = T & {\n  /**\n   * ID of {@link DependencyNode} from where the Edge start\n   */\n  from: string;\n  /**\n   * ID of {@link DependencyNode} to where the Edge goes to\n   */\n  to: string;\n  /**\n   * Label assigned and rendered with the Edge\n   */\n  label?: string;\n};\n\n/**\n * Properties of {@link DependencyGraphTypes.RenderLabelFunction} for {@link DependencyGraphTypes.DependencyEdge}\n */\nexport type RenderLabelProps<T = unknown> = { edge: DependencyEdge<T> };\n\n/**\n * Custom React component for edge labels\n */\nexport type RenderLabelFunction<T = {}> = (\n  props: RenderLabelProps<T>,\n) => React.ReactNode;\n\n/**\n * Node of {@link DependencyGraph}\n *\n * @public\n */\nexport type DependencyNode<T = {}> = T & {\n  id: string;\n};\n\n/**\n * Properties of {@link DependencyGraphTypes.RenderNodeFunction} for {@link DependencyGraphTypes.DependencyNode}\n */\nexport type RenderNodeProps<T = unknown> = { node: DependencyNode<T> };\n\n/**\n * Custom React component for graph {@link DependencyGraphTypes.DependencyNode}\n */\nexport type RenderNodeFunction<T = {}> = (\n  props: RenderNodeProps<T>,\n) => React.ReactNode;\n\n/**\n * Graph direction\n *\n * @public\n */\nexport enum Direction {\n  /**\n   * Top to Bottom\n   */\n  TOP_BOTTOM = 'TB',\n  /**\n   * Bottom to Top\n   */\n  BOTTOM_TOP = 'BT',\n  /**\n   * Left to Right\n   */\n  LEFT_RIGHT = 'LR',\n  /**\n   * Right to Left\n   */\n  RIGHT_LEFT = 'RL',\n}\n\n/**\n * Node alignment\n *\n * @public\n */\nexport enum Alignment {\n  /**\n   * Up Left\n   */\n  UP_LEFT = 'UL',\n  /**\n   * Up Right\n   */\n  UP_RIGHT = 'UR',\n  /**\n   * Down Left\n   */\n  DOWN_LEFT = 'DL',\n  /**\n   * Down Right\n   */\n  DOWN_RIGHT = 'DR',\n}\n\n/**\n * Algorithm used to rand nodes in graph\n */\nexport enum Ranker {\n  /**\n   * {@link https://en.wikipedia.org/wiki/Network_simplex_algorithm | Network Simplex} algorithm\n   */\n  NETWORK_SIMPLEX = 'network-simplex',\n  /**\n   * Tight Tree algorithm\n   */\n  TIGHT_TREE = 'tight-tree',\n  /**\n   * Longest path algorithm\n   *\n   * @remarks\n   *\n   * Simplest and fastest\n   */\n  LONGEST_PATH = 'longest-path',\n}\n\n/**\n * Position of label in relation to the edge\n *\n * @public\n */\nexport enum LabelPosition {\n  LEFT = 'l',\n  RIGHT = 'r',\n  CENTER = 'c',\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\nimport { RenderNodeProps } from './types';\n\n/** @public */\nexport type DependencyGraphDefaultNodeClassKey = 'node' | 'text';\n\nconst useStyles = makeStyles(\n  (theme: BackstageTheme) => ({\n    node: {\n      fill: theme.palette.primary.light,\n      stroke: theme.palette.primary.light,\n    },\n    text: {\n      fill: theme.palette.primary.contrastText,\n    },\n  }),\n  { name: 'BackstageDependencyGraphDefaultNode' },\n);\n\n/** @public */\nexport function DefaultNode({ node: { id } }: RenderNodeProps) {\n  const classes = useStyles();\n  const [width, setWidth] = React.useState(0);\n  const [height, setHeight] = React.useState(0);\n  const idRef = React.useRef<SVGTextElement | null>(null);\n\n  React.useLayoutEffect(() => {\n    // set the width to the length of the ID\n    if (idRef.current) {\n      let { height: renderedHeight, width: renderedWidth } =\n        idRef.current.getBBox();\n      renderedHeight = Math.round(renderedHeight);\n      renderedWidth = Math.round(renderedWidth);\n\n      if (renderedHeight !== height || renderedWidth !== width) {\n        setWidth(renderedWidth);\n        setHeight(renderedHeight);\n      }\n    }\n  }, [width, height]);\n\n  const padding = 10;\n  const paddedWidth = width + padding * 2;\n  const paddedHeight = height + padding * 2;\n\n  return (\n    <g>\n      <rect\n        className={classes.node}\n        width={paddedWidth}\n        height={paddedHeight}\n        rx={10}\n      />\n      <text\n        ref={idRef}\n        className={classes.text}\n        y={paddedHeight / 2}\n        x={paddedWidth / 2}\n        textAnchor=\"middle\"\n        alignmentBaseline=\"middle\"\n      >\n        {id}\n      </text>\n    </g>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const ARROW_MARKER_ID = 'arrow-marker';\n\nexport const NODE_TEST_ID = 'node';\nexport const EDGE_TEST_ID = 'edge';\nexport const LABEL_TEST_ID = 'label';\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { DefaultNode } from './DefaultNode';\nimport { RenderNodeFunction, RenderNodeProps, DependencyNode } from './types';\nimport { NODE_TEST_ID } from './constants';\nimport dagre from 'dagre';\n\n/** @public */\nexport type DependencyGraphNodeClassKey = 'node';\n\nconst useStyles = makeStyles(\n  theme => ({\n    node: {\n      transition: `${theme.transitions.duration.shortest}ms`,\n    },\n  }),\n  { name: 'BackstageDependencyGraphNode' },\n);\n\nexport type GraphNode<T> = dagre.Node<DependencyNode<T>>;\n\nexport type NodeComponentProps<T> = {\n  node: GraphNode<T>;\n  render?: RenderNodeFunction<T>;\n  setNode: dagre.graphlib.Graph['setNode'];\n};\n\nconst renderDefault = (props: RenderNodeProps) => <DefaultNode {...props} />;\n\nexport function Node<T>({\n  render = renderDefault,\n  setNode,\n  node,\n}: NodeComponentProps<T>) {\n  const { width, height, x = 0, y = 0 } = node;\n  const nodeProps: DependencyNode<T> = node;\n  const classes = useStyles();\n  const nodeRef = React.useRef<SVGGElement | null>(null);\n\n  React.useLayoutEffect(() => {\n    // set the node width to the actual rendered width to properly layout graph\n    if (nodeRef.current) {\n      let { height: renderedHeight, width: renderedWidth } =\n        nodeRef.current.getBBox();\n      renderedHeight = Math.round(renderedHeight);\n      renderedWidth = Math.round(renderedWidth);\n\n      if (renderedHeight !== height || renderedWidth !== width) {\n        setNode(node.id, {\n          ...node,\n          height: renderedHeight,\n          width: renderedWidth,\n        });\n      }\n    }\n  }, [node, width, height, setNode]);\n\n  return (\n    <g\n      ref={nodeRef}\n      data-testid={NODE_TEST_ID}\n      className={classes.node}\n      transform={`translate(${x - width / 2},${y - height / 2})`}\n    >\n      {render({ node: nodeProps })}\n    </g>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { BackstageTheme } from '@backstage/theme';\nimport { RenderLabelProps } from './types';\n\n/** @public */\nexport type DependencyGraphDefaultLabelClassKey = 'text';\n\nconst useStyles = makeStyles(\n  (theme: BackstageTheme) => ({\n    text: {\n      fill: theme.palette.textContrast,\n    },\n  }),\n  { name: 'BackstageDependencyGraphDefaultLabel' },\n);\n\n/** @public */\nexport function DefaultLabel({ edge: { label } }: RenderLabelProps) {\n  const classes = useStyles();\n  return (\n    <text className={classes.text} textAnchor=\"middle\">\n      {label}\n    </text>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport * as d3Shape from 'd3-shape';\nimport isFinite from 'lodash/isFinite';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { BackstageTheme } from '@backstage/theme';\nimport {\n  RenderLabelProps,\n  RenderLabelFunction,\n  DependencyEdge,\n  LabelPosition,\n} from './types';\nimport { ARROW_MARKER_ID, EDGE_TEST_ID, LABEL_TEST_ID } from './constants';\nimport { DefaultLabel } from './DefaultLabel';\nimport dagre from 'dagre';\n\n/* Based on: https://github.com/dagrejs/dagre/wiki#configuring-the-layout  */\nexport type EdgeProperties = {\n  label?: string;\n  width?: number;\n  height?: number;\n  labeloffset?: number;\n  labelpos?: LabelPosition;\n  minlen?: number;\n  weight?: number;\n};\nexport type GraphEdge<T> = DependencyEdge<T> & dagre.GraphEdge & EdgeProperties;\n\n/** @public */\nexport type DependencyGraphEdgeClassKey = 'path' | 'label';\n\nconst useStyles = makeStyles(\n  (theme: BackstageTheme) => ({\n    path: {\n      strokeWidth: 2,\n      stroke: theme.palette.textSubtle,\n      fill: 'none',\n      transition: `${theme.transitions.duration.shortest}ms`,\n    },\n    label: {\n      transition: `${theme.transitions.duration.shortest}ms`,\n    },\n  }),\n  { name: 'BackstageDependencyGraphEdge' },\n);\n\ntype EdgePoint = dagre.GraphEdge['points'][0];\n\n/** @public */\nexport type EdgeComponentProps<T = unknown> = {\n  id: dagre.Edge;\n  edge: GraphEdge<T>;\n  render?: RenderLabelFunction<T>;\n  setEdge: (\n    id: dagre.Edge,\n    edge: DependencyEdge<T>,\n  ) => dagre.graphlib.Graph<{}>;\n};\n\nconst renderDefault = (props: RenderLabelProps<unknown>) => (\n  <DefaultLabel {...props} />\n);\n\nconst createPath = d3Shape\n  .line<EdgePoint>()\n  .x(d => d.x)\n  .y(d => d.y)\n  .curve(d3Shape.curveMonotoneX);\n\nexport function Edge<EdgeData>({\n  render = renderDefault,\n  setEdge,\n  id,\n  edge,\n}: EdgeComponentProps<EdgeData>) {\n  const { x = 0, y = 0, width, height, points } = edge;\n  const labelProps: DependencyEdge<EdgeData> = edge;\n  const classes = useStyles();\n\n  const labelRef = React.useRef<SVGGElement>(null);\n\n  React.useLayoutEffect(() => {\n    // set the label width to the actual rendered width to properly layout graph\n    if (labelRef.current) {\n      let { height: renderedHeight, width: renderedWidth } =\n        labelRef.current.getBBox();\n      renderedHeight = Math.round(renderedHeight);\n      renderedWidth = Math.round(renderedWidth);\n\n      if (renderedHeight !== height || renderedWidth !== width) {\n        setEdge(id, {\n          ...edge,\n          height: renderedHeight,\n          width: renderedWidth,\n        });\n      }\n    }\n  }, [edge, height, width, setEdge, id]);\n\n  let path: string = '';\n\n  if (points) {\n    const finitePoints = points.filter(\n      (point: EdgePoint) => isFinite(point.x) && isFinite(point.y),\n    );\n    path = createPath(finitePoints) || '';\n  }\n\n  return (\n    <>\n      {path && (\n        <path\n          data-testid={EDGE_TEST_ID}\n          className={classes.path}\n          markerEnd={`url(#${ARROW_MARKER_ID})`}\n          d={path}\n        />\n      )}\n      {labelProps.label ? (\n        <g\n          ref={labelRef}\n          data-testid={LABEL_TEST_ID}\n          className={classes.label}\n          transform={`translate(${x},${y})`}\n        >\n          {render({ edge: labelProps })}\n        </g>\n      ) : null}\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport * as d3Zoom from 'd3-zoom';\nimport * as d3Selection from 'd3-selection';\nimport useTheme from '@material-ui/core/styles/useTheme';\nimport dagre from 'dagre';\nimport debounce from 'lodash/debounce';\nimport { BackstageTheme } from '@backstage/theme';\nimport {\n  DependencyEdge,\n  DependencyNode,\n  Direction,\n  Alignment,\n  Ranker,\n  RenderNodeFunction,\n  RenderLabelFunction,\n  LabelPosition,\n} from './types';\nimport { Node } from './Node';\nimport { Edge, GraphEdge } from './Edge';\nimport { ARROW_MARKER_ID } from './constants';\n\n/**\n * Properties of {@link DependencyGraph}\n *\n * @public\n * @remarks\n * <NodeData> and <EdgeData> are useful when rendering custom or edge labels\n */\nexport interface DependencyGraphProps<NodeData, EdgeData>\n  extends React.SVGProps<SVGSVGElement> {\n  /**\n   * Edges of graph\n   */\n  edges: DependencyEdge<EdgeData>[];\n  /**\n   * Nodes of Graph\n   */\n  nodes: DependencyNode<NodeData>[];\n  /**\n   * Graph {@link DependencyGraphTypes.Direction | direction}\n   *\n   * @remarks\n   *\n   * Default: `DependencyGraphTypes.Direction.TOP_BOTTOM`\n   */\n  direction?: Direction;\n  /**\n   * Node {@link DependencyGraphTypes.Alignment | alignment}\n   */\n  align?: Alignment;\n  /**\n   * Margin between nodes on each rank\n   *\n   * @remarks\n   *\n   * Default: 50\n   */\n  nodeMargin?: number;\n  /**\n   * Margin between edges\n   *\n   * @remarks\n   *\n   * Default: 10\n   */\n  edgeMargin?: number;\n  /**\n   * Margin between each rank\n   *\n   * @remarks\n   *\n   * Default: 50\n   */\n  rankMargin?: number;\n  /**\n   * Margin on left and right of whole graph\n   *\n   * @remarks\n   *\n   * Default: 0\n   */\n  paddingX?: number;\n  /**\n   * Margin on top and bottom of whole graph\n   *\n   * @remarks\n   *\n   * Default: 0\n   */\n  paddingY?: number;\n  /**\n   * Heuristic used to find set of edges that will make graph acyclic\n   */\n  acyclicer?: 'greedy';\n  /**\n   * {@link DependencyGraphTypes.Ranker | Algorithm} used to rank nodes\n   *\n   * @remarks\n   *\n   * Default: `DependencyGraphTypes.Ranker.NETWORK_SIMPLEX`\n   */\n  ranker?: Ranker;\n  /**\n   * {@link DependencyGraphTypes.LabelPosition | Position} of label in relation to edge\n   *\n   * @remarks\n   *\n   * Default: `DependencyGraphTypes.LabelPosition.RIGHT`\n   */\n  labelPosition?: LabelPosition;\n  /**\n   * How much to move label away from edge\n   *\n   * @remarks\n   *\n   * Applies only when {@link DependencyGraphProps.labelPosition} is `DependencyGraphTypes.LabelPosition.LEFT` or\n   * `DependencyGraphTypes.LabelPosition.RIGHT`\n   */\n  labelOffset?: number;\n  /**\n   * Minimum number of ranks to keep between connected nodes\n   */\n  edgeRanks?: number;\n  /**\n   * Weight applied to edges in graph\n   */\n  edgeWeight?: number;\n  /**\n   * Custom node rendering component\n   */\n  renderNode?: RenderNodeFunction<NodeData>;\n  /**\n   * Custom label rendering component\n   */\n  renderLabel?: RenderLabelFunction<EdgeData>;\n  /**\n   * {@link https://developer.mozilla.org/en-US/docs/Web/SVG/Element/defs | Defs} shared by rendered SVG to be used by\n   * {@link DependencyGraphProps.renderNode} and/or {@link DependencyGraphProps.renderLabel}\n   */\n  defs?: SVGDefsElement | SVGDefsElement[];\n  /**\n   * Controls zoom behavior of graph\n   *\n   * @remarks\n   *\n   * Default: `enabled`\n   */\n  zoom?: 'enabled' | 'disabled' | 'enable-on-click';\n}\n\nconst WORKSPACE_ID = 'workspace';\n\n/**\n * Graph component used to visualize relations between entities\n *\n * @public\n */\nexport function DependencyGraph<NodeData, EdgeData>(\n  props: DependencyGraphProps<NodeData, EdgeData>,\n) {\n  const {\n    edges,\n    nodes,\n    renderNode,\n    direction = Direction.TOP_BOTTOM,\n    align,\n    nodeMargin = 50,\n    edgeMargin = 10,\n    rankMargin = 50,\n    paddingX = 0,\n    paddingY = 0,\n    acyclicer,\n    ranker = Ranker.NETWORK_SIMPLEX,\n    labelPosition = LabelPosition.RIGHT,\n    labelOffset = 10,\n    edgeRanks = 1,\n    edgeWeight = 1,\n    renderLabel,\n    defs,\n    zoom = 'enabled',\n    ...svgProps\n  } = props;\n  const theme: BackstageTheme = useTheme();\n  const [containerWidth, setContainerWidth] = React.useState<number>(100);\n  const [containerHeight, setContainerHeight] = React.useState<number>(100);\n\n  const graph = React.useRef<dagre.graphlib.Graph<DependencyNode<NodeData>>>(\n    new dagre.graphlib.Graph(),\n  );\n  const [graphWidth, setGraphWidth] = React.useState<number>(\n    graph.current.graph()?.width || 0,\n  );\n  const [graphHeight, setGraphHeight] = React.useState<number>(\n    graph.current.graph()?.height || 0,\n  );\n  const [graphNodes, setGraphNodes] = React.useState<string[]>([]);\n  const [graphEdges, setGraphEdges] = React.useState<dagre.Edge[]>([]);\n\n  const maxWidth = Math.max(graphWidth, containerWidth);\n  const maxHeight = Math.max(graphHeight, containerHeight);\n\n  const containerRef = React.useMemo(\n    () =>\n      debounce((node: SVGSVGElement) => {\n        if (!node) {\n          return;\n        }\n        // Set up zooming + panning\n        const container = d3Selection.select<SVGSVGElement, null>(node);\n        const workspace = d3Selection.select(node.getElementById(WORKSPACE_ID));\n\n        function enableZoom() {\n          container.call(\n            d3Zoom\n              .zoom<SVGSVGElement, null>()\n              .scaleExtent([1, 10])\n              .on('zoom', event => {\n                event.transform.x = Math.min(\n                  0,\n                  Math.max(\n                    event.transform.x,\n                    maxWidth - maxWidth * event.transform.k,\n                  ),\n                );\n                event.transform.y = Math.min(\n                  0,\n                  Math.max(\n                    event.transform.y,\n                    maxHeight - maxHeight * event.transform.k,\n                  ),\n                );\n                workspace.attr('transform', event.transform);\n              }),\n          );\n        }\n\n        if (zoom === 'enabled') {\n          enableZoom();\n        } else if (zoom === 'enable-on-click') {\n          container.on('click', () => enableZoom());\n        }\n\n        const { width: newContainerWidth, height: newContainerHeight } =\n          node.getBoundingClientRect();\n        if (containerWidth !== newContainerWidth) {\n          setContainerWidth(newContainerWidth);\n        }\n        if (containerHeight !== newContainerHeight) {\n          setContainerHeight(newContainerHeight);\n        }\n      }, 100),\n    [containerHeight, containerWidth, maxWidth, maxHeight, zoom],\n  );\n\n  const setNodesAndEdges = React.useCallback(() => {\n    // Cleaning up lingering nodes and edges\n    const currentGraphNodes = graph.current.nodes();\n    const currentGraphEdges = graph.current.edges();\n\n    currentGraphNodes.forEach(nodeId => {\n      const remainingNode = nodes.some(node => node.id === nodeId);\n      if (!remainingNode) {\n        graph.current.removeNode(nodeId);\n      }\n    });\n\n    currentGraphEdges.forEach(e => {\n      const remainingEdge = edges.some(\n        edge => edge.from === e.v && edge.to === e.w,\n      );\n      if (!remainingEdge) {\n        graph.current.removeEdge(e.v, e.w);\n      }\n    });\n\n    // Adding/updating nodes and edges\n    nodes.forEach(node => {\n      const existingNode = graph.current\n        .nodes()\n        .find(nodeId => node.id === nodeId);\n\n      if (existingNode && graph.current.node(existingNode)) {\n        const { width, height, x, y } = graph.current.node(existingNode);\n        graph.current.setNode(existingNode, { ...node, width, height, x, y });\n      } else {\n        graph.current.setNode(node.id, { ...node, width: 0, height: 0 });\n      }\n    });\n\n    edges.forEach(e => {\n      graph.current.setEdge(e.from, e.to, {\n        ...e,\n        label: e.label,\n        width: 0,\n        height: 0,\n        labelpos: labelPosition,\n        labeloffset: labelOffset,\n        weight: edgeWeight,\n        minlen: edgeRanks,\n      });\n    });\n  }, [edges, nodes, labelPosition, labelOffset, edgeWeight, edgeRanks]);\n\n  const updateGraph = React.useMemo(\n    () =>\n      debounce(\n        () => {\n          dagre.layout(graph.current);\n          const { height, width } = graph.current.graph();\n          const newHeight = Math.max(0, height || 0);\n          const newWidth = Math.max(0, width || 0);\n          setGraphWidth(newWidth);\n          setGraphHeight(newHeight);\n\n          setGraphNodes(graph.current.nodes());\n          setGraphEdges(graph.current.edges());\n        },\n        250,\n        { leading: true },\n      ),\n    [],\n  );\n\n  React.useEffect(() => {\n    graph.current.setGraph({\n      rankdir: direction,\n      align,\n      nodesep: nodeMargin,\n      edgesep: edgeMargin,\n      ranksep: rankMargin,\n      marginx: paddingX,\n      marginy: paddingY,\n      acyclicer,\n      ranker,\n    });\n\n    setNodesAndEdges();\n    updateGraph();\n\n    return updateGraph.cancel;\n  }, [\n    acyclicer,\n    align,\n    direction,\n    edgeMargin,\n    paddingX,\n    paddingY,\n    nodeMargin,\n    rankMargin,\n    ranker,\n    setNodesAndEdges,\n    updateGraph,\n  ]);\n\n  function setNode(id: string, node: DependencyNode<NodeData>) {\n    graph.current.setNode(id, node);\n    updateGraph();\n    return graph.current;\n  }\n\n  function setEdge(id: dagre.Edge, edge: DependencyEdge<EdgeData>) {\n    graph.current.setEdge(id, edge);\n    updateGraph();\n    return graph.current;\n  }\n\n  return (\n    <svg\n      ref={containerRef}\n      {...svgProps}\n      width=\"100%\"\n      height={maxHeight}\n      viewBox={`0 0 ${maxWidth} ${maxHeight}`}\n    >\n      <defs>\n        <marker\n          id={ARROW_MARKER_ID}\n          viewBox=\"0 0 24 24\"\n          markerWidth=\"14\"\n          markerHeight=\"14\"\n          refX=\"16\"\n          refY=\"12\"\n          orient=\"auto\"\n          markerUnits=\"strokeWidth\"\n        >\n          <path\n            fill={theme.palette.textSubtle}\n            d=\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"\n          />\n        </marker>\n        {defs}\n      </defs>\n      <g id={WORKSPACE_ID}>\n        <svg\n          width={graphWidth}\n          height={graphHeight}\n          y={maxHeight / 2 - graphHeight / 2}\n          x={maxWidth / 2 - graphWidth / 2}\n          viewBox={`0 0 ${graphWidth} ${graphHeight}`}\n        >\n          {graphEdges.map(e => {\n            const edge = graph.current.edge(e) as GraphEdge<EdgeData>;\n            if (!edge) return null;\n            return (\n              <Edge\n                key={`${e.v}-${e.w}`}\n                id={e}\n                setEdge={setEdge}\n                render={renderLabel}\n                edge={edge}\n              />\n            );\n          })}\n          {graphNodes.map((id: string) => {\n            const node = graph.current.node(id);\n            if (!node) return null;\n            return (\n              <Node\n                key={id}\n                setNode={setNode}\n                render={renderNode}\n                node={node}\n              />\n            );\n          })}\n        </svg>\n      </g>\n    </svg>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactNode, useState, useEffect } from 'react';\nimport { useApi, storageApiRef } from '@backstage/core-plugin-api';\nimport useObservable from 'react-use/lib/useObservable';\nimport classNames from 'classnames';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport Close from '@material-ui/icons/Close';\n\n/** @public */\nexport type DismissableBannerClassKey =\n  | 'root'\n  | 'topPosition'\n  | 'icon'\n  | 'content'\n  | 'message'\n  | 'info'\n  | 'error';\n\n/**\n * @public\n * @deprecated This type contained a typo, please use DismissableBannerClassKey instead\n */\nexport type DismissbleBannerClassKey = DismissableBannerClassKey;\n\nconst useStyles = makeStyles(\n  (theme: BackstageTheme) => ({\n    root: {\n      padding: theme.spacing(0),\n      marginBottom: theme.spacing(0),\n      marginTop: theme.spacing(0),\n      display: 'flex',\n      flexFlow: 'row nowrap',\n    },\n    // showing on top\n    topPosition: {\n      position: 'relative',\n      marginBottom: theme.spacing(6),\n      marginTop: -theme.spacing(3),\n      zIndex: 'unset',\n    },\n    icon: {\n      fontSize: 20,\n    },\n    content: {\n      width: '100%',\n      maxWidth: 'inherit',\n      flexWrap: 'nowrap',\n    },\n    message: {\n      display: 'flex',\n      alignItems: 'center',\n      color: theme.palette.banner.text,\n      '& a': {\n        color: theme.palette.banner.link,\n      },\n    },\n    info: {\n      backgroundColor: theme.palette.banner.info,\n    },\n    error: {\n      backgroundColor: theme.palette.banner.error,\n    },\n    warning: {\n      backgroundColor:\n        theme.palette.banner.warning ?? theme.palette.banner.error,\n    },\n  }),\n  { name: 'BackstageDismissableBanner' },\n);\n\ntype Props = {\n  variant: 'info' | 'error' | 'warning';\n  message: ReactNode;\n  id: string;\n  fixed?: boolean;\n};\n\n/** @public */\nexport const DismissableBanner = (props: Props) => {\n  const { variant, message, id, fixed = false } = props;\n  const classes = useStyles();\n  const storageApi = useApi(storageApiRef);\n  const notificationsStore = storageApi.forBucket('notifications');\n  const rawDismissedBanners =\n    notificationsStore.snapshot<string[]>('dismissedBanners').value ?? [];\n\n  const [dismissedBanners, setDismissedBanners] = useState(\n    new Set(rawDismissedBanners),\n  );\n\n  const observedItems = useObservable(\n    notificationsStore.observe$<string[]>('dismissedBanners'),\n  );\n\n  useEffect(() => {\n    if (observedItems?.value) {\n      const currentValue = observedItems?.value ?? [];\n      setDismissedBanners(new Set(currentValue));\n    }\n  }, [observedItems?.value]);\n\n  const handleClick = () => {\n    notificationsStore.set('dismissedBanners', [...dismissedBanners, id]);\n  };\n\n  return (\n    <Snackbar\n      anchorOrigin={\n        fixed\n          ? { vertical: 'bottom', horizontal: 'center' }\n          : { vertical: 'top', horizontal: 'center' }\n      }\n      open={!dismissedBanners.has(id)}\n      classes={{\n        root: classNames(classes.root, !fixed && classes.topPosition),\n      }}\n    >\n      <SnackbarContent\n        classes={{\n          root: classNames(classes.content, classes[variant]),\n          message: classes.message,\n        }}\n        message={message}\n        action={[\n          <IconButton\n            key=\"dismiss\"\n            title=\"Permanently dismiss this message\"\n            color=\"inherit\"\n            onClick={handleClick}\n          >\n            <Close className={classes.icon} />\n          </IconButton>,\n        ]}\n      />\n    </Snackbar>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport missingAnnotation from './assets/missingAnnotation.svg';\nimport noInformation from './assets/noInformation.svg';\nimport createComponent from './assets/createComponent.svg';\nimport noBuild from './assets/noBuild.svg';\nimport { makeStyles } from '@material-ui/core/styles';\n\ntype Props = {\n  missing: 'field' | 'info' | 'content' | 'data';\n};\n\n/** @public */\nexport type EmptyStateImageClassKey = 'generalImg';\n\nconst useStyles = makeStyles(\n  {\n    generalImg: {\n      width: '95%',\n      zIndex: 2,\n      position: 'relative',\n      left: '50%',\n      top: '50%',\n      transform: 'translate(-50%, 15%)',\n    },\n  },\n  { name: 'BackstageEmptyStateImage' },\n);\n\n/** @public */\nexport const EmptyStateImage = ({ missing }: Props) => {\n  const classes = useStyles();\n  switch (missing) {\n    case 'field':\n      return (\n        <img\n          src={missingAnnotation}\n          className={classes.generalImg}\n          alt=\"annotation is missing\"\n        />\n      );\n    case 'info':\n      return (\n        <img\n          src={noInformation}\n          alt=\"no Information\"\n          className={classes.generalImg}\n        />\n      );\n    case 'content':\n      return (\n        <img\n          src={createComponent}\n          alt=\"create Component\"\n          className={classes.generalImg}\n        />\n      );\n    case 'data':\n      return (\n        <img src={noBuild} alt=\"no Build\" className={classes.generalImg} />\n      );\n    default:\n      return null;\n  }\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { EmptyStateImage } from './EmptyStateImage';\n\n/** @public */\nexport type EmptyStateClassKey = 'root' | 'action' | 'imageContainer';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      backgroundColor: theme.palette.background.default,\n      padding: theme.spacing(2, 0, 0, 0),\n    },\n    action: {\n      marginTop: theme.spacing(2),\n    },\n    imageContainer: {\n      position: 'relative',\n    },\n  }),\n  { name: 'BackstageEmptyState' },\n);\n\ntype Props = {\n  title: string;\n  description?: string | JSX.Element;\n  missing: 'field' | 'info' | 'content' | 'data';\n  action?: JSX.Element;\n};\n\n/**\n * Various placeholder views for empty state pages\n *\n * @public\n *\n */\nexport function EmptyState(props: Props) {\n  const { title, description, missing, action } = props;\n  const classes = useStyles();\n  return (\n    <Grid\n      container\n      direction=\"row\"\n      justifyContent=\"space-around\"\n      alignItems=\"flex-start\"\n      className={classes.root}\n      spacing={2}\n    >\n      <Grid item xs={12} md={6}>\n        <Grid container direction=\"column\">\n          <Grid item xs>\n            <Typography variant=\"h5\">{title}</Typography>\n          </Grid>\n          <Grid item xs>\n            <Typography variant=\"body1\">{description}</Typography>\n          </Grid>\n          <Grid item xs className={classes.action}>\n            {action}\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item xs={12} md={6} className={classes.imageContainer}>\n        <EmptyStateImage missing={missing} />\n      </Grid>\n    </Grid>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { BackstageTheme } from '@backstage/theme';\nimport { Link } from '../Link';\nimport { EmptyState } from './EmptyState';\nimport { CodeSnippet } from '../CodeSnippet';\n\nconst COMPONENT_YAML = `apiVersion: backstage.io/v1alpha1\nkind: Component\nmetadata:\n  name: example\n  description: example.com\n  annotations:\n    ANNOTATION: value\nspec:\n  type: website\n  lifecycle: production\n  owner: user:guest`;\n\ntype Props = {\n  annotation: string;\n};\n\nexport type MissingAnnotationEmptyStateClassKey = 'code';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    code: {\n      borderRadius: 6,\n      margin: `${theme.spacing(2)}px 0px`,\n      background: theme.palette.type === 'dark' ? '#444' : '#fff',\n    },\n  }),\n  { name: 'BackstageMissingAnnotationEmptyState' },\n);\n\nexport function MissingAnnotationEmptyState(props: Props) {\n  const { annotation } = props;\n  const classes = useStyles();\n  const description = (\n    <>\n      The <code>{annotation}</code> annotation is missing. You need to add the\n      annotation to your component if you want to enable this tool.\n    </>\n  );\n  return (\n    <EmptyState\n      missing=\"field\"\n      title=\"Missing Annotation\"\n      description={description}\n      action={\n        <>\n          <Typography variant=\"body1\">\n            Add the annotation to your component YAML as shown in the\n            highlighted example below:\n          </Typography>\n          <div className={classes.code}>\n            <CodeSnippet\n              text={COMPONENT_YAML.replace('ANNOTATION', annotation)}\n              language=\"yaml\"\n              showLineNumbers\n              highlightedNumbers={[6, 7]}\n              customStyle={{ background: 'inherit', fontSize: '115%' }}\n            />\n          </div>\n          <Button\n            color=\"primary\"\n            component={Link}\n            to=\"https://backstage.io/docs/features/software-catalog/well-known-annotations\"\n          >\n            Read more\n          </Button>\n        </>\n      }\n    />\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles, darken, lighten } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport ErrorOutline from '@material-ui/icons/ErrorOutline';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport React from 'react';\n\nconst getWarningTextColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: BackstageTheme,\n) => {\n  const getColor = theme.palette.type === 'light' ? darken : lighten;\n  return getColor(theme.palette[severity].light, 0.6);\n};\n\nconst getWarningBackgroundColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: BackstageTheme,\n) => {\n  const getBackgroundColor = theme.palette.type === 'light' ? lighten : darken;\n  return getBackgroundColor(theme.palette[severity].light, 0.9);\n};\n\nconst useErrorOutlineStyles = makeStyles<BackstageTheme>(theme => ({\n  root: {\n    marginRight: theme.spacing(1),\n    fill: ({ severity }: WarningProps) =>\n      getWarningTextColor(\n        severity as NonNullable<WarningProps['severity']>,\n        theme,\n      ),\n  },\n}));\n\nconst ErrorOutlineStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ErrorOutline classes={classes} />;\n};\nconst ExpandMoreIconStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ExpandMoreIcon classes={classes} />;\n};\n\nexport type WarningPanelClassKey =\n  | 'panel'\n  | 'summary'\n  | 'summaryText'\n  | 'message'\n  | 'details';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    panel: {\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      verticalAlign: 'middle',\n    },\n    summary: {\n      display: 'flex',\n      flexDirection: 'row',\n    },\n    summaryText: {\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      fontWeight: 'bold',\n    },\n    message: {\n      width: '100%',\n      display: 'block',\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n    },\n    details: {\n      width: '100%',\n      display: 'block',\n      color: theme.palette.textContrast,\n      backgroundColor: theme.palette.background.default,\n      border: `1px solid ${theme.palette.border}`,\n      padding: theme.spacing(2.0),\n      fontFamily: 'sans-serif',\n    },\n  }),\n  { name: 'BackstageWarningPanel' },\n);\n\nexport type WarningProps = {\n  title?: string;\n  severity?: 'warning' | 'error' | 'info';\n  message?: React.ReactNode;\n  defaultExpanded?: boolean;\n  children?: React.ReactNode;\n};\n\nconst capitalize = (s: string) => {\n  return s.charAt(0).toLocaleUpperCase('en-US') + s.slice(1);\n};\n\n/**\n * WarningPanel. Show a user friendly error message to a user similar to\n * ErrorPanel except that the warning panel only shows the warning message to\n * the user.\n *\n * @param severity - Ability to change the severity of the alert. Default value\n *        \"warning\"\n * @param title - A title for the warning. If not supplied, \"Warning\" will be\n *        used.\n * @param message - Optional more detailed user-friendly message elaborating on\n *        the cause of the error.\n * @param children - Objects to provide context, such as a stack trace or detailed\n *        error reporting. Will be available inside an unfolded accordion.\n */\nexport function WarningPanel(props: WarningProps) {\n  const {\n    severity = 'warning',\n    title,\n    message,\n    children,\n    defaultExpanded,\n  } = props;\n  const classes = useStyles({ severity });\n\n  // If no severity or title provided, the heading will read simply \"Warning\"\n  const subTitle = capitalize(severity) + (title ? `: ${title}` : '');\n\n  return (\n    <Accordion\n      defaultExpanded={defaultExpanded ?? false}\n      className={classes.panel}\n      role=\"alert\"\n    >\n      <AccordionSummary\n        expandIcon={<ExpandMoreIconStyled severity={severity} />}\n        className={classes.summary}\n      >\n        <ErrorOutlineStyled severity={severity} />\n        <Typography className={classes.summaryText} variant=\"subtitle1\">\n          {subTitle}\n        </Typography>\n      </AccordionSummary>\n      {(message || children) && (\n        <AccordionDetails>\n          <Grid container>\n            {message && (\n              <Grid item xs={12}>\n                <Typography className={classes.message} variant=\"body1\">\n                  {message}\n                </Typography>\n              </Grid>\n            )}\n            {children && (\n              <Grid item xs={12} className={classes.details}>\n                {children}\n              </Grid>\n            )}\n          </Grid>\n        </AccordionDetails>\n      )}\n    </Accordion>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport React, { PropsWithChildren } from 'react';\nimport { CopyTextButton } from '../CopyTextButton';\nimport { WarningPanel } from '../WarningPanel';\n\n/** @public */\nexport type ErrorPanelClassKey = 'text' | 'divider';\n\nconst useStyles = makeStyles(\n  theme => ({\n    text: {\n      fontFamily: 'monospace',\n      whiteSpace: 'pre',\n      overflowX: 'auto',\n      marginRight: theme.spacing(2),\n    },\n    divider: {\n      margin: theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageErrorPanel' },\n);\n\ntype ErrorListProps = {\n  error: string;\n  message: string;\n  request?: string;\n  stack?: string;\n  json?: string;\n};\n\nconst ErrorList = ({\n  error,\n  message,\n  stack,\n  children,\n}: PropsWithChildren<ErrorListProps>) => {\n  const classes = useStyles();\n\n  return (\n    <List dense>\n      <ListItem alignItems=\"flex-start\">\n        <ListItemText\n          classes={{ secondary: classes.text }}\n          primary=\"Error\"\n          secondary={error}\n        />\n        <CopyTextButton text={error} />\n      </ListItem>\n\n      <ListItem alignItems=\"flex-start\">\n        <ListItemText\n          classes={{ secondary: classes.text }}\n          primary=\"Message\"\n          secondary={message}\n        />\n        <CopyTextButton text={message} />\n      </ListItem>\n\n      {stack && (\n        <ListItem alignItems=\"flex-start\">\n          <ListItemText\n            classes={{ secondary: classes.text }}\n            primary=\"Stack Trace\"\n            secondary={stack}\n          />\n          <CopyTextButton text={stack} />\n        </ListItem>\n      )}\n\n      {children}\n    </List>\n  );\n};\n\n/** @public */\nexport type ErrorPanelProps = {\n  error: Error;\n  defaultExpanded?: boolean;\n  title?: string;\n};\n\n/**\n * Renders a warning panel as the effect of an error.\n *\n * @public\n */\nexport function ErrorPanel(props: PropsWithChildren<ErrorPanelProps>) {\n  const { title, error, defaultExpanded, children } = props;\n  return (\n    <WarningPanel\n      severity=\"error\"\n      title={title ?? error.message}\n      defaultExpanded={defaultExpanded}\n    >\n      <ErrorList\n        error={error.name}\n        message={error.message}\n        stack={error.stack}\n        children={children}\n      />\n    </WarningPanel>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ResponseError } from '@backstage/errors';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport React from 'react';\nimport { CodeSnippet } from '../CodeSnippet';\nimport { CopyTextButton } from '../CopyTextButton';\nimport { ErrorPanel, ErrorPanelProps } from '../ErrorPanel';\n\nexport type ResponseErrorPanelClassKey = 'text' | 'divider';\n\nconst useStyles = makeStyles(\n  theme => ({\n    text: {\n      fontFamily: 'monospace',\n      whiteSpace: 'pre',\n      overflowX: 'auto',\n      marginRight: theme.spacing(2),\n    },\n    divider: {\n      margin: theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageResponseErrorPanel' },\n);\n\n/**\n * Renders a warning panel as the effect of a failed server request.\n *\n * Has special treatment for ResponseError errors, to display rich\n * server-provided information about what happened.\n */\nexport function ResponseErrorPanel(props: ErrorPanelProps) {\n  const { title, error, defaultExpanded } = props;\n  const classes = useStyles();\n\n  if (error.name !== 'ResponseError') {\n    return (\n      <ErrorPanel\n        title={title ?? error.message}\n        defaultExpanded={defaultExpanded}\n        error={error}\n      />\n    );\n  }\n\n  const { body, cause } = error as ResponseError;\n  const { request, response } = body;\n\n  const errorString = `${response.statusCode}: ${cause.name}`;\n  const requestString = request && `${request.method} ${request.url}`;\n  const messageString = cause.message.replace(/\\\\n/g, '\\n');\n  const stackString = cause.stack?.replace(/\\\\n/g, '\\n');\n  const jsonString = JSON.stringify(body, undefined, 2);\n\n  return (\n    <ErrorPanel\n      title={title ?? error.message}\n      defaultExpanded={defaultExpanded}\n      error={{ name: errorString, message: messageString, stack: stackString }}\n    >\n      {requestString && (\n        <ListItem alignItems=\"flex-start\">\n          <ListItemText\n            classes={{ secondary: classes.text }}\n            primary=\"Request\"\n            secondary={request ? `${requestString}` : undefined}\n          />\n          <CopyTextButton text={requestString} />\n        </ListItem>\n      )}\n      <>\n        <Divider component=\"li\" className={classes.divider} />\n        <ListItem alignItems=\"flex-start\">\n          <ListItemText\n            classes={{ secondary: classes.text }}\n            primary=\"Full Error as JSON\"\n          />\n        </ListItem>\n        <CodeSnippet language=\"json\" text={jsonString} showCopyCodeButton />\n      </>\n    </ErrorPanel>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useRef, useEffect } from 'react';\n\n/**\n * Creates DOM element to be used as React root.\n */\nfunction createRootElement(id: string): Element {\n  const rootContainer = document.createElement('div');\n  rootContainer.setAttribute('id', id);\n  return rootContainer;\n}\n\n/**\n * Appends element as last child of body.\n */\nfunction addRootElement(rootElem: Element): void {\n  document.body.insertBefore(\n    rootElem,\n    document.body.lastElementChild!.nextElementSibling,\n  );\n}\n\n/**\n * Hook to create a React Portal.\n *\n * Automatically handles creating and tearing-down the root elements (no SRR\n * makes this trivial), so there is no need to ensure the parent target already\n * exists.\n *\n * @example\n * const target = usePortal(id, [id]);\n * return createPortal(children, target);\n *\n * @param id - The id of the target container, e.g 'modal' or 'spotlight'\n * @returns The DOM node to use as the Portal target.\n */\nexport function usePortal(id: string): HTMLElement {\n  const rootElemRef = useRef<HTMLElement | null>(null);\n\n  useEffect(\n    function setupElement() {\n      // Look for existing target dom element to append to\n      const existingParent = document.querySelector(`#${id}`);\n      // Parent is either a new root or the existing dom element\n      const parentElem = existingParent || createRootElement(id);\n\n      // If there is no existing DOM element, add a new one.\n      if (!existingParent) {\n        addRootElement(parentElem);\n      }\n\n      // Add the detached element to the parent\n      parentElem.appendChild(rootElemRef.current!);\n\n      return function removeElement() {\n        rootElemRef.current!.remove();\n        if (parentElem.childNodes.length === -1) {\n          parentElem.remove();\n        }\n      };\n    },\n    [id],\n  );\n\n  /**\n   * It's important we evaluate this lazily:\n   * - We need first render to contain the DOM element, so it shouldn't happen\n   *   in useEffect. We would normally put this in the constructor().\n   * - We can't do 'const rootElemRef = useRef(document.createElement('div))',\n   *   since this will run every single render (that's a lot).\n   * - We want the ref to consistently point to the same DOM element and only\n   *   ever run once.\n   * @link https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n   */\n  function getRootElem() {\n    if (!rootElemRef.current) {\n      rootElemRef.current = document.createElement('div');\n    }\n    return rootElemRef.current;\n  }\n\n  return getRootElem();\n}\n\nexport default usePortal;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useState } from 'react';\n\nconst STATES_LOCAL_STORAGE_KEY = 'core.calloutSeen';\n\nfunction useCalloutStates(): {\n  states: Record<string, boolean>;\n  setState: (key: string, value: boolean) => void;\n} {\n  const [states, setStates] = useState<Record<string, boolean>>(() => {\n    const raw = localStorage.getItem(STATES_LOCAL_STORAGE_KEY);\n    return raw ? JSON.parse(raw) : {};\n  });\n\n  const setState = useCallback((key: string, value: boolean) => {\n    const raw = localStorage.getItem(STATES_LOCAL_STORAGE_KEY);\n    const oldStates = raw ? JSON.parse(raw) : {};\n    const newStates = { ...oldStates, [key]: value };\n    setStates(newStates);\n    localStorage.setItem(STATES_LOCAL_STORAGE_KEY, JSON.stringify(newStates));\n  }, []);\n\n  return { states, setState };\n}\n\nfunction useCalloutHasBeenSeen(featureId: string): {\n  seen: boolean | undefined;\n  markSeen: () => void;\n} {\n  const { states, setState } = useCalloutStates();\n\n  const markSeen = useCallback(() => {\n    setState(featureId, true);\n  }, [setState, featureId]);\n\n  return { seen: states[featureId] === true, markSeen };\n}\n\nexport function useShowCallout(featureId: string): {\n  show: boolean;\n  hide: () => void;\n} {\n  const { seen, markSeen } = useCalloutHasBeenSeen(featureId);\n  return { show: seen === false, hide: markSeen };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React, {\n  PropsWithChildren,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { usePortal } from './lib/usePortal';\nimport { useShowCallout } from './lib/useShowCallout';\n\n/** @public */\nexport type FeatureCalloutCircleClassKey =\n  | '@keyframes pulsateSlightly'\n  | '@keyframes pulsateAndFade'\n  | 'featureWrapper'\n  | 'backdrop'\n  | 'dot'\n  | 'pulseCircle'\n  | 'text';\n\nconst useStyles = makeStyles(\n  {\n    '@keyframes pulsateSlightly': {\n      '0%': { transform: 'scale(1.0)' },\n      '100%': { transform: 'scale(1.1)' },\n    },\n    '@keyframes pulsateAndFade': {\n      '0%': { transform: 'scale(1.0)', opacity: 0.9 },\n      '100%': { transform: 'scale(1.5)', opacity: 0 },\n    },\n    featureWrapper: {\n      position: 'relative',\n    },\n    backdrop: {\n      zIndex: 2000,\n      position: 'fixed',\n      overflow: 'hidden',\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n    dot: {\n      position: 'absolute',\n      backgroundColor: 'transparent',\n      borderRadius: '100%',\n      border: '1px solid rgba(103, 146, 180, 0.98)',\n      boxShadow: '0px 0px 0px 20000px rgba(0, 0, 0, 0.5)',\n      zIndex: 2001,\n      transformOrigin: 'center center',\n      animation:\n        '$pulsateSlightly 1744ms 1.2s cubic-bezier(0.4, 0, 0.2, 1) alternate infinite',\n    },\n    pulseCircle: {\n      width: '100%',\n      height: '100%',\n      backgroundColor: 'transparent',\n      borderRadius: '100%',\n      border: '2px solid white',\n      zIndex: 2001,\n      transformOrigin: 'center center',\n      animation:\n        '$pulsateAndFade 872ms 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite',\n    },\n    text: {\n      position: 'absolute',\n      color: 'white',\n      zIndex: 2003,\n    },\n  },\n  { name: 'BackstageFeatureCalloutCircular' },\n);\n\nexport type Props = {\n  featureId: string;\n  title: string;\n  description: string;\n};\n\ntype Placement = {\n  dotLeft: number;\n  dotTop: number;\n  dotSize: number;\n  borderWidth: number;\n  textLeft: number;\n  textTop: number;\n  textWidth: number;\n};\n\n/**\n * One-time, round 'telescope' animation showing new feature.\n *\n * @public\n *\n */\nexport function FeatureCalloutCircular(props: PropsWithChildren<Props>) {\n  const { featureId, title, description, children } = props;\n  const { show, hide } = useShowCallout(featureId);\n  const portalElement = usePortal('core.callout');\n  const wrapperRef = useRef<HTMLDivElement>(null);\n  const [placement, setPlacement] = useState<Placement | undefined>();\n  const classes = useStyles();\n\n  const update = useCallback(() => {\n    if (wrapperRef.current) {\n      const wrapperBounds = wrapperRef.current.getBoundingClientRect();\n      const longest = Math.max(wrapperBounds.width, wrapperBounds.height);\n\n      const borderWidth = 800;\n      const dotLeft =\n        wrapperBounds.x - (longest - wrapperBounds.width) / 2 - borderWidth;\n      const dotTop =\n        wrapperBounds.y - (longest - wrapperBounds.height) / 2 - borderWidth;\n      const dotSize = longest + 2 * borderWidth;\n\n      const textWidth = 450;\n      const textLeft = wrapperBounds.x + wrapperBounds.width / 2 - textWidth;\n      const textTop =\n        wrapperBounds.y - (longest - wrapperBounds.height) / 2 + longest + 20;\n\n      setPlacement({\n        dotLeft,\n        dotTop,\n        dotSize,\n        borderWidth,\n        textTop,\n        textLeft,\n        textWidth,\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    window.addEventListener('resize', update);\n    window.addEventListener('scroll', update);\n    return () => {\n      window.removeEventListener('resize', update);\n      window.removeEventListener('scroll', update);\n    };\n  }, [update]);\n\n  useLayoutEffect(update, [wrapperRef.current, update]);\n\n  if (!show) {\n    return <>{children}</>;\n  }\n\n  return (\n    <>\n      <div className={classes.featureWrapper} ref={wrapperRef}>\n        {children}\n      </div>\n      {createPortal(\n        <div className={classes.backdrop}>\n          <ClickAwayListener onClickAway={hide}>\n            <>\n              <div\n                className={classes.dot}\n                data-testid=\"dot\"\n                style={{\n                  left: placement?.dotLeft,\n                  top: placement?.dotTop,\n                  width: placement?.dotSize,\n                  height: placement?.dotSize,\n                  borderWidth: placement?.borderWidth,\n                }}\n                onClick={hide}\n                onKeyDown={hide}\n                role=\"button\"\n                tabIndex={0}\n              >\n                <div className={classes.pulseCircle} />\n              </div>\n              <div\n                className={classes.text}\n                data-testid=\"text\"\n                style={{\n                  left: placement?.textLeft,\n                  top: placement?.textTop,\n                  width: placement?.textWidth,\n                }}\n              >\n                <Typography variant=\"h2\" paragraph>\n                  {title}\n                </Typography>\n                <Typography>{description}</Typography>\n              </div>\n            </>\n          </ClickAwayListener>\n        </div>,\n        portalElement,\n      )}\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport classnames from 'classnames';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Link from '@material-ui/core/Link';\nimport LinkIcon from '@material-ui/icons/Link';\nimport { Link as RouterLink } from '../Link';\n\nexport type IconLinkVerticalProps = {\n  color?: 'primary' | 'secondary';\n  disabled?: boolean;\n  href?: string;\n  icon?: React.ReactNode;\n  label: string;\n  onClick?: React.MouseEventHandler<HTMLAnchorElement>;\n  title?: string;\n};\n\n/** @public */\nexport type IconLinkVerticalClassKey =\n  | 'link'\n  | 'disabled'\n  | 'primary'\n  | 'secondary'\n  | 'label';\n\nconst useIconStyles = makeStyles(\n  theme => ({\n    link: {\n      display: 'grid',\n      justifyItems: 'center',\n      gridGap: 4,\n      textAlign: 'center',\n    },\n    disabled: {\n      color: 'gray',\n      cursor: 'default',\n    },\n    primary: {\n      color: theme.palette.primary.main,\n    },\n    secondary: {\n      color: theme.palette.secondary.main,\n    },\n    label: {\n      fontSize: '0.7rem',\n      textTransform: 'uppercase',\n      fontWeight: 600,\n      letterSpacing: 1.2,\n    },\n  }),\n  { name: 'BackstageIconLinkVertical' },\n);\n\n/** @public */\nexport function IconLinkVertical({\n  color = 'primary',\n  disabled = false,\n  href = '#',\n  icon = <LinkIcon />,\n  label,\n  onClick,\n  title,\n}: IconLinkVerticalProps) {\n  const classes = useIconStyles();\n\n  if (disabled) {\n    return (\n      <Link\n        title={title}\n        className={classnames(classes.link, classes.disabled)}\n        underline=\"none\"\n      >\n        {icon}\n        <span className={classes.label}>{label}</span>\n      </Link>\n    );\n  }\n\n  return (\n    <Link\n      title={title}\n      className={classnames(classes.link, classes[color])}\n      to={href}\n      component={RouterLink}\n      onClick={onClick}\n    >\n      {icon}\n      <span className={classes.label}>{label}</span>\n    </Link>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\nimport { IconLinkVertical, IconLinkVerticalProps } from './IconLinkVertical';\n\n/** @public */\nexport type HeaderIconLinkRowClassKey = 'links';\n\nconst useStyles = makeStyles(\n  theme => ({\n    links: {\n      margin: theme.spacing(2, 0),\n      display: 'grid',\n      gridAutoFlow: 'column',\n      gridAutoColumns: 'min-content',\n      gridGap: theme.spacing(3),\n    },\n  }),\n  { name: 'BackstageHeaderIconLinkRow' },\n);\n\ntype Props = {\n  links: IconLinkVerticalProps[];\n};\n\n/**\n * HTML nav tag with links mapped inside\n *\n * @public\n *\n */\nexport function HeaderIconLinkRow(props: Props) {\n  const { links } = props;\n  const classes = useStyles();\n  return (\n    <nav className={classes.links}>\n      {links.map((link, index) => (\n        <IconLinkVertical key={index + 1} {...link} />\n      ))}\n    </nav>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport classNames from 'classnames';\nimport React, { PropsWithChildren } from 'react';\n\nconst generateGradientStops = (themeType: 'dark' | 'light') => {\n  // 97% corresponds to the theme.palette.background.default for the light theme\n  // 16% for the dark theme\n  const luminance = themeType === 'dark' ? '16%' : '97%';\n  // Generated with https://larsenwork.com/easing-gradients/\n  return `\n    hsl(0, 0%, ${luminance}) 0%,\n    hsla(0, 0%, ${luminance}, 0.987) 8.1%,\n    hsla(0, 0%, ${luminance}, 0.951) 15.5%,\n    hsla(0, 0%, ${luminance}, 0.896) 22.5%,\n    hsla(0, 0%, ${luminance}, 0.825) 29%,\n    hsla(0, 0%, ${luminance}, 0.741) 35.3%,\n    hsla(0, 0%, ${luminance}, 0.648) 41.2%,\n    hsla(0, 0%, ${luminance}, 0.55) 47.1%,\n    hsla(0, 0%, ${luminance}, 0.45) 52.9%,\n    hsla(0, 0%, ${luminance}, 0.352) 58.8%,\n    hsla(0, 0%, ${luminance}, 0.259) 64.7%,\n    hsla(0, 0%, ${luminance}, 0.175) 71%,\n    hsla(0, 0%, ${luminance}, 0.104) 77.5%,\n    hsla(0, 0%, ${luminance}, 0.049) 84.5%,\n    hsla(0, 0%, ${luminance}, 0.013) 91.9%,\n    hsla(0, 0%, ${luminance}, 0) 100%\n  `;\n};\n\nconst fadeSize = 100;\nconst fadePadding = 10;\n\ntype Props = {\n  scrollStep?: number;\n  scrollSpeed?: number; // lower is faster\n  minScrollDistance?: number; // limits how small steps the scroll can take in px\n};\n\n/** @public */\nexport type HorizontalScrollGridClassKey =\n  | 'root'\n  | 'container'\n  | 'fade'\n  | 'fadeLeft'\n  | 'fadeRight'\n  | 'fadeHidden'\n  | 'button'\n  | 'buttonLeft'\n  | 'buttonRight';\n\nconst useStyles = makeStyles<Theme>(\n  theme => ({\n    root: {\n      position: 'relative',\n      display: 'flex',\n      flexFlow: 'row nowrap',\n      alignItems: 'center',\n    },\n    container: {\n      overflow: 'auto',\n      scrollbarWidth: 0 as any, // hide in FF\n      '&::-webkit-scrollbar': {\n        display: 'none', // hide in Chrome\n      },\n    },\n    fade: {\n      position: 'absolute',\n      width: fadeSize,\n      height: `calc(100% + ${fadePadding}px)`,\n      transition: 'opacity 300ms',\n      pointerEvents: 'none',\n    },\n    fadeLeft: {\n      left: -fadePadding,\n      background: `linear-gradient(90deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeRight: {\n      right: -fadePadding,\n      background: `linear-gradient(270deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeHidden: {\n      opacity: 0,\n    },\n    button: {\n      position: 'absolute',\n    },\n    buttonLeft: {\n      left: -theme.spacing(2),\n    },\n    buttonRight: {\n      right: -theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageHorizontalScrollGrid' },\n);\n\n// Returns scroll distance from left and right\nfunction useScrollDistance(\n  ref: React.MutableRefObject<HTMLElement | undefined>,\n): [number, number] {\n  const [[scrollLeft, scrollRight], setScroll] = React.useState<\n    [number, number]\n  >([0, 0]);\n\n  React.useLayoutEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      setScroll([0, 0]);\n      return;\n    }\n\n    const handleUpdate = () => {\n      const left = el.scrollLeft;\n      const right = el.scrollWidth - el.offsetWidth - el.scrollLeft;\n      setScroll([left, right]);\n    };\n\n    handleUpdate();\n\n    el.addEventListener('scroll', handleUpdate);\n    window.addEventListener('resize', handleUpdate);\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => {\n      el.removeEventListener('scroll', handleUpdate);\n      window.removeEventListener('resize', handleUpdate);\n    };\n  }, [ref]);\n\n  return [scrollLeft, scrollRight];\n}\n\n// Used to animate scrolling. Returns a single setScrollTarger function, when called with e.g. 200,\n// the element pointer to by the ref will be scrolled 200px forwards over time.\nfunction useSmoothScroll(\n  ref: React.MutableRefObject<HTMLElement | undefined>,\n  speed: number,\n  minDistance: number,\n) {\n  const [scrollTarget, setScrollTarget] = React.useState<number>(0);\n\n  React.useLayoutEffect(() => {\n    if (scrollTarget === 0) {\n      return;\n    }\n\n    const startTime = performance.now();\n    const id = requestAnimationFrame(frameTime => {\n      if (!ref.current) {\n        return;\n      }\n      const frameDuration = frameTime - startTime;\n      const scrollDistance = (Math.abs(scrollTarget) * frameDuration) / speed;\n      const cappedScrollDistance = Math.max(minDistance, scrollDistance);\n      const scrollAmount = cappedScrollDistance * Math.sign(scrollTarget);\n\n      ref.current.scrollBy({ left: scrollAmount });\n\n      const newScrollTarget = scrollTarget - scrollAmount;\n      if (Math.sign(scrollTarget) !== Math.sign(newScrollTarget)) {\n        setScrollTarget(0);\n      } else {\n        setScrollTarget(newScrollTarget);\n      }\n    });\n\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => cancelAnimationFrame(id);\n  }, [ref, scrollTarget, speed, minDistance]);\n\n  return setScrollTarget;\n}\n\n/**\n * Horizontal scrollable component with arrows to navigate\n *\n * @public\n *\n */\nexport function HorizontalScrollGrid(props: PropsWithChildren<Props>) {\n  const {\n    scrollStep = 100,\n    scrollSpeed = 50,\n    minScrollDistance = 5,\n    children,\n    ...otherProps\n  } = props;\n  const classes = useStyles(props);\n  const ref = React.useRef<HTMLElement>();\n\n  const [scrollLeft, scrollRight] = useScrollDistance(ref);\n  const setScrollTarget = useSmoothScroll(ref, scrollSpeed, minScrollDistance);\n\n  const handleScrollClick = (forwards: boolean) => {\n    const el = ref.current;\n    if (!el) {\n      return;\n    }\n    setScrollTarget(forwards ? scrollStep : -scrollStep);\n  };\n\n  return (\n    <div {...otherProps} className={classes.root}>\n      <Grid\n        container\n        direction=\"row\"\n        wrap=\"nowrap\"\n        className={classes.container}\n        ref={ref as any}\n      >\n        {children}\n      </Grid>\n      <div\n        className={classNames(classes.fade, classes.fadeLeft, {\n          [classes.fadeHidden]: scrollLeft === 0,\n        })}\n      />\n      <div\n        className={classNames(classes.fade, classes.fadeRight, {\n          [classes.fadeHidden]: scrollRight === 0,\n        })}\n      />\n      {scrollLeft > 0 && (\n        <IconButton\n          title=\"Scroll Left\"\n          onClick={() => handleScrollClick(false)}\n          className={classNames(classes.button, classes.buttonLeft, {})}\n        >\n          <ChevronLeftIcon />\n        </IconButton>\n      )}\n      {scrollRight > 0 && (\n        <IconButton\n          title=\"Scroll Right\"\n          onClick={() => handleScrollClick(true)}\n          className={classNames(classes.button, classes.buttonRight, {})}\n        >\n          <ChevronRightIcon />\n        </IconButton>\n      )}\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport CSS from 'csstype';\nimport { makeStyles } from '@material-ui/core/styles';\n\ntype Props = CSS.Properties & {\n  shorthand?: boolean;\n  alpha?: boolean;\n};\n\nexport type LifecycleClassKey = 'alpha' | 'beta';\n\nconst useStyles = makeStyles(\n  {\n    alpha: {\n      color: '#ffffff',\n      fontFamily: 'serif',\n      fontWeight: 'normal',\n      fontStyle: 'italic',\n    },\n    beta: {\n      color: '#4d65cc',\n      fontFamily: 'serif',\n      fontWeight: 'normal',\n      fontStyle: 'italic',\n    },\n  },\n  { name: 'BackstageLifecycle' },\n);\n\nexport function Lifecycle(props: Props) {\n  const classes = useStyles(props);\n  const { shorthand, alpha } = props;\n  return shorthand ? (\n    <span\n      className={classes[alpha ? 'alpha' : 'beta']}\n      style={{ fontSize: '120%' }}\n    >\n      {alpha ? <>&alpha;</> : <>&beta;</>}\n    </span>\n  ) : (\n    <span className={classes[alpha ? 'alpha' : 'beta']}>\n      {alpha ? 'Alpha' : 'Beta'}\n    </span>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { lazy, Suspense } from 'react';\nimport { useApp } from '@backstage/core-plugin-api';\n\nconst RealLogViewer = lazy(() =>\n  import('./RealLogViewer').then(m => ({ default: m.RealLogViewer })),\n);\n\n/**\n * The properties for the LogViewer component.\n *\n * @public\n */\nexport interface LogViewerProps {\n  /**\n   * The text of the logs to display.\n   *\n   * The LogViewer component is optimized for appending content at the end of the text.\n   */\n  text: string;\n  /**\n   * Styling overrides for classes within the LogViewer component.\n   */\n  classes?: {\n    root?: string;\n  };\n}\n\n/**\n * A component that displays logs in a scrollable text area.\n *\n * The LogViewer has support for search and filtering, as well as displaying\n * text content with ANSI color escape codes.\n *\n * Since the LogViewer uses windowing to avoid rendering all contents at once, the\n * log is sized automatically to fill the available vertical space. This means\n * it may often be needed to wrap the LogViewer in a container that provides it\n * with a fixed amount of space.\n *\n * @public\n */\nexport function LogViewer(props: LogViewerProps) {\n  const { Progress } = useApp().getComponents();\n  return (\n    <Suspense fallback={<Progress />}>\n      <RealLogViewer {...props} />\n    </Suspense>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport ReactMarkdown, { Options } from 'react-markdown';\nimport gfm from 'remark-gfm';\nimport React from 'react';\nimport { BackstageTheme } from '@backstage/theme';\nimport { CodeSnippet } from '../CodeSnippet';\n\nexport type MarkdownContentClassKey = 'markdown';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    markdown: {\n      '& table': {\n        borderCollapse: 'collapse',\n        border: `1px solid ${theme.palette.border}`,\n      },\n      '& th, & td': {\n        border: `1px solid ${theme.palette.border}`,\n        padding: theme.spacing(1),\n      },\n      '& td': {\n        wordBreak: 'break-word',\n        overflow: 'hidden',\n        verticalAlign: 'middle',\n        lineHeight: '1',\n        margin: 0,\n        padding: theme.spacing(3, 2, 3, 2.5),\n        borderBottom: 0,\n      },\n      '& th': {\n        backgroundColor: theme.palette.background.paper,\n      },\n      '& tr': {\n        backgroundColor: theme.palette.background.paper,\n      },\n      '& tr:nth-child(odd)': {\n        backgroundColor: theme.palette.background.default,\n      },\n\n      '& a': {\n        color: theme.palette.link,\n      },\n      '& img': {\n        maxWidth: '100%',\n      },\n    },\n  }),\n  { name: 'BackstageMarkdownContent' },\n);\n\ntype Props = {\n  content: string;\n  dialect?: 'gfm' | 'common-mark';\n  linkTarget?: Options['linkTarget'];\n};\n\nconst components: Options['components'] = {\n  code: ({ inline, className, children, ...props }) => {\n    const text = String(children).replace(/\\n+$/, '');\n    const match = /language-(\\w+)/.exec(className || '');\n    return !inline && match ? (\n      <CodeSnippet language={match[1]} text={text} />\n    ) : (\n      <code className={className} {...props}>\n        {children}\n      </code>\n    );\n  },\n};\n\n/**\n * MarkdownContent\n * --\n * Renders markdown with the default dialect [gfm - GitHub flavored Markdown](https://github.github.com/gfm/) to backstage theme styled HTML.\n * If you just want to render to plain [CommonMark](https://commonmark.org/), set the dialect to `'common-mark'`\n */\nexport function MarkdownContent(props: Props) {\n  const { content, dialect = 'gfm', linkTarget } = props;\n  const classes = useStyles();\n  return (\n    <ReactMarkdown\n      remarkPlugins={dialect === 'gfm' ? [gfm] : []}\n      className={classes.markdown}\n      children={content}\n      components={components}\n      linkTarget={linkTarget}\n    />\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport React, { useState } from 'react';\nimport { isError } from '@backstage/errors';\nimport { PendingOAuthRequest } from '@backstage/core-plugin-api';\n\nexport type LoginRequestListItemClassKey = 'root';\n\nconst useItemStyles = makeStyles<Theme>(\n  theme => ({\n    root: {\n      paddingLeft: theme.spacing(3),\n    },\n  }),\n  { name: 'BackstageLoginRequestListItem' },\n);\n\ntype RowProps = {\n  request: PendingOAuthRequest;\n  busy: boolean;\n  setBusy: (busy: boolean) => void;\n};\n\nconst LoginRequestListItem = ({ request, busy, setBusy }: RowProps) => {\n  const classes = useItemStyles();\n  const [error, setError] = useState<string>();\n\n  const handleContinue = async () => {\n    setBusy(true);\n    try {\n      await request.trigger();\n    } catch (e) {\n      setError(isError(e) ? e.message : 'An unspecified error occurred');\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  const IconComponent = request.provider.icon;\n\n  return (\n    <ListItem button disabled={busy} classes={{ root: classes.root }}>\n      <ListItemAvatar>\n        <IconComponent fontSize=\"large\" />\n      </ListItemAvatar>\n      <ListItemText\n        primary={request.provider.title}\n        secondary={error && <Typography color=\"error\">{error}</Typography>}\n      />\n      <Button color=\"primary\" variant=\"contained\" onClick={handleContinue}>\n        Log in\n      </Button>\n    </ListItem>\n  );\n};\n\nexport default LoginRequestListItem;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport List from '@material-ui/core/List';\nimport Button from '@material-ui/core/Button';\nimport React, { useMemo, useState } from 'react';\nimport useObservable from 'react-use/lib/useObservable';\nimport LoginRequestListItem from './LoginRequestListItem';\nimport { useApi, oauthRequestApiRef } from '@backstage/core-plugin-api';\n\nexport type OAuthRequestDialogClassKey =\n  | 'dialog'\n  | 'title'\n  | 'contentList'\n  | 'actionButtons';\n\nconst useStyles = makeStyles<Theme>(\n  theme => ({\n    dialog: {\n      paddingTop: theme.spacing(1),\n    },\n    title: {\n      minWidth: 0,\n    },\n    contentList: {\n      padding: 0,\n    },\n    actionButtons: {\n      padding: theme.spacing(2, 0),\n    },\n  }),\n  { name: 'OAuthRequestDialog' },\n);\n\nexport function OAuthRequestDialog(_props: {}) {\n  const classes = useStyles();\n  const [busy, setBusy] = useState(false);\n  const oauthRequestApi = useApi(oauthRequestApiRef);\n  const requests = useObservable(\n    useMemo(() => oauthRequestApi.authRequest$(), [oauthRequestApi]),\n    [],\n  );\n\n  const handleRejectAll = () => {\n    requests.forEach(request => request.reject());\n  };\n\n  return (\n    <Dialog\n      open={Boolean(requests.length)}\n      fullWidth\n      maxWidth=\"xs\"\n      classes={{ paper: classes.dialog }}\n    >\n      <DialogTitle classes={{ root: classes.title }}>\n        Login Required\n      </DialogTitle>\n\n      <DialogContent dividers classes={{ root: classes.contentList }}>\n        <List>\n          {requests.map(request => (\n            <LoginRequestListItem\n              key={request.provider.title}\n              request={request}\n              busy={busy}\n              setBusy={setBusy}\n            />\n          ))}\n        </List>\n      </DialogContent>\n\n      <DialogActions classes={{ root: classes.actionButtons }}>\n        <Button onClick={handleRejectAll}>Reject All</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tooltip, { TooltipProps } from '@material-ui/core/Tooltip';\nimport React, { useState } from 'react';\nimport TextTruncate, { TextTruncateProps } from 'react-text-truncate';\nimport { useIsMounted } from '@react-hookz/web';\n\ntype Props = {\n  text: TextTruncateProps['text'];\n  line?: TextTruncateProps['line'];\n  element?: TextTruncateProps['element'];\n  title?: TooltipProps['title'];\n  placement?: TooltipProps['placement'];\n};\n\nexport type OverflowTooltipClassKey = 'container';\n\nconst useStyles = makeStyles(\n  {\n    container: {\n      overflow: 'visible !important',\n    },\n  },\n  { name: 'BackstageOverflowTooltip' },\n);\n\nexport function OverflowTooltip(props: Props) {\n  const [hover, setHover] = useState(false);\n  const isMounted = useIsMounted();\n  const classes = useStyles();\n\n  const handleToggled = (truncated: boolean) => {\n    if (isMounted()) {\n      setHover(truncated);\n    }\n  };\n\n  return (\n    <Tooltip\n      title={props.title ?? (props.text || '')}\n      placement={props.placement}\n      disableHoverListener={!hover}\n    >\n      <TextTruncate\n        text={props.text}\n        line={props.line}\n        onToggled={handleToggled}\n        containerClassName={classes.container}\n      />\n    </Tooltip>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, useEffect, PropsWithChildren } from 'react';\nimport LinearProgress, {\n  LinearProgressProps,\n} from '@material-ui/core/LinearProgress';\n\nexport function Progress(props: PropsWithChildren<LinearProgressProps>) {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    const handle = setTimeout(() => setIsVisible(true), 250);\n    return () => clearTimeout(handle);\n  }, []);\n\n  return isVisible ? (\n    <LinearProgress {...props} data-testid=\"progress\" />\n  ) : (\n    <div style={{ display: 'none' }} />\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport Box from '@material-ui/core/Box';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport ArrowIcon from '@material-ui/icons/ArrowForward';\nimport React from 'react';\nimport { Link } from '../../components/Link';\n\n/** @public */\nexport type BottomLinkClassKey = 'root' | 'boxTitle' | 'arrow';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    root: {\n      maxWidth: 'fit-content',\n      padding: theme.spacing(2, 2, 2, 2.5),\n    },\n    boxTitle: {\n      margin: 0,\n      color: theme.palette.textSubtle,\n    },\n    arrow: {\n      color: theme.palette.textSubtle,\n    },\n  }),\n  { name: 'BackstageBottomLink' },\n);\n\n/** @public */\nexport type BottomLinkProps = {\n  link: string;\n  title: string;\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n};\n\n/**\n * Footer with link used in  {@link InfoCard } and {@link TabbedCard}\n *\n * @public\n *\n */\nexport function BottomLink(props: BottomLinkProps) {\n  const { link, title, onClick } = props;\n  const classes = useStyles();\n\n  return (\n    <div>\n      <Divider />\n      <Link to={link} onClick={onClick} underline=\"none\">\n        <Box display=\"flex\" alignItems=\"center\" className={classes.root}>\n          <Box className={classes.boxTitle} fontWeight=\"fontWeightBold\" m={1}>\n            <Typography>\n              <strong>{title}</strong>\n            </Typography>\n          </Box>\n          <ArrowIcon className={classes.arrow} />\n        </Box>\n      </Link>\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentClass, Component, ErrorInfo } from 'react';\nimport { Button } from '../../components/Button';\nimport { ErrorPanel } from '../../components/ErrorPanel';\n\ntype SlackChannel = {\n  name: string;\n  href?: string;\n};\n\n/** @public */\nexport type ErrorBoundaryProps = {\n  slackChannel?: string | SlackChannel;\n  onError?: (error: Error, errorInfo: string) => null;\n};\n\ntype State = {\n  error?: Error;\n  errorInfo?: ErrorInfo;\n};\n\nconst SlackLink = (props: { slackChannel?: string | SlackChannel }) => {\n  const { slackChannel } = props;\n\n  if (!slackChannel) {\n    return null;\n  } else if (typeof slackChannel === 'string') {\n    return <>Please contact {slackChannel} for help.</>;\n  } else if (!slackChannel.href) {\n    return <>Please contact {slackChannel.name} for help.</>;\n  }\n\n  return (\n    <Button to={slackChannel.href} variant=\"contained\">\n      {slackChannel.name}\n    </Button>\n  );\n};\n\n/** @public */\nexport const ErrorBoundary: ComponentClass<\n  ErrorBoundaryProps,\n  State\n> = class ErrorBoundary extends Component<ErrorBoundaryProps, State> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = {\n      error: undefined,\n      errorInfo: undefined,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // eslint-disable-next-line no-console\n    console.error(`ErrorBoundary, error: ${error}, info: ${errorInfo}`);\n    this.setState({ error, errorInfo });\n  }\n\n  render() {\n    const { slackChannel, children } = this.props;\n    const { error } = this.state;\n\n    if (!error) {\n      return children;\n    }\n\n    return (\n      <ErrorPanel title=\"Something Went Wrong\" error={error}>\n        <SlackLink slackChannel={slackChannel} />\n      </ErrorPanel>\n    );\n  }\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardHeader, { CardHeaderProps } from '@material-ui/core/CardHeader';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport classNames from 'classnames';\nimport React, { ReactNode } from 'react';\nimport { BottomLink, BottomLinkProps } from '../BottomLink';\nimport { ErrorBoundary, ErrorBoundaryProps } from '../ErrorBoundary';\n\n/** @public */\nexport type InfoCardClassKey =\n  | 'noPadding'\n  | 'header'\n  | 'headerTitle'\n  | 'headerSubheader'\n  | 'headerAvatar'\n  | 'headerAction'\n  | 'headerContent';\n\nconst useStyles = makeStyles(\n  theme => ({\n    noPadding: {\n      padding: 0,\n      '&:last-child': {\n        paddingBottom: 0,\n      },\n    },\n    header: {\n      padding: theme.spacing(2, 2, 2, 2.5),\n    },\n    headerTitle: {\n      fontWeight: 700,\n    },\n    headerSubheader: {\n      paddingTop: theme.spacing(1),\n    },\n    headerAvatar: {},\n    headerAction: {},\n    headerContent: {},\n    subheader: {\n      display: 'flex',\n    },\n  }),\n  { name: 'BackstageInfoCard' },\n);\n\n/** @public */\nexport type CardActionsTopRightClassKey = 'root';\n\nconst CardActionsTopRight = withStyles(\n  theme => ({\n    root: {\n      display: 'inline-block',\n      padding: theme.spacing(8, 8, 0, 0),\n      float: 'right',\n    },\n  }),\n  { name: 'BackstageInfoCardCardActionsTopRight' },\n)(CardActions);\n\nconst VARIANT_STYLES = {\n  card: {\n    flex: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    fullHeight: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100%',\n    },\n    gridItem: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: 'calc(100% - 10px)', // for pages without content header\n      marginBottom: '10px',\n    },\n  },\n  cardContent: {\n    fullHeight: {\n      flex: 1,\n    },\n    gridItem: {\n      flex: 1,\n    },\n  },\n};\n\n/** @public */\nexport type InfoCardVariants = 'flex' | 'fullHeight' | 'gridItem';\n\n/**\n * InfoCard is used to display a paper-styled block on the screen, similar to a panel.\n *\n * You can custom style an InfoCard with the 'className' (outer container) and 'cardClassName' (inner container)\n * props. This is typically used with the material-ui makeStyles mechanism.\n *\n * The InfoCard serves as an error boundary. As a result, if you provide an 'errorBoundaryProps' property this\n * specifies the extra information to display in the error component that is displayed if an error occurs\n * in any descendent components.\n *\n * By default the InfoCard has no custom layout of its children, but is treated as a block element. A\n * couple common variants are provided and can be specified via the variant property:\n *\n * When the InfoCard is displayed as a grid item within a grid, you may want items to have the same height for all items.\n * Set to the 'gridItem' variant to display the InfoCard with full height suitable for Grid:\n *\n * `<InfoCard variant=\"gridItem\">...</InfoCard>`\n */\ntype Props = {\n  title?: ReactNode;\n  subheader?: ReactNode;\n  divider?: boolean;\n  deepLink?: BottomLinkProps;\n  /** @deprecated Use errorBoundaryProps instead */\n  slackChannel?: string;\n  errorBoundaryProps?: ErrorBoundaryProps;\n  variant?: InfoCardVariants;\n  children?: ReactNode;\n  headerStyle?: object;\n  headerProps?: CardHeaderProps;\n  icon?: ReactNode;\n  action?: ReactNode;\n  actionsClassName?: string;\n  actions?: ReactNode;\n  cardClassName?: string;\n  actionsTopRight?: ReactNode;\n  className?: string;\n  noPadding?: boolean;\n  titleTypographyProps?: object;\n};\n\n/**\n * Material-ui card with header , content and actions footer\n *\n * @public\n *\n */\nexport function InfoCard(props: Props): JSX.Element {\n  const {\n    title,\n    subheader,\n    divider = true,\n    deepLink,\n    slackChannel,\n    errorBoundaryProps,\n    variant,\n    children,\n    headerStyle,\n    headerProps,\n    icon,\n    action,\n    actionsClassName,\n    actions,\n    cardClassName,\n    actionsTopRight,\n    className,\n    noPadding,\n    titleTypographyProps,\n  } = props;\n  const classes = useStyles();\n  /**\n   * If variant is specified, we build up styles for that particular variant for both\n   * the Card and the CardContent (since these need to be synced)\n   */\n  let calculatedStyle = {};\n  let calculatedCardStyle = {};\n  if (variant) {\n    const variants = variant.split(/[\\s]+/g);\n    variants.forEach(name => {\n      calculatedStyle = {\n        ...calculatedStyle,\n        ...VARIANT_STYLES.card[name as keyof typeof VARIANT_STYLES['card']],\n      };\n      calculatedCardStyle = {\n        ...calculatedCardStyle,\n        ...VARIANT_STYLES.cardContent[\n          name as keyof typeof VARIANT_STYLES['cardContent']\n        ],\n      };\n    });\n  }\n\n  const cardSubTitle = () => {\n    return (\n      <div className={classes.headerSubheader}>\n        {subheader && <div className={classes.subheader}>{subheader}</div>}\n        {icon}\n      </div>\n    );\n  };\n\n  const errProps: ErrorBoundaryProps =\n    errorBoundaryProps || (slackChannel ? { slackChannel } : {});\n\n  return (\n    <Card style={calculatedStyle} className={className}>\n      <ErrorBoundary {...errProps}>\n        {title && (\n          <CardHeader\n            classes={{\n              root: classes.header,\n              title: classes.headerTitle,\n              subheader: classes.headerSubheader,\n              avatar: classes.headerAvatar,\n              action: classes.headerAction,\n              content: classes.headerContent,\n            }}\n            title={title}\n            subheader={cardSubTitle()}\n            action={action}\n            style={{ ...headerStyle }}\n            titleTypographyProps={titleTypographyProps}\n            {...headerProps}\n          />\n        )}\n        {actionsTopRight && (\n          <CardActionsTopRight>{actionsTopRight}</CardActionsTopRight>\n        )}\n        {divider && <Divider />}\n        <CardContent\n          className={classNames(cardClassName, {\n            [classes.noPadding]: noPadding,\n          })}\n          style={calculatedCardStyle}\n        >\n          {children}\n        </CardContent>\n        {actions && (\n          <CardActions className={actionsClassName}>{actions}</CardActions>\n        )}\n        {deepLink && <BottomLink {...deepLink} />}\n      </ErrorBoundary>\n    </Card>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstagePalette, BackstageTheme } from '@backstage/theme';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport { Circle } from 'rc-progress';\nimport React, { ReactNode, useEffect, useState } from 'react';\n\n/** @public */\nexport type GaugeClassKey =\n  | 'root'\n  | 'overlay'\n  | 'description'\n  | 'circle'\n  | 'colorUnknown';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    root: {\n      position: 'relative',\n      lineHeight: 0,\n    },\n    overlay: {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -60%)',\n      fontSize: 45,\n      fontWeight: 'bold',\n      color: theme.palette.textContrast,\n    },\n    description: {\n      fontSize: '100%',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)',\n      position: 'absolute',\n      wordBreak: 'break-all',\n      display: 'inline-block',\n    },\n    circle: {\n      width: '80%',\n      transform: 'translate(10%, 0)',\n    },\n    colorUnknown: {},\n  }),\n  { name: 'BackstageGauge' },\n);\n\n/** @public */\nexport type GaugeProps = {\n  value: number;\n  fractional?: boolean;\n  inverse?: boolean;\n  unit?: string;\n  max?: number;\n  description?: ReactNode;\n  getColor?: GaugePropsGetColor;\n};\n\n/** @public */\nexport type GaugePropsGetColorOptions = {\n  palette: BackstagePalette;\n  value: number;\n  inverse?: boolean;\n  max?: number;\n};\n\n/** @public */\nexport type GaugePropsGetColor = (args: GaugePropsGetColorOptions) => string;\n\nconst defaultGaugeProps = {\n  fractional: true,\n  inverse: false,\n  unit: '%',\n  max: 100,\n};\n\nexport const getProgressColor: GaugePropsGetColor = ({\n  palette,\n  value,\n  inverse,\n  max,\n}) => {\n  if (isNaN(value)) {\n    return '#ddd';\n  }\n\n  const actualMax = max ? max : defaultGaugeProps.max;\n  const actualValue = inverse ? actualMax - value : value;\n\n  if (actualValue < actualMax / 3) {\n    return palette.status.error;\n  } else if (actualValue < actualMax * (2 / 3)) {\n    return palette.status.warning;\n  }\n\n  return palette.status.ok;\n};\n\n/**\n * Circular Progress Bar\n *\n * @public\n *\n */\n\nexport function Gauge(props: GaugeProps) {\n  const [hoverRef, setHoverRef] = useState<HTMLDivElement | null>(null);\n  const { getColor = getProgressColor } = props;\n  const classes = useStyles(props);\n  const { palette } = useTheme<BackstageTheme>();\n  const { value, fractional, inverse, unit, max, description } = {\n    ...defaultGaugeProps,\n    ...props,\n  };\n\n  const asPercentage = fractional ? Math.round(value * max) : value;\n  const asActual = max !== 100 ? Math.round(value) : asPercentage;\n\n  const [isHovering, setIsHovering] = useState(false);\n\n  useEffect(() => {\n    const node = hoverRef;\n    const handleMouseOver = () => setIsHovering(true);\n    const handleMouseOut = () => setIsHovering(false);\n    if (node && description) {\n      node.addEventListener('mouseenter', handleMouseOver);\n      node.addEventListener('mouseleave', handleMouseOut);\n\n      return () => {\n        node.removeEventListener('mouseenter', handleMouseOver);\n        node.removeEventListener('mouseleave', handleMouseOut);\n      };\n    }\n    return () => {\n      setIsHovering(false);\n    };\n  }, [description, hoverRef]);\n\n  return (\n    <div ref={setHoverRef} className={classes.root}>\n      <Circle\n        strokeLinecap=\"butt\"\n        percent={asPercentage}\n        strokeWidth={12}\n        trailWidth={12}\n        strokeColor={getColor({ palette, value: asActual, inverse, max })}\n        className={classes.circle}\n      />\n      {description && isHovering ? (\n        <div className={classes.description}>{description}</div>\n      ) : (\n        <div className={classes.overlay}>\n          {isNaN(value) ? 'N/A' : `${asActual}${unit}`}\n        </div>\n      )}\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { ReactNode } from 'react';\nimport { BottomLinkProps } from '../../layout/BottomLink';\nimport { InfoCard, InfoCardVariants } from '../../layout/InfoCard';\nimport { Gauge, GaugePropsGetColor } from './Gauge';\n\ntype Props = {\n  title: string;\n  subheader?: string;\n  variant?: InfoCardVariants;\n  /** Progress in % specified as decimal, e.g. \"0.23\" */\n  progress: number;\n  description?: ReactNode;\n  icon?: ReactNode;\n  inverse?: boolean;\n  deepLink?: BottomLinkProps;\n  getColor?: GaugePropsGetColor;\n};\n\n/** @public */\nexport type GaugeCardClassKey = 'root';\n\nconst useStyles = makeStyles(\n  {\n    root: {\n      height: '100%',\n      width: 250,\n    },\n  },\n  { name: 'BackstageGaugeCard' },\n);\n\n/**\n * {@link Gauge} with header, subheader and footer\n *\n * @public\n *\n */\nexport function GaugeCard(props: Props) {\n  const classes = useStyles(props);\n  const {\n    title,\n    subheader,\n    progress,\n    inverse,\n    deepLink,\n    description,\n    icon,\n    variant,\n    getColor,\n  } = props;\n\n  const gaugeProps = {\n    inverse,\n    description,\n    getColor,\n    value: progress,\n  };\n\n  return (\n    <div className={classes.root}>\n      <InfoCard\n        title={title}\n        subheader={subheader}\n        deepLink={deepLink}\n        variant={variant}\n        icon={icon}\n      >\n        <Gauge {...gaugeProps} />\n      </InfoCard>\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { useTheme } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { Line } from 'rc-progress';\nimport { BackstageTheme } from '@backstage/theme';\nimport { getProgressColor, GaugePropsGetColor } from './Gauge';\n\ntype Props = {\n  /**\n   * Progress value between 0.0 - 1.0.\n   */\n  value: number;\n  getColor?: GaugePropsGetColor;\n};\n\nexport function LinearGauge(props: Props) {\n  const { value, getColor = getProgressColor } = props;\n  const { palette } = useTheme<BackstageTheme>();\n  if (isNaN(value)) {\n    return null;\n  }\n  let percent = Math.round(value * 100 * 100) / 100;\n  if (percent > 100) {\n    percent = 100;\n  }\n  const strokeColor = getColor({\n    palette,\n    value: percent,\n    inverse: false,\n    max: 100,\n  });\n  return (\n    <Tooltip title={`${percent}%`}>\n      <span>\n        <Line\n          percent={percent}\n          strokeWidth={4}\n          trailWidth={4}\n          strokeColor={strokeColor}\n        />\n      </span>\n    </Tooltip>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\n/** @public */\nexport type ClosedDropdownClassKey = 'icon';\n\nconst useStyles = makeStyles(\n  () =>\n    createStyles({\n      icon: {\n        position: 'absolute',\n        right: '4px',\n        pointerEvents: 'none',\n      },\n    }),\n  { name: 'BackstageClosedDropdown' },\n);\n\nconst ClosedDropdown = () => {\n  const classes = useStyles();\n  return (\n    <SvgIcon\n      className={classes.icon}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M7.5 8L6 9.5L12.0703 15.5703L18.1406 9.5L16.6406 8L12.0703 12.5703L7.5 8Z\"\n        fill=\"#616161\"\n      />\n    </SvgIcon>\n  );\n};\n\nexport default ClosedDropdown;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\nexport type OpenedDropdownClassKey = 'icon';\n\nconst useStyles = makeStyles(\n  () =>\n    createStyles({\n      icon: {\n        position: 'absolute',\n        right: '4px',\n        pointerEvents: 'none',\n      },\n    }),\n  { name: 'BackstageOpenedDropdown' },\n);\n\nconst OpenedDropdown = () => {\n  const classes = useStyles();\n  return (\n    <SvgIcon\n      className={classes.icon}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M16.5 16L18 14.5L11.9297 8.42969L5.85938 14.5L7.35938 16L11.9297 11.4297L16.5 16Z\"\n        fill=\"#616161\"\n      />\n    </SvgIcon>\n  );\n};\n\nexport default OpenedDropdown;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Chip from '@material-ui/core/Chip';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputBase from '@material-ui/core/InputBase';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport {\n  createStyles,\n  makeStyles,\n  Theme,\n  withStyles,\n} from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React, { useEffect, useState } from 'react';\nimport ClosedDropdown from './static/ClosedDropdown';\nimport OpenedDropdown from './static/OpenedDropdown';\n\n/** @public */\nexport type SelectInputBaseClassKey = 'root' | 'input';\n\nconst BootstrapInput = withStyles(\n  (theme: Theme) =>\n    createStyles({\n      root: {\n        'label + &': {\n          marginTop: theme.spacing(3),\n        },\n      },\n      input: {\n        borderRadius: 4,\n        position: 'relative',\n        backgroundColor: theme.palette.background.paper,\n        border: '1px solid #ced4da',\n        fontSize: 16,\n        padding: '10px 26px 10px 12px',\n        transition: theme.transitions.create(['border-color', 'box-shadow']),\n        fontFamily: 'Helvetica Neue',\n        '&:focus': {\n          background: theme.palette.background.paper,\n          borderRadius: 4,\n        },\n      },\n    }),\n  { name: 'BackstageSelectInputBase' },\n)(InputBase);\n\n/** @public */\nexport type SelectClassKey =\n  | 'formControl'\n  | 'label'\n  | 'chips'\n  | 'chip'\n  | 'checkbox'\n  | 'root';\n\nconst useStyles = makeStyles(\n  (theme: Theme) =>\n    createStyles({\n      formControl: {\n        margin: `${theme.spacing(1)} 0px`,\n        maxWidth: 300,\n      },\n      label: {\n        transform: 'initial',\n        fontWeight: 'bold',\n        fontSize: 14,\n        fontFamily: theme.typography.fontFamily,\n        color: theme.palette.text.primary,\n        '&.Mui-focused': {\n          color: theme.palette.text.primary,\n        },\n      },\n      chips: {\n        display: 'flex',\n        flexWrap: 'wrap',\n      },\n      chip: {\n        margin: 2,\n      },\n      checkbox: {},\n\n      root: {\n        display: 'flex',\n        flexDirection: 'column',\n      },\n    }),\n  { name: 'BackstageSelect' },\n);\n\n/** @public */\nexport type SelectItem = {\n  label: string;\n  value: string | number;\n};\n\n/** @public */\nexport type SelectedItems = string | string[] | number | number[];\n\nexport type SelectProps = {\n  multiple?: boolean;\n  items: SelectItem[];\n  label: string;\n  placeholder?: string;\n  selected?: SelectedItems;\n  onChange: (arg: SelectedItems) => void;\n  triggerReset?: boolean;\n  native?: boolean;\n  disabled?: boolean;\n};\n\n/** @public */\nexport function SelectComponent(props: SelectProps) {\n  const {\n    multiple,\n    items,\n    label,\n    placeholder,\n    selected,\n    onChange,\n    triggerReset,\n    native = false,\n    disabled = false,\n  } = props;\n  const classes = useStyles();\n  const [value, setValue] = useState<SelectedItems>(\n    selected || (multiple ? [] : ''),\n  );\n  const [isOpen, setOpen] = useState(false);\n\n  useEffect(() => {\n    setValue(multiple ? [] : '');\n  }, [triggerReset, multiple]);\n\n  useEffect(() => {\n    if (selected !== undefined) {\n      setValue(selected);\n    }\n  }, [selected]);\n\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    setValue(event.target.value as SelectedItems);\n    onChange(event.target.value as SelectedItems);\n  };\n\n  const handleClick = (event: React.ChangeEvent<any>) => {\n    if (disabled) {\n      event.preventDefault();\n      return;\n    }\n    setOpen(previous => {\n      if (multiple && !(event.target instanceof HTMLElement)) {\n        return true;\n      }\n      return !previous;\n    });\n  };\n\n  const handleClickAway = () => {\n    setOpen(false);\n  };\n\n  const handleDelete = (selectedValue: string | number) => () => {\n    const newValue = (value as any[]).filter(chip => chip !== selectedValue);\n    setValue(newValue);\n    onChange(newValue);\n  };\n\n  return (\n    <div className={classes.root}>\n      <Typography variant=\"button\">{label}</Typography>\n      <ClickAwayListener onClickAway={handleClickAway}>\n        <FormControl className={classes.formControl}>\n          <Select\n            value={value}\n            native={native}\n            disabled={disabled}\n            data-testid=\"select\"\n            displayEmpty\n            multiple={multiple}\n            onChange={handleChange}\n            onClick={handleClick}\n            open={isOpen}\n            input={<BootstrapInput />}\n            renderValue={s =>\n              multiple && (value as any[]).length !== 0 ? (\n                <div className={classes.chips}>\n                  {(s as string[]).map(selectedValue => (\n                    <Chip\n                      key={items.find(el => el.value === selectedValue)?.value}\n                      label={\n                        items.find(el => el.value === selectedValue)?.label\n                      }\n                      clickable\n                      onDelete={handleDelete(selectedValue)}\n                      className={classes.chip}\n                    />\n                  ))}\n                </div>\n              ) : (\n                <Typography>\n                  {(value as any[]).length === 0\n                    ? placeholder || ''\n                    : items.find(el => el.value === s)?.label}\n                </Typography>\n              )\n            }\n            IconComponent={() =>\n              !isOpen ? <ClosedDropdown /> : <OpenedDropdown />\n            }\n            MenuProps={{\n              anchorOrigin: {\n                vertical: 'bottom',\n                horizontal: 'left',\n              },\n              transformOrigin: {\n                vertical: 'top',\n                horizontal: 'left',\n              },\n              getContentAnchorEl: null,\n            }}\n          >\n            {placeholder && !multiple && (\n              <MenuItem value={[]}>{placeholder}</MenuItem>\n            )}\n            {native\n              ? items &&\n                items.map(item => (\n                  <option value={item.value} key={item.value}>\n                    {item.label}\n                  </option>\n                ))\n              : items &&\n                items.map(item => (\n                  <MenuItem key={item.value} value={item.value}>\n                    {multiple && (\n                      <Checkbox\n                        color=\"primary\"\n                        checked={(value as any[]).includes(item.value) || false}\n                        className={classes.checkbox}\n                      />\n                    )}\n                    {item.label}\n                  </MenuItem>\n                ))}\n          </Select>\n        </FormControl>\n      </ClickAwayListener>\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, {\n  Children,\n  isValidElement,\n  useState,\n  useEffect,\n  PropsWithChildren,\n} from 'react';\nimport MuiStepper from '@material-ui/core/Stepper';\n\ntype InternalState = {\n  stepperLength: number;\n  stepIndex: number;\n  setStepIndex: any;\n  stepHistory: number[];\n  setStepHistory: any;\n  onStepChange?: (prevIndex: number, nextIndex: number) => void;\n};\n\nconst noop = () => {};\nexport const VerticalStepperContext = React.createContext<InternalState>({\n  stepperLength: 0,\n  stepIndex: 0,\n  setStepIndex: noop,\n  stepHistory: [],\n  setStepHistory: noop,\n  onStepChange: noop,\n});\n\nexport interface StepperProps {\n  elevated?: boolean;\n  onStepChange?: (prevIndex: number, nextIndex: number) => void;\n  activeStep?: number;\n}\n\nexport function SimpleStepper(props: PropsWithChildren<StepperProps>) {\n  const { children, elevated, onStepChange, activeStep = 0 } = props;\n  const [stepIndex, setStepIndex] = useState<number>(activeStep);\n  const [stepHistory, setStepHistory] = useState<number[]>([0]);\n\n  useEffect(() => {\n    setStepIndex(activeStep);\n  }, [activeStep]);\n\n  const steps: React.ReactNode[] = [];\n  let endStep;\n  Children.forEach(children, child => {\n    if (isValidElement(child)) {\n      if (child.props.end) {\n        endStep = child;\n      } else {\n        steps.push(child);\n      }\n    }\n  });\n\n  return (\n    <>\n      <VerticalStepperContext.Provider\n        value={{\n          stepIndex,\n          setStepIndex,\n          stepHistory,\n          setStepHistory,\n          onStepChange,\n          stepperLength: Children.count(children),\n        }}\n      >\n        <MuiStepper\n          activeStep={stepIndex}\n          orientation=\"vertical\"\n          elevation={elevated ? 2 : 0}\n        >\n          {steps}\n        </MuiStepper>\n      </VerticalStepperContext.Provider>\n      {stepIndex >= Children.count(children) - 1 && endStep}\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useContext, ReactNode, PropsWithChildren } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport { StepActions } from './types';\nimport { VerticalStepperContext } from './SimpleStepper';\n\nexport type SimpleStepperFooterClassKey = 'root';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      marginTop: theme.spacing(3),\n      '& button': {\n        marginRight: theme.spacing(1),\n      },\n    },\n  }),\n  { name: 'BackstageSimpleStepperFooter' },\n);\n\ninterface CommonBtnProps {\n  text?: string;\n  handleClick?: () => void;\n  stepIndex: number;\n}\ninterface RestartBtnProps extends CommonBtnProps {}\n\ninterface NextBtnProps extends CommonBtnProps {\n  disabled?: boolean;\n  last?: boolean;\n  stepIndex: number;\n}\ninterface BackBtnProps extends CommonBtnProps {\n  disabled?: boolean;\n  stepIndex: number;\n}\nexport const RestartBtn = ({ text, handleClick }: RestartBtnProps) => (\n  <Button onClick={handleClick}>{text || 'Reset'}</Button>\n);\n\nconst NextBtn = ({\n  text,\n  handleClick,\n  disabled,\n  last,\n  stepIndex,\n}: NextBtnProps) => (\n  <Button\n    variant=\"contained\"\n    color=\"primary\"\n    disabled={disabled}\n    data-testid={`nextButton-${stepIndex}`}\n    onClick={handleClick}\n  >\n    {text || (last ? 'Finish' : 'Next')}\n  </Button>\n);\n\nconst BackBtn = ({ text, handleClick, disabled, stepIndex }: BackBtnProps) => (\n  <Button\n    onClick={handleClick}\n    data-testid={`backButton-${stepIndex}`}\n    disabled={disabled}\n  >\n    {text || 'Back'}\n  </Button>\n);\n\nexport type SimpleStepperFooterProps = {\n  actions?: StepActions;\n  children?: ReactNode;\n};\n\nexport const SimpleStepperFooter = ({\n  actions = {},\n  children,\n}: PropsWithChildren<SimpleStepperFooterProps>) => {\n  const classes = useStyles();\n  const {\n    stepperLength,\n    stepIndex,\n    setStepIndex,\n    stepHistory,\n    setStepHistory,\n    onStepChange,\n  } = useContext(VerticalStepperContext);\n\n  const onChange = (newIndex: number, callback?: () => void) => {\n    if (callback) {\n      callback();\n    }\n    if (onStepChange) {\n      onStepChange(stepIndex, newIndex);\n    }\n\n    setStepIndex(newIndex);\n  };\n\n  const handleNext = () => {\n    const newIndex = actions.nextStep\n      ? actions.nextStep(stepIndex, stepperLength - 1)\n      : stepIndex + 1;\n    onChange(newIndex, actions.onNext);\n    setStepHistory([...stepHistory, newIndex]);\n  };\n  const handleBack = () => {\n    stepHistory.pop();\n    onChange(stepHistory[stepHistory.length - 1], actions.onBack);\n    setStepHistory([...stepHistory]);\n  };\n  const handleRestart = () => {\n    onChange(0, actions.onRestart);\n    setStepHistory([0]);\n  };\n\n  return (\n    <div className={classes.root}>\n      {[undefined, true].includes(actions.showBack) && stepIndex !== 0 && (\n        <BackBtn\n          text={actions.backText}\n          handleClick={handleBack}\n          disabled={stepIndex === 0}\n          stepIndex={stepIndex}\n        />\n      )}\n      {[undefined, true].includes(actions.showNext) && (\n        <NextBtn\n          text={actions.nextText}\n          handleClick={handleNext}\n          disabled={\n            (!!stepperLength && stepIndex >= stepperLength) ||\n            (!!actions.canNext && !actions.canNext())\n          }\n          stepIndex={stepIndex}\n        />\n      )}\n      {actions.showRestart && stepIndex !== 0 && (\n        <RestartBtn\n          text={actions.restartText}\n          handleClick={handleRestart}\n          stepIndex={stepIndex}\n        />\n      )}\n      {children}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { PropsWithChildren } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MuiStep from '@material-ui/core/Step';\nimport StepContent from '@material-ui/core/StepContent';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Typography from '@material-ui/core/Typography';\nimport { SimpleStepperFooter } from './SimpleStepperFooter';\nimport { StepProps } from './types';\n\nexport type SimpleStepperStepClassKey = 'end';\n\nconst useStyles = makeStyles(\n  theme => ({\n    end: {\n      padding: theme.spacing(3),\n    },\n  }),\n  { name: 'SimpleStepperStep' },\n);\n\nexport function SimpleStepperStep(props: PropsWithChildren<StepProps>) {\n  const { title, children, end, actions, ...muiProps } = props;\n  const classes = useStyles();\n\n  // The end step is not a part of the stepper\n  // It simply is the final screen with an option to have buttons such as reset or back\n  return end ? (\n    <div className={classes.end}>\n      <Typography variant=\"h6\">{title}</Typography>\n      {children}\n      <SimpleStepperFooter actions={{ ...(actions || {}), showNext: false }} />\n    </div>\n  ) : (\n    <MuiStep {...muiProps}>\n      <StepLabel>\n        <Typography variant=\"h6\">{title}</Typography>\n      </StepLabel>\n      <StepContent>\n        {children}\n        <SimpleStepperFooter actions={actions} />\n      </StepContent>\n    </MuiStep>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\nimport classNames from 'classnames';\nimport React, { PropsWithChildren } from 'react';\n\nexport type StatusClassKey =\n  | 'status'\n  | 'ok'\n  | 'warning'\n  | 'error'\n  | 'pending'\n  | 'running'\n  | 'aborted';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    status: {\n      fontWeight: 500,\n      '&::before': {\n        width: '0.7em',\n        height: '0.7em',\n        display: 'inline-block',\n        marginRight: 8,\n        borderRadius: '50%',\n        content: '\"\"',\n      },\n    },\n    ok: {\n      '&::before': {\n        backgroundColor: theme.palette.status.ok,\n      },\n    },\n    warning: {\n      '&::before': {\n        backgroundColor: theme.palette.status.warning,\n      },\n    },\n    error: {\n      '&::before': {\n        backgroundColor: theme.palette.status.error,\n      },\n    },\n    pending: {\n      '&::before': {\n        backgroundColor: theme.palette.status.pending,\n      },\n    },\n    running: {\n      '&::before': {\n        backgroundColor: theme.palette.status.running,\n      },\n    },\n    aborted: {\n      '&::before': {\n        backgroundColor: theme.palette.status.aborted,\n      },\n    },\n  }),\n  { name: 'BackstageStatus' },\n);\n\nexport function StatusOK(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.ok)}\n      aria-label=\"Status ok\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n\nexport function StatusWarning(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.warning)}\n      aria-label=\"Status warning\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n\nexport function StatusError(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.error)}\n      aria-label=\"Status error\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n\nexport function StatusPending(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.pending)}\n      aria-label=\"Status pending\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n\nexport function StatusRunning(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.running)}\n      aria-label=\"Status running\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n\nexport function StatusAborted(props: PropsWithChildren<{}>) {\n  const classes = useStyles(props);\n  return (\n    <span\n      className={classNames(classes.status, classes.aborted)}\n      aria-label=\"Status aborted\"\n      aria-hidden=\"true\"\n      {...props}\n    />\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  withStyles,\n  createStyles,\n  WithStyles,\n  Theme,\n} from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableRow from '@material-ui/core/TableRow';\n\nexport type MetadataTableTitleCellClassKey = 'root';\n\nconst tableTitleCellStyles = (theme: Theme) =>\n  createStyles({\n    root: {\n      fontWeight: 'bolder',\n      whiteSpace: 'nowrap',\n      paddingRight: theme.spacing(4),\n      border: '0',\n      verticalAlign: 'top',\n    },\n  });\n\nexport type MetadataTableCellClassKey = 'root';\n\nconst tableContentCellStyles = {\n  root: {\n    border: '0',\n    verticalAlign: 'top',\n  },\n};\n\nexport type MetadataTableListClassKey = 'root';\n\nconst listStyles = (theme: Theme) =>\n  createStyles({\n    root: {\n      listStyle: 'none',\n      margin: theme.spacing(0, 0, -1, 0),\n      padding: '0',\n    },\n  });\n\nexport type MetadataTableListItemClassKey = 'root' | 'random';\n\nconst listItemStyles = (theme: Theme) =>\n  createStyles({\n    root: {\n      padding: theme.spacing(0, 0, 1, 0),\n    },\n    random: {},\n  });\n\nconst TitleCell = withStyles(tableTitleCellStyles, {\n  name: 'BackstageMetadataTableTitleCell',\n})(TableCell);\nconst ContentCell = withStyles(tableContentCellStyles, {\n  name: 'BackstageMetadataTableCell',\n})(TableCell);\n\nexport const MetadataTable = ({\n  dense,\n  children,\n}: {\n  dense?: boolean;\n  children: React.ReactNode;\n}) => (\n  <Table size={dense ? 'small' : 'medium'}>\n    <TableBody>{children}</TableBody>\n  </Table>\n);\n\nexport const MetadataTableItem = ({\n  title,\n  children,\n  ...rest\n}: {\n  title: string;\n  children: React.ReactNode;\n}) => (\n  <TableRow>\n    {title && <TitleCell>{title}</TitleCell>}\n    <ContentCell colSpan={title ? 1 : 2} {...rest}>\n      {children}\n    </ContentCell>\n  </TableRow>\n);\n\ninterface StyleProps extends WithStyles {\n  children?: React.ReactNode;\n}\n\nexport const MetadataList = withStyles(listStyles, {\n  name: 'BackstageMetadataTableList',\n})(({ classes, children }: StyleProps) => (\n  <ul className={classes.root}>{children}</ul>\n));\n\nexport const MetadataListItem = withStyles(listItemStyles, {\n  name: 'BackstageMetadataTableListItem',\n})(({ classes, children }: StyleProps) => (\n  <li className={classes.root}>{children}</li>\n));\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { Fragment, ReactElement } from 'react';\nimport {\n  withStyles,\n  createStyles,\n  WithStyles,\n  Theme,\n} from '@material-ui/core/styles';\nimport startCase from 'lodash/startCase';\n\nimport {\n  MetadataTable,\n  MetadataTableItem,\n  MetadataList,\n  MetadataListItem,\n} from './MetadataTable';\n\nexport type StructuredMetadataTableListClassKey = 'root';\n\nconst listStyle = createStyles({\n  root: {\n    margin: '0 0',\n    listStyleType: 'none',\n  },\n});\n\nexport type StructuredMetadataTableNestedListClassKey = 'root';\n\nconst nestedListStyle = (theme: Theme) =>\n  createStyles({\n    root: {\n      ...listStyle.root,\n      paddingLeft: theme.spacing(1),\n    },\n  });\n\ninterface StyleProps extends WithStyles {\n  children?: React.ReactNode;\n}\n// Sub Components\nconst StyledList = withStyles(listStyle, {\n  name: 'BackstageStructuredMetadataTableList',\n})(({ classes, children }: StyleProps) => (\n  <MetadataList classes={classes}>{children}</MetadataList>\n));\nconst StyledNestedList = withStyles(nestedListStyle, {\n  name: 'BackstageStructuredMetadataTableNestedList',\n})(({ classes, children }: StyleProps) => (\n  <MetadataList classes={classes}>{children}</MetadataList>\n));\n\nfunction renderList(list: Array<any>, nested?: boolean) {\n  const values = list.map((item: any, index: number) => (\n    <MetadataListItem key={index}>{toValue(item)}</MetadataListItem>\n  ));\n  return nested ? (\n    <StyledNestedList>{values}</StyledNestedList>\n  ) : (\n    <StyledList>{values}</StyledList>\n  );\n}\n\nfunction renderMap(\n  map: { [key: string]: any },\n  nested?: boolean,\n  options?: any,\n) {\n  const values = Object.keys(map).map(key => {\n    const value = toValue(map[key], true);\n    const fmtKey =\n      options && options.titleFormat\n        ? options.titleFormat(key)\n        : startCase(key);\n    return (\n      <MetadataListItem key={key}>\n        {`${fmtKey}: `}\n        {value}\n      </MetadataListItem>\n    );\n  });\n\n  return nested ? (\n    <StyledNestedList>{values}</StyledNestedList>\n  ) : (\n    <StyledList>{values}</StyledList>\n  );\n}\n\nfunction toValue(\n  value: ReactElement | object | Array<any> | boolean,\n  options?: any,\n  nested?: boolean,\n) {\n  if (React.isValidElement(value)) {\n    return <Fragment>{value}</Fragment>;\n  }\n\n  if (typeof value === 'object' && !Array.isArray(value)) {\n    return renderMap(value, options, nested);\n  }\n\n  if (Array.isArray(value)) {\n    return renderList(value, nested);\n  }\n\n  if (typeof value === 'boolean') {\n    return <Fragment>{value ? '' : ''}</Fragment>;\n  }\n\n  return <Fragment>{value}</Fragment>;\n}\nconst ItemValue = ({ value, options }: { value: any; options: any }) => (\n  <Fragment>{toValue(value, options)}</Fragment>\n);\n\nconst TableItem = ({\n  title,\n  value,\n  options,\n}: {\n  title: string;\n  value: any;\n  options: any;\n}) => {\n  return (\n    <MetadataTableItem\n      title={\n        options && options.titleFormat\n          ? options.titleFormat(title)\n          : startCase(title)\n      }\n    >\n      <ItemValue value={value} options={options} />\n    </MetadataTableItem>\n  );\n};\n\nfunction mapToItems(info: { [key: string]: string }, options: any) {\n  return Object.keys(info).map(key => (\n    <TableItem key={key} title={key} value={info[key]} options={options} />\n  ));\n}\n\ntype Props = {\n  metadata: { [key: string]: any };\n  dense?: boolean;\n  options?: any;\n};\n\nexport function StructuredMetadataTable(props: Props) {\n  const { metadata, dense = true, options } = props;\n  const metadataItems = mapToItems(metadata, options || {});\n  return <MetadataTable dense={dense}>{metadataItems}</MetadataTable>;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEqual } from 'lodash';\nimport qs from 'qs';\nimport { useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { useDebouncedEffect } from '@react-hookz/web';\n\nfunction stringify(queryParams: any): string {\n  // Even though these setting don't look nice (e.g. escaped brackets), we should keep\n  // them this way. The current syntax handles all cases, including variable types with\n  // arrays or strings.\n  return qs.stringify(queryParams, {\n    strictNullHandling: true,\n  });\n}\n\nfunction parse(queryString: string): any {\n  return qs.parse(queryString, {\n    ignoreQueryPrefix: true,\n    strictNullHandling: true,\n  });\n}\n\nfunction extractState(queryString: string, stateName: string): any | undefined {\n  const queryParams = parse(queryString);\n\n  return queryParams[stateName];\n}\n\nfunction joinQueryString(\n  queryString: string,\n  stateName: string,\n  state: any,\n): string {\n  const queryParams = {\n    ...parse(queryString),\n    [stateName]: state,\n  };\n  return stringify(queryParams);\n}\n\ntype SetQueryParams<T> = (params: T) => void;\n\nexport function useQueryParamState<T>(\n  stateName: string,\n  /** @deprecated Don't configure a custom debouceTime */\n  debounceTime: number = 250,\n): [T | undefined, SetQueryParams<T>] {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const searchParamsString = searchParams.toString();\n  const [queryParamState, setQueryParamState] = useState<T>(\n    extractState(searchParamsString, stateName),\n  );\n\n  useEffect(() => {\n    const newState = extractState(searchParamsString, stateName);\n\n    setQueryParamState(oldState =>\n      isEqual(newState, oldState) ? oldState : newState,\n    );\n  }, [searchParamsString, setQueryParamState, stateName]);\n\n  useDebouncedEffect(\n    () => {\n      const queryString = joinQueryString(\n        searchParamsString,\n        stateName,\n        queryParamState,\n      );\n\n      if (searchParamsString !== queryString) {\n        setSearchParams(queryString, { replace: true });\n      }\n    },\n    [setSearchParams, queryParamState, searchParamsString, stateName],\n    debounceTime,\n  );\n\n  return [queryParamState, setQueryParamState];\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApiHolder, configApiRef } from '@backstage/core-plugin-api';\n\nexport type SupportItemLink = {\n  url: string;\n  title: string;\n};\n\nexport type SupportItem = {\n  title: string;\n  icon?: string;\n  links: SupportItemLink[];\n};\n\nexport type SupportConfig = {\n  url: string;\n  items: SupportItem[];\n};\n\nconst DEFAULT_SUPPORT_CONFIG: SupportConfig = {\n  url: 'https://github.com/backstage/backstage/issues',\n  items: [\n    {\n      title: 'Support Not Configured',\n      icon: 'warning',\n      links: [\n        {\n          // TODO: Update to dedicated support page on backstage.io/docs\n          title: 'Add `app.support` config key',\n          url: 'https://github.com/andrewthauer/backstage/blob/master/app-config.yaml',\n        },\n      ],\n    },\n  ],\n};\n\nexport function useSupportConfig(): SupportConfig {\n  const apiHolder = useApiHolder();\n  const config = apiHolder.get(configApiRef);\n  const supportConfig = config?.getOptionalConfig('app.support');\n\n  if (!supportConfig) {\n    return DEFAULT_SUPPORT_CONFIG;\n  }\n\n  return {\n    url: supportConfig.getString('url'),\n    items: supportConfig.getConfigArray('items').flatMap(itemConf => ({\n      title: itemConf.getString('title'),\n      icon: itemConf.getOptionalString('icon'),\n      links: (itemConf.getOptionalConfigArray('links') ?? []).flatMap(\n        linkConf => ({\n          url: linkConf.getString('url'),\n          title: linkConf.getString('title'),\n        }),\n      ),\n    })),\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconComponent, useApp } from '@backstage/core-plugin-api';\nimport MuiBrokenImageIcon from '@material-ui/icons/BrokenImage';\nimport React, { ComponentProps } from 'react';\n\ntype IconComponentProps = ComponentProps<IconComponent>;\n\nfunction useSystemIcon(key: string, props: IconComponentProps) {\n  const app = useApp();\n  const Icon = app.getSystemIcon(key);\n  return Icon ? <Icon {...props} /> : <MuiBrokenImageIcon {...props} />;\n}\n\n// Should match the list of overridable system icon keys in @backstage/core-app-api\n/**\n * Broken Image Icon\n *\n * @public\n *\n */\nexport function BrokenImageIcon(props: IconComponentProps) {\n  return useSystemIcon('brokenImage', props);\n}\n/** @public */\nexport function CatalogIcon(props: IconComponentProps) {\n  return useSystemIcon('catalog', props);\n}\n/** @public */\nexport function ChatIcon(props: IconComponentProps) {\n  return useSystemIcon('chat', props);\n}\n/** @public */\nexport function DashboardIcon(props: IconComponentProps) {\n  return useSystemIcon('dashboard', props);\n}\n/** @public */\nexport function DocsIcon(props: IconComponentProps) {\n  return useSystemIcon('docs', props);\n}\n/** @public */\nexport function EmailIcon(props: IconComponentProps) {\n  return useSystemIcon('email', props);\n}\n/** @public */\nexport function GitHubIcon(props: IconComponentProps) {\n  return useSystemIcon('github', props);\n}\n/** @public */\nexport function GroupIcon(props: IconComponentProps) {\n  return useSystemIcon('group', props);\n}\n/** @public */\nexport function HelpIcon(props: IconComponentProps) {\n  return useSystemIcon('help', props);\n}\n/** @public */\nexport function UserIcon(props: IconComponentProps) {\n  return useSystemIcon('user', props);\n}\n/** @public */\nexport function WarningIcon(props: IconComponentProps) {\n  return useSystemIcon('warning', props);\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApp } from '@backstage/core-plugin-api';\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport React, { MouseEventHandler, useState } from 'react';\nimport { SupportItem, SupportItemLink, useSupportConfig } from '../../hooks';\nimport { HelpIcon } from '../../icons';\nimport { Link } from '../Link';\n\ntype SupportButtonProps = {\n  title?: string;\n  children?: React.ReactNode;\n};\n\nexport type SupportButtonClassKey = 'popoverList';\n\nconst useStyles = makeStyles(\n  {\n    popoverList: {\n      minWidth: 260,\n      maxWidth: 400,\n    },\n  },\n  { name: 'BackstageSupportButton' },\n);\n\nconst SupportIcon = ({ icon }: { icon: string | undefined }) => {\n  const app = useApp();\n  const Icon = icon ? app.getSystemIcon(icon) ?? HelpIcon : HelpIcon;\n  return <Icon />;\n};\n\nconst SupportLink = ({ link }: { link: SupportItemLink }) => (\n  <Link to={link.url}>{link.title ?? link.url}</Link>\n);\n\nconst SupportListItem = ({ item }: { item: SupportItem }) => {\n  return (\n    <ListItem>\n      <ListItemIcon>\n        <SupportIcon icon={item.icon} />\n      </ListItemIcon>\n      <ListItemText\n        primary={item.title}\n        secondary={item.links?.reduce<React.ReactNodeArray>(\n          (prev, link, idx) => [\n            ...prev,\n            idx > 0 && <br key={idx} />,\n            <SupportLink link={link} key={link.url} />,\n          ],\n          [],\n        )}\n      />\n    </ListItem>\n  );\n};\n\nexport function SupportButton(props: SupportButtonProps) {\n  const { title, children } = props;\n  const { items } = useSupportConfig();\n\n  const [popoverOpen, setPopoverOpen] = useState(false);\n  const [anchorEl, setAnchorEl] = useState<Element | null>(null);\n  const classes = useStyles();\n  const isSmallScreen = useMediaQuery<BackstageTheme>(theme =>\n    theme.breakpoints.down('sm'),\n  );\n\n  const onClickHandler: MouseEventHandler = event => {\n    setAnchorEl(event.currentTarget);\n    setPopoverOpen(true);\n  };\n\n  const popoverCloseHandler = () => {\n    setPopoverOpen(false);\n  };\n\n  return (\n    <>\n      <Box display=\"flex\" ml={1}>\n        {isSmallScreen ? (\n          <IconButton\n            color=\"primary\"\n            size=\"small\"\n            onClick={onClickHandler}\n            data-testid=\"support-button\"\n          >\n            <HelpIcon />\n          </IconButton>\n        ) : (\n          <Button\n            data-testid=\"support-button\"\n            color=\"primary\"\n            onClick={onClickHandler}\n            startIcon={<HelpIcon />}\n          >\n            Support\n          </Button>\n        )}\n      </Box>\n      <Popover\n        data-testid=\"support-button-popover\"\n        open={popoverOpen}\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n        onClose={popoverCloseHandler}\n      >\n        <List className={classes.popoverList}>\n          {title && (\n            <ListItem alignItems=\"flex-start\">\n              <Typography variant=\"subtitle1\">{title}</Typography>\n            </ListItem>\n          )}\n          {React.Children.map(children, (child, i) => (\n            <ListItem alignItems=\"flex-start\" key={`child-${i}`}>\n              {child}\n            </ListItem>\n          ))}\n          {items &&\n            items.map((item, i) => (\n              <SupportListItem item={item} key={`item-${i}`} />\n            ))}\n        </List>\n        <DialogActions>\n          <Button color=\"primary\" onClick={popoverCloseHandler}>\n            Close\n          </Button>\n        </DialogActions>\n      </Popover>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, Dispatch, SetStateAction } from 'react';\n\nconst drawerWidthClosed = 72;\nconst iconPadding = 24;\nconst userBadgePadding = 18;\n\nexport const sidebarConfig = {\n  drawerWidthClosed,\n  drawerWidthOpen: 224,\n  // As per NN/g's guidance on timing for exposing hidden content\n  // See https://www.nngroup.com/articles/timing-exposing-content/\n  defaultOpenDelayMs: 100,\n  defaultCloseDelayMs: 0,\n  defaultFadeDuration: 200,\n  logoHeight: 32,\n  iconContainerWidth: drawerWidthClosed,\n  iconSize: drawerWidthClosed - iconPadding * 2,\n  iconPadding,\n  selectedIndicatorWidth: 3,\n  userBadgePadding,\n  userBadgeDiameter: drawerWidthClosed - userBadgePadding * 2,\n  mobileSidebarHeight: 56,\n};\n\nexport const submenuConfig = {\n  drawerWidthClosed: 0,\n  drawerWidthOpen: 202,\n  defaultOpenDelayMs: sidebarConfig.defaultOpenDelayMs + 200,\n};\n\nexport const SIDEBAR_INTRO_LOCAL_STORAGE =\n  '@backstage/core/sidebar-intro-dismissed';\n\n/**\n * Types for the `SidebarContext`\n */\nexport type SidebarContextType = {\n  isOpen: boolean;\n  setOpen: (open: boolean) => void;\n};\n\n/**\n * Context wether the `Sidebar` is open\n */\nexport const SidebarContext = createContext<SidebarContextType>({\n  isOpen: false,\n  setOpen: () => {},\n});\n\nexport type SidebarItemWithSubmenuContextType = {\n  isHoveredOn: boolean;\n  setIsHoveredOn: Dispatch<SetStateAction<boolean>>;\n};\n\nexport const SidebarItemWithSubmenuContext =\n  createContext<SidebarItemWithSubmenuContextType>({\n    isHoveredOn: false,\n    setIsHoveredOn: () => {},\n  });\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nenum LocalStorageKeys {\n  SIDEBAR_PIN_STATE = 'sidebarPinState',\n}\n\nexport const LocalStorage = {\n  getSidebarPinState(): boolean {\n    let value;\n    try {\n      value = JSON.parse(\n        window.localStorage.getItem(LocalStorageKeys.SIDEBAR_PIN_STATE) ||\n          'true',\n      );\n    } catch {\n      return true;\n    }\n    return !!value;\n  },\n  setSidebarPinState(state: boolean) {\n    return window.localStorage.setItem(\n      LocalStorageKeys.SIDEBAR_PIN_STATE,\n      JSON.stringify(state),\n    );\n  },\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport React, {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { sidebarConfig } from './config';\nimport { BackstageTheme } from '@backstage/theme';\nimport { LocalStorage } from './localStorage';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\n\nexport type SidebarPageClassKey = 'root';\n\nconst useStyles = makeStyles<BackstageTheme, { isPinned: boolean }>(\n  theme => ({\n    root: {\n      width: '100%',\n      transition: 'padding-left 0.1s ease-out',\n      isolation: 'isolate',\n      [theme.breakpoints.up('sm')]: {\n        paddingLeft: ({ isPinned }) =>\n          isPinned\n            ? sidebarConfig.drawerWidthOpen\n            : sidebarConfig.drawerWidthClosed,\n      },\n      [theme.breakpoints.down('xs')]: {\n        paddingBottom: sidebarConfig.mobileSidebarHeight,\n      },\n    },\n    content: {\n      zIndex: 0,\n      isolation: 'isolate',\n      '&:focus': {\n        outline: 0,\n      },\n    },\n  }),\n  { name: 'BackstageSidebarPage' },\n);\n\n/**\n * Type of `SidebarPinStateContext`\n *\n * @public\n */\nexport type SidebarPinStateContextType = {\n  isPinned: boolean;\n  toggleSidebarPinState: () => any;\n  isMobile?: boolean;\n};\n\n/**\n * Props for SidebarPage\n *\n * @public\n */\nexport type SidebarPageProps = {\n  children?: React.ReactNode;\n};\n\n/**\n * Contains the state on how the `Sidebar` is rendered\n *\n * @public\n */\nexport const SidebarPinStateContext = createContext<SidebarPinStateContextType>(\n  {\n    isPinned: true,\n    toggleSidebarPinState: () => {},\n    isMobile: false,\n  },\n);\n\ntype PageContextType = {\n  content: {\n    contentRef?: React.MutableRefObject<HTMLElement | null>;\n  };\n};\n\nconst PageContext = createContext<PageContextType>({\n  content: {\n    contentRef: undefined,\n  },\n});\nexport function SidebarPage(props: SidebarPageProps) {\n  const [isPinned, setIsPinned] = useState(() =>\n    LocalStorage.getSidebarPinState(),\n  );\n\n  const contentRef = useRef(null);\n\n  const pageContext = useMemo(\n    () => ({\n      content: {\n        contentRef,\n      },\n    }),\n    [contentRef],\n  );\n\n  useEffect(() => {\n    LocalStorage.setSidebarPinState(isPinned);\n  }, [isPinned]);\n\n  const isMobile = useMediaQuery<BackstageTheme>(\n    theme => theme.breakpoints.down('xs'),\n    { noSsr: true },\n  );\n\n  const toggleSidebarPinState = () => setIsPinned(!isPinned);\n\n  const classes = useStyles({ isPinned });\n\n  return (\n    <SidebarPinStateContext.Provider\n      value={{\n        isPinned,\n        toggleSidebarPinState,\n        isMobile,\n      }}\n    >\n      <PageContext.Provider value={pageContext}>\n        <div className={classes.root}>{props.children}</div>\n      </PageContext.Provider>\n    </SidebarPinStateContext.Provider>\n  );\n}\n\n/**\n * This hook provides a react ref to the main content.\n * Allows to set an element as the main content and focus on that component.\n *\n * *Note: If `contentRef` is not set `focusContent` is noop. `Content` component sets this ref automaticaly*\n *\n * @public\n * @example\n * Focus current content\n * ```tsx\n *  const { focusContent} = useContent();\n * ...\n *  <Button onClick={focusContent}>\n *     focus main content\n *  </Button>\n * ```\n * @example\n * Set the reference to an Html element\n * ```\n *  const { contentRef } = useContent();\n * ...\n *  <article ref={contentRef} tabIndex={-1}>Main Content</article>\n * ```\n */\nexport function useContent() {\n  const { content } = useContext(PageContext);\n\n  const focusContent = useCallback(() => {\n    content?.contentRef?.current?.focus();\n  }, [content]);\n\n  return { focusContent, contentRef: content?.contentRef };\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport BottomNavigationAction, {\n  BottomNavigationActionProps,\n} from '@material-ui/core/BottomNavigationAction';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useContext } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { SidebarPinStateContext } from '.';\nimport { Link } from '../../components';\nimport { sidebarConfig } from './config';\nimport { MobileSidebarContext } from './MobileSidebar';\n\n/**\n * Props for the `SidebarGroup`\n *\n * @public\n */\nexport interface SidebarGroupProps extends BottomNavigationActionProps {\n  /**\n   * If the `SidebarGroup` should be a `Link`, `to` should be a pathname to that location\n   */\n  to?: string;\n  /**\n   * If the `SidebarGroup`s should be in a different order than in the normal `Sidebar`, you can provide\n   * each `SidebarGroup` it's own priority to reorder them.\n   */\n  priority?: number;\n  /**\n   * React children\n   */\n  children?: React.ReactNode;\n}\n\nconst useStyles = makeStyles<BackstageTheme>(theme => ({\n  root: {\n    flexGrow: 0,\n    margin: theme.spacing(0, 2),\n    color: theme.palette.navigation.color,\n  },\n\n  selected: {\n    color: `${theme.palette.navigation.selectedColor}!important`,\n    borderTop: `solid ${sidebarConfig.selectedIndicatorWidth}px ${theme.palette.navigation.indicator}`,\n    marginTop: '-1px',\n  },\n\n  label: {\n    display: 'none',\n  },\n}));\n\n/**\n * Returns a MUI `BottomNavigationAction`, which is aware of the current location & the selected item in the `BottomNavigation`,\n * such that it will highlight a `MobileSidebarGroup` either on location change or if the selected item changes.\n *\n * @param props `to`: pathname of link; `value`: index of the selected item\n * @internal\n */\nconst MobileSidebarGroup = (props: SidebarGroupProps) => {\n  const { to, label, icon, value } = props;\n  const classes = useStyles();\n  const location = useLocation();\n  const { selectedMenuItemIndex, setSelectedMenuItemIndex } =\n    useContext(MobileSidebarContext);\n\n  const onChange = (_: React.ChangeEvent<{}>, value: number) => {\n    if (value === selectedMenuItemIndex) {\n      setSelectedMenuItemIndex(-1);\n    } else {\n      setSelectedMenuItemIndex(value);\n    }\n  };\n\n  const selected =\n    (value === selectedMenuItemIndex && selectedMenuItemIndex >= 0) ||\n    (!(value === selectedMenuItemIndex) &&\n      !(selectedMenuItemIndex >= 0) &&\n      to === location.pathname);\n\n  return (\n    // Material UI issue: https://github.com/mui-org/material-ui/issues/27820\n    <BottomNavigationAction\n      label={label}\n      icon={icon}\n      component={Link as any}\n      to={(to ? to : location.pathname) as any}\n      onChange={onChange}\n      value={value}\n      selected={selected}\n      classes={classes}\n    />\n  );\n};\n\n/**\n * Groups items of the `Sidebar` together.\n *\n * On bigger screens, this won't have any effect at the moment.\n * On small screens, it will add an action to the bottom navigation - either triggering an overlay menu or acting as a link\n *\n * @public\n */\nexport const SidebarGroup = (props: SidebarGroupProps) => {\n  const { children, to, label, icon, value } = props;\n  const { isMobile } = useContext(SidebarPinStateContext);\n\n  return isMobile ? (\n    <MobileSidebarGroup to={to} label={label} icon={icon} value={value} />\n  ) : (\n    <>{children}</>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useElementFilter } from '@backstage/core-plugin-api';\nimport { BackstageTheme } from '@backstage/theme';\nimport BottomNavigation from '@material-ui/core/BottomNavigation';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport { orderBy } from 'lodash';\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useLocation } from 'react-router';\nimport { SidebarContext } from '.';\nimport { sidebarConfig } from './config';\nimport { SidebarGroup } from './SidebarGroup';\n\n/**\n * Type of `MobileSidebarContext`\n *\n * @internal\n */\nexport type MobileSidebarContextType = {\n  selectedMenuItemIndex: number;\n  setSelectedMenuItemIndex: React.Dispatch<React.SetStateAction<number>>;\n};\n\n/**\n * Props of MobileSidebar\n *\n * @public\n */\nexport type MobileSidebarProps = {\n  children?: React.ReactNode;\n};\n\n/**\n * @internal\n */\ntype OverlayMenuProps = {\n  label?: string;\n  onClose: () => void;\n  open: boolean;\n  children?: React.ReactNode;\n};\n\nconst useStyles = makeStyles<BackstageTheme>(theme => ({\n  root: {\n    position: 'fixed',\n    backgroundColor: theme.palette.navigation.background,\n    color: theme.palette.navigation.color,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    zIndex: theme.zIndex.snackbar,\n    // SidebarDivider color\n    borderTop: '1px solid #383838',\n  },\n\n  overlay: {\n    background: theme.palette.navigation.background,\n    width: '100%',\n    bottom: `${sidebarConfig.mobileSidebarHeight}px`,\n    height: `calc(100% - ${sidebarConfig.mobileSidebarHeight}px)`,\n    flex: '0 1 auto',\n    overflow: 'auto',\n  },\n\n  overlayHeader: {\n    display: 'flex',\n    color: theme.palette.bursts.fontColor,\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: theme.spacing(2, 3),\n  },\n\n  overlayHeaderClose: {\n    color: theme.palette.bursts.fontColor,\n  },\n\n  marginMobileSidebar: {\n    marginBottom: `${sidebarConfig.mobileSidebarHeight}px`,\n  },\n}));\n\nconst sortSidebarGroupsForPriority = (children: React.ReactElement[]) =>\n  orderBy(\n    children,\n    ({ props: { priority } }) => (Number.isInteger(priority) ? priority : -1),\n    'desc',\n  );\n\nconst sidebarGroupType = React.createElement(SidebarGroup).type;\n\nconst OverlayMenu = ({\n  children,\n  label = 'Menu',\n  open,\n  onClose,\n}: OverlayMenuProps) => {\n  const classes = useStyles();\n\n  return (\n    <Drawer\n      anchor=\"bottom\"\n      open={open}\n      onClose={onClose}\n      ModalProps={{\n        BackdropProps: { classes: { root: classes.marginMobileSidebar } },\n      }}\n      classes={{\n        root: classes.marginMobileSidebar,\n        paperAnchorBottom: classes.overlay,\n      }}\n    >\n      <Box className={classes.overlayHeader}>\n        <Typography variant=\"h3\">{label}</Typography>\n        <IconButton\n          onClick={onClose}\n          classes={{ root: classes.overlayHeaderClose }}\n        >\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <Box>{children}</Box>\n    </Drawer>\n  );\n};\n\n/**\n * Context on which `SidebarGroup` is currently selected\n *\n * @internal\n */\nexport const MobileSidebarContext = createContext<MobileSidebarContextType>({\n  selectedMenuItemIndex: -1,\n  setSelectedMenuItemIndex: () => {},\n});\n\n/**\n * A navigation component for mobile screens, which sticks to the bottom.\n *\n * It alternates the normal sidebar by grouping the `SidebarItems` based on provided `SidebarGroup`s\n * either rendering them as a link or an overlay menu.\n * If no `SidebarGroup`s are provided the sidebar content is wrapped in an default overlay menu.\n *\n * @public\n */\nexport const MobileSidebar = (props: MobileSidebarProps) => {\n  const { children } = props;\n  const classes = useStyles();\n  const location = useLocation();\n  const [selectedMenuItemIndex, setSelectedMenuItemIndex] =\n    useState<number>(-1);\n\n  useEffect(() => {\n    setSelectedMenuItemIndex(-1);\n  }, [location.pathname]);\n\n  // Filter children for SidebarGroups\n  //\n  // Directly comparing child.type with SidebarSubmenu will not work with in\n  // combination with react-hot-loader\n  //\n  // https://github.com/gaearon/react-hot-loader/issues/304#issuecomment-456569720\n  let sidebarGroups = useElementFilter(children, elements =>\n    elements.getElements().filter(child => child.type === sidebarGroupType),\n  );\n\n  if (!children) {\n    // If Sidebar has no children the MobileSidebar won't be rendered\n    return null;\n  } else if (!sidebarGroups.length) {\n    // If Sidebar has no SidebarGroup as a children a default\n    // SidebarGroup with the complete Sidebar content will be created\n    sidebarGroups.push(\n      <SidebarGroup key=\"default_menu\" icon={<MenuIcon />}>\n        {children}\n      </SidebarGroup>,\n    );\n  } else {\n    // Sort SidebarGroups for the given Priority\n    sidebarGroups = sortSidebarGroupsForPriority(sidebarGroups);\n  }\n\n  const shouldShowGroupChildren =\n    selectedMenuItemIndex >= 0 &&\n    !sidebarGroups[selectedMenuItemIndex].props.to;\n\n  return (\n    <SidebarContext.Provider value={{ isOpen: true, setOpen: () => {} }}>\n      <MobileSidebarContext.Provider\n        value={{ selectedMenuItemIndex, setSelectedMenuItemIndex }}\n      >\n        <OverlayMenu\n          label={\n            sidebarGroups[selectedMenuItemIndex] &&\n            (sidebarGroups[selectedMenuItemIndex]!.props.label as string)\n          }\n          open={shouldShowGroupChildren}\n          onClose={() => setSelectedMenuItemIndex(-1)}\n        >\n          {sidebarGroups[selectedMenuItemIndex] &&\n            (sidebarGroups[selectedMenuItemIndex].props\n              .children as React.ReactChildren)}\n        </OverlayMenu>\n        <BottomNavigation\n          className={classes.root}\n          data-testid=\"mobile-sidebar-root\"\n        >\n          {sidebarGroups}\n        </BottomNavigation>\n      </MobileSidebarContext.Provider>\n    </SidebarContext.Provider>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport classnames from 'classnames';\n\nimport React, { useState, useContext, useRef } from 'react';\nimport Button from '@material-ui/core/Button';\n\nimport { sidebarConfig, SidebarContext } from './config';\nimport { BackstageTheme } from '@backstage/theme';\nimport { SidebarPinStateContext, useContent } from './Page';\nimport { MobileSidebar } from './MobileSidebar';\n\n/** @public */\nexport type SidebarClassKey = 'drawer' | 'drawerOpen';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    drawer: {\n      display: 'flex',\n      flexFlow: 'column nowrap',\n      alignItems: 'flex-start',\n      position: 'fixed',\n      left: 0,\n      top: 0,\n      bottom: 0,\n      zIndex: theme.zIndex.appBar,\n      background: theme.palette.navigation.background,\n      overflowX: 'hidden',\n      msOverflowStyle: 'none',\n      scrollbarWidth: 'none',\n      width: sidebarConfig.drawerWidthClosed,\n      transition: theme.transitions.create('width', {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.shortest,\n      }),\n      '& > *': {\n        flexShrink: 0,\n      },\n      '&::-webkit-scrollbar': {\n        display: 'none',\n      },\n    },\n    drawerOpen: {\n      width: sidebarConfig.drawerWidthOpen,\n      transition: theme.transitions.create('width', {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.shorter,\n      }),\n    },\n    visuallyHidden: {\n      top: 0,\n      position: 'absolute',\n      zIndex: 1000,\n      transform: 'translateY(-200%)',\n      '&:focus': {\n        transform: 'translateY(5px)',\n      },\n    },\n  }),\n  { name: 'BackstageSidebar' },\n);\n\nenum State {\n  Closed,\n  Idle,\n  Open,\n}\n\n/** @public */\nexport type SidebarProps = {\n  openDelayMs?: number;\n  closeDelayMs?: number;\n  disableExpandOnHover?: boolean;\n  children?: React.ReactNode;\n};\n\n/**\n * Places the Sidebar & wraps the children providing context weather the `Sidebar` is open or not.\n *\n * Handles & delays hover events for expanding the `Sidebar`\n *\n * @param props `disableExpandOnHover` disables the default hover behaviour;\n * `openDelayMs` & `closeDelayMs` set delay until sidebar will open/close on hover\n * @returns\n * @internal\n */\nconst DesktopSidebar = (props: SidebarProps) => {\n  const {\n    openDelayMs = sidebarConfig.defaultOpenDelayMs,\n    closeDelayMs = sidebarConfig.defaultCloseDelayMs,\n    disableExpandOnHover,\n    children,\n  } = props;\n  const classes = useStyles();\n  const isSmallScreen = useMediaQuery<BackstageTheme>(\n    theme => theme.breakpoints.down('md'),\n    { noSsr: true },\n  );\n  const [state, setState] = useState(State.Closed);\n  const hoverTimerRef = useRef<number>();\n  const { isPinned, toggleSidebarPinState } = useContext(\n    SidebarPinStateContext,\n  );\n\n  const handleOpen = () => {\n    if (isPinned || disableExpandOnHover) {\n      return;\n    }\n    if (hoverTimerRef.current) {\n      clearTimeout(hoverTimerRef.current);\n      hoverTimerRef.current = undefined;\n    }\n    if (state !== State.Open && !isSmallScreen) {\n      hoverTimerRef.current = window.setTimeout(() => {\n        hoverTimerRef.current = undefined;\n        setState(State.Open);\n      }, openDelayMs);\n\n      setState(State.Idle);\n    }\n  };\n\n  const handleClose = () => {\n    if (isPinned || disableExpandOnHover) {\n      return;\n    }\n    if (hoverTimerRef.current) {\n      clearTimeout(hoverTimerRef.current);\n      hoverTimerRef.current = undefined;\n    }\n    if (state === State.Idle) {\n      setState(State.Closed);\n    } else if (state === State.Open) {\n      hoverTimerRef.current = window.setTimeout(() => {\n        hoverTimerRef.current = undefined;\n        setState(State.Closed);\n      }, closeDelayMs);\n    }\n  };\n\n  const isOpen = (state === State.Open && !isSmallScreen) || isPinned;\n\n  /**\n   * Close/Open Sidebar directily without delays. Also toggles `SidebarPinState` to avoid hidden content behind Sidebar.\n   */\n  const setOpen = (open: boolean) => {\n    if (open) {\n      setState(State.Open);\n      toggleSidebarPinState();\n    } else {\n      setState(State.Closed);\n      toggleSidebarPinState();\n    }\n  };\n\n  return (\n    <div style={{}}>\n      <A11ySkipSidebar />\n      <SidebarContext.Provider\n        value={{\n          isOpen,\n          setOpen,\n        }}\n      >\n        <div\n          className={classes.root}\n          data-testid=\"sidebar-root\"\n          onMouseEnter={disableExpandOnHover ? () => {} : handleOpen}\n          onFocus={disableExpandOnHover ? () => {} : handleOpen}\n          onMouseLeave={disableExpandOnHover ? () => {} : handleClose}\n          onBlur={disableExpandOnHover ? () => {} : handleClose}\n        >\n          <div\n            className={classnames(classes.drawer, {\n              [classes.drawerOpen]: isOpen,\n            })}\n          >\n            {children}\n          </div>\n        </div>\n      </SidebarContext.Provider>\n    </div>\n  );\n};\n\n/**\n * Passing children into the desktop or mobile sidebar depending on the context\n *\n * @public\n */\nexport const Sidebar = (props: SidebarProps) => {\n  const { children, openDelayMs, closeDelayMs, disableExpandOnHover } = props;\n  const { isMobile } = useContext(SidebarPinStateContext);\n\n  return isMobile ? (\n    <MobileSidebar>{children}</MobileSidebar>\n  ) : (\n    <DesktopSidebar\n      openDelayMs={openDelayMs}\n      closeDelayMs={closeDelayMs}\n      disableExpandOnHover={disableExpandOnHover}\n    >\n      {children}\n    </DesktopSidebar>\n  );\n};\n\nfunction A11ySkipSidebar() {\n  const { focusContent, contentRef } = useContent();\n  const classes = useStyles();\n\n  if (!contentRef?.current) {\n    return null;\n  }\n  return (\n    <Button\n      onClick={focusContent}\n      variant=\"contained\"\n      className={classnames(classes.visuallyHidden)}\n    >\n      Skip to content\n    </Button>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Location, Path } from 'history';\nimport { isEqual, isMatch } from 'lodash';\nimport qs from 'qs';\n\nexport function isLocationMatch(currentLocation: Location, toLocation: Path) {\n  const toDecodedSearch = new URLSearchParams(toLocation.search).toString();\n  const toQueryParameters = qs.parse(toDecodedSearch);\n\n  const currentDecodedSearch = new URLSearchParams(\n    currentLocation.search,\n  ).toString();\n  const currentQueryParameters = qs.parse(currentDecodedSearch);\n\n  const matching =\n    isEqual(toLocation.pathname, currentLocation.pathname) &&\n    isMatch(currentQueryParameters, toQueryParameters);\n\n  return matching;\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useContext, useState } from 'react';\nimport { resolvePath, useLocation, useResolvedPath } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from '../../components/Link';\nimport { IconComponent } from '@backstage/core-plugin-api';\nimport classnames from 'classnames';\nimport { BackstageTheme } from '@backstage/theme';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\nimport { SidebarItemWithSubmenuContext } from './config';\nimport { isLocationMatch } from './utils';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    item: {\n      height: 48,\n      width: '100%',\n      '&:hover': {\n        background: '#6f6f6f',\n        color: theme.palette.navigation.selectedColor,\n      },\n      display: 'flex',\n      alignItems: 'center',\n      color: theme.palette.navigation.color,\n      padding: 20,\n      cursor: 'pointer',\n      position: 'relative',\n      background: 'none',\n      border: 'none',\n    },\n    itemContainer: {\n      width: '100%',\n    },\n    selected: {\n      background: '#6f6f6f',\n      color: '#FFF',\n    },\n    label: {\n      margin: 14,\n      marginLeft: 7,\n      fontSize: 14,\n    },\n    dropdownArrow: {\n      position: 'absolute',\n      right: 21,\n    },\n    dropdown: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'end',\n    },\n    dropdownItem: {\n      width: '100%',\n      padding: '10px 0 10px 0',\n    },\n    textContent: {\n      color: theme.palette.navigation.color,\n      display: 'flex',\n      justifyContent: 'center',\n      [theme.breakpoints.down('xs')]: {\n        display: 'block',\n        paddingLeft: theme.spacing(4),\n      },\n      fontSize: '14px',\n    },\n  }),\n  { name: 'BackstageSidebarSubmenuItem' },\n);\n\n/**\n * Clickable item displayed when submenu item is clicked.\n * title: Text content of item\n * to: Path to navigate to when item is clicked\n *\n * @public\n */\nexport type SidebarSubmenuItemDropdownItem = {\n  title: string;\n  to: string;\n};\n/**\n * Holds submenu item content.\n *\n * title: Text content of submenu item\n * to: Path to navigate to when item is clicked\n * icon: Icon displayed on the left of text content\n * dropdownItems: Optional array of dropdown items displayed when submenu item is clicked.\n *\n * @public\n */\nexport type SidebarSubmenuItemProps = {\n  title: string;\n  to: string;\n  icon: IconComponent;\n  dropdownItems?: SidebarSubmenuItemDropdownItem[];\n};\n\n/**\n * Item used inside a submenu within the sidebar.\n *\n * @public\n */\nexport const SidebarSubmenuItem = (props: SidebarSubmenuItemProps) => {\n  const { title, to, icon: Icon, dropdownItems } = props;\n  const classes = useStyles();\n  const { setIsHoveredOn } = useContext(SidebarItemWithSubmenuContext);\n  const closeSubmenu = () => {\n    setIsHoveredOn(false);\n  };\n  const toLocation = useResolvedPath(to);\n  const currentLocation = useLocation();\n  let isActive = isLocationMatch(currentLocation, toLocation);\n\n  const [showDropDown, setShowDropDown] = useState(false);\n  const handleClickDropdown = () => {\n    setShowDropDown(!showDropDown);\n  };\n  if (dropdownItems !== undefined) {\n    dropdownItems.some(item => {\n      const resolvedPath = resolvePath(item.to);\n      isActive = isLocationMatch(currentLocation, resolvedPath);\n      return isActive;\n    });\n    return (\n      <div className={classes.itemContainer}>\n        <button\n          onClick={handleClickDropdown}\n          onTouchStart={e => e.stopPropagation()}\n          className={classnames(\n            classes.item,\n            isActive ? classes.selected : undefined,\n          )}\n        >\n          <Icon fontSize=\"small\" />\n          <Typography variant=\"subtitle1\" className={classes.label}>\n            {title}\n          </Typography>\n          {showDropDown ? (\n            <ArrowDropUpIcon className={classes.dropdownArrow} />\n          ) : (\n            <ArrowDropDownIcon className={classes.dropdownArrow} />\n          )}\n        </button>\n        {dropdownItems && showDropDown && (\n          <div className={classes.dropdown}>\n            {dropdownItems.map((object, key) => (\n              <Link\n                to={object.to}\n                underline=\"none\"\n                className={classes.dropdownItem}\n                onClick={closeSubmenu}\n                onTouchStart={e => e.stopPropagation()}\n                key={key}\n              >\n                <Typography className={classes.textContent}>\n                  {object.title}\n                </Typography>\n              </Link>\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className={classes.itemContainer}>\n      <Link\n        to={to}\n        underline=\"none\"\n        className={classnames(\n          classes.item,\n          isActive ? classes.selected : undefined,\n        )}\n        onClick={closeSubmenu}\n        onTouchStart={e => e.stopPropagation()}\n      >\n        <Icon fontSize=\"small\" />\n        <Typography variant=\"subtitle1\" className={classes.label}>\n          {title}\n        </Typography>\n      </Link>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport classnames from 'classnames';\nimport React, { ReactNode, useContext, useEffect, useState } from 'react';\nimport {\n  SidebarItemWithSubmenuContext,\n  sidebarConfig,\n  SidebarContext,\n  submenuConfig,\n} from './config';\nimport { BackstageTheme } from '@backstage/theme';\n\nconst useStyles = (props: { left: number }) =>\n  makeStyles<BackstageTheme>(\n    theme => ({\n      root: {\n        zIndex: 1000,\n        position: 'relative',\n        overflow: 'visible',\n        width: theme.spacing(7) + 1,\n      },\n      drawer: {\n        display: 'flex',\n        flexFlow: 'column nowrap',\n        alignItems: 'flex-start',\n        position: 'fixed',\n        [theme.breakpoints.up('sm')]: {\n          marginLeft: props.left,\n          transition: theme.transitions.create('margin-left', {\n            easing: theme.transitions.easing.sharp,\n            duration: theme.transitions.duration.shortest,\n          }),\n        },\n        top: 0,\n        bottom: 0,\n        padding: 0,\n        background: theme.palette.navigation.submenu?.background ?? '#404040',\n        overflowX: 'hidden',\n        msOverflowStyle: 'none',\n        scrollbarWidth: 'none',\n        cursor: 'default',\n        width: submenuConfig.drawerWidthClosed,\n        transitionDelay: `${submenuConfig.defaultOpenDelayMs}ms`,\n        '& > *': {\n          flexShrink: 0,\n        },\n        '&::-webkit-scrollbar': {\n          display: 'none',\n        },\n      },\n      drawerOpen: {\n        width: submenuConfig.drawerWidthOpen,\n        [theme.breakpoints.down('xs')]: {\n          width: '100%',\n          position: 'relative',\n          paddingLeft: theme.spacing(3),\n          left: 0,\n          top: 0,\n        },\n      },\n      title: {\n        fontSize: 24,\n        fontWeight: 500,\n        color: '#FFF',\n        padding: 20,\n        [theme.breakpoints.down('xs')]: {\n          display: 'none',\n        },\n      },\n    }),\n    { name: 'BackstageSidebarSubmenu' },\n  );\n\n/**\n * Holds a title for text Header of a sidebar submenu and children\n * components to be rendered inside SidebarSubmenu\n *\n * @public\n */\nexport type SidebarSubmenuProps = {\n  title?: string;\n  children: ReactNode;\n};\n\n/**\n * Used inside SidebarItem to display an expandable Submenu\n *\n * @public\n */\nexport const SidebarSubmenu = (props: SidebarSubmenuProps) => {\n  const { isOpen } = useContext(SidebarContext);\n  const left = isOpen\n    ? sidebarConfig.drawerWidthOpen\n    : sidebarConfig.drawerWidthClosed;\n  const classes = useStyles({ left })();\n\n  const { isHoveredOn } = useContext(SidebarItemWithSubmenuContext);\n  const [isSubmenuOpen, setIsSubmenuOpen] = useState(false);\n\n  useEffect(() => {\n    setIsSubmenuOpen(isHoveredOn);\n  }, [isHoveredOn]);\n\n  return (\n    <div\n      className={classnames(classes.drawer, {\n        [classes.drawerOpen]: isSubmenuOpen,\n      })}\n    >\n      <Typography variant=\"h5\" className={classes.title}>\n        {props.title}\n      </Typography>\n      {props.children}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\n\nconst useStyles = makeStyles({\n  iconContainer: {\n    display: 'flex',\n    position: 'relative',\n    width: '100%',\n  },\n  arrow1: {\n    right: '6px',\n    position: 'absolute',\n  },\n});\n\nconst DoubleArrowLeft = () => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.iconContainer}>\n      <div className={classes.arrow1}>\n        <ArrowBackIosIcon style={{ fontSize: '12px' }} />\n      </div>\n      <div>\n        <ArrowBackIosIcon style={{ fontSize: '12px' }} />\n      </div>\n    </div>\n  );\n};\n\nexport default DoubleArrowLeft;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ArrowForwardIosIcon from '@material-ui/icons/ArrowForwardIos';\n\nconst useStyles = makeStyles({\n  iconContainer: {\n    display: 'flex',\n    position: 'relative',\n    width: '100%',\n  },\n  arrow1: {\n    right: '6px',\n    position: 'absolute',\n  },\n});\n\nconst DoubleArrowRight = () => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.iconContainer}>\n      <div className={classes.arrow1}>\n        <ArrowForwardIosIcon style={{ fontSize: '12px' }} />\n      </div>\n      <div>\n        <ArrowForwardIosIcon style={{ fontSize: '12px' }} />\n      </div>\n    </div>\n  );\n};\n\nexport default DoubleArrowRight;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconComponent, useElementFilter } from '@backstage/core-plugin-api';\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles, styled, Theme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport Badge from '@material-ui/core/Badge';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport {\n  CreateCSSProperties,\n  StyledComponentProps,\n} from '@material-ui/core/styles/withStyles';\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\nimport SearchIcon from '@material-ui/icons/Search';\nimport ArrowDropUp from '@material-ui/icons/ArrowDropUp';\nimport ArrowDropDown from '@material-ui/icons/ArrowDropDown';\nimport classnames from 'classnames';\nimport React, {\n  ComponentProps,\n  ComponentType,\n  forwardRef,\n  KeyboardEventHandler,\n  ReactNode,\n  useContext,\n  useState,\n} from 'react';\nimport {\n  Link,\n  NavLinkProps,\n  resolvePath,\n  useLocation,\n  useResolvedPath,\n} from 'react-router-dom';\nimport {\n  sidebarConfig,\n  SidebarContext,\n  SidebarItemWithSubmenuContext,\n} from './config';\nimport {\n  SidebarSubmenuItemProps,\n  SidebarSubmenuProps,\n  SidebarSubmenu,\n} from '.';\nimport DoubleArrowLeft from './icons/DoubleArrowLeft';\nimport DoubleArrowRight from './icons/DoubleArrowRight';\nimport { isLocationMatch } from './utils';\nimport { Location } from 'history';\n\n/** @public */\nexport type SidebarItemClassKey =\n  | 'root'\n  | 'buttonItem'\n  | 'closed'\n  | 'open'\n  | 'highlightable'\n  | 'highlighted'\n  | 'label'\n  | 'iconContainer'\n  | 'searchRoot'\n  | 'searchField'\n  | 'searchFieldHTMLInput'\n  | 'searchContainer'\n  | 'secondaryAction'\n  | 'closedItemIcon'\n  | 'submenuArrow'\n  | 'expandButton'\n  | 'arrows'\n  | 'selected';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => {\n    const {\n      selectedIndicatorWidth,\n      drawerWidthClosed,\n      drawerWidthOpen,\n      iconContainerWidth,\n    } = sidebarConfig;\n    return {\n      root: {\n        color: theme.palette.navigation.color,\n        display: 'flex',\n        flexFlow: 'row nowrap',\n        alignItems: 'center',\n        height: 48,\n        cursor: 'pointer',\n      },\n      buttonItem: {\n        background: 'none',\n        border: 'none',\n        width: '100%',\n        margin: 0,\n        padding: 0,\n        textAlign: 'inherit',\n        font: 'inherit',\n      },\n      closed: {\n        width: drawerWidthClosed,\n        justifyContent: 'center',\n      },\n      open: {\n        [theme.breakpoints.up('sm')]: {\n          width: drawerWidthOpen,\n        },\n      },\n      highlightable: {\n        '&:hover': {\n          background:\n            theme.palette.navigation.navItem?.hoverBackground ?? '#404040',\n        },\n      },\n      highlighted: {\n        background:\n          theme.palette.navigation.navItem?.hoverBackground ?? '#404040',\n      },\n      label: {\n        // XXX (@koroeskohr): I can't seem to achieve the desired font-weight from the designs\n        fontWeight: 'bold',\n        whiteSpace: 'nowrap',\n        lineHeight: 'auto',\n        flex: '3 1 auto',\n        width: '110px',\n        overflow: 'hidden',\n        'text-overflow': 'ellipsis',\n      },\n      iconContainer: {\n        boxSizing: 'border-box',\n        height: '100%',\n        width: iconContainerWidth,\n        marginRight: -theme.spacing(2),\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n      },\n      searchRoot: {\n        marginBottom: 12,\n      },\n      searchField: {\n        color: '#b5b5b5',\n        fontWeight: 'bold',\n        fontSize: theme.typography.fontSize,\n      },\n      searchFieldHTMLInput: {\n        padding: theme.spacing(2, 0, 2),\n      },\n      searchContainer: {\n        width: drawerWidthOpen - iconContainerWidth,\n      },\n      secondaryAction: {\n        width: theme.spacing(6),\n        textAlign: 'center',\n        marginRight: theme.spacing(1),\n      },\n      closedItemIcon: {\n        width: '100%',\n        justifyContent: 'center',\n      },\n      submenuArrow: {\n        display: 'flex',\n      },\n      expandButton: {\n        background: 'none',\n        border: 'none',\n        color: theme.palette.navigation.color,\n        width: '100%',\n        cursor: 'pointer',\n        position: 'relative',\n        height: 48,\n      },\n      arrows: {\n        position: 'absolute',\n        right: 10,\n      },\n      selected: {\n        '&$root': {\n          borderLeft: `solid ${selectedIndicatorWidth}px ${theme.palette.navigation.indicator}`,\n          color: theme.palette.navigation.selectedColor,\n        },\n        '&$closed': {\n          width: drawerWidthClosed,\n        },\n        '& $closedItemIcon': {\n          paddingRight: selectedIndicatorWidth,\n        },\n        '& $iconContainer': {\n          marginLeft: -selectedIndicatorWidth,\n        },\n      },\n    };\n  },\n  { name: 'BackstageSidebarItem' },\n);\n\n/**\n * Evaluates the routes of the SubmenuItems & nested DropdownItems.\n * The reeveluation is only triggered, if the `locationPathname` changes, as `useElementFilter` uses memorization.\n *\n * @param submenu SidebarSubmenu component\n * @param location Location\n * @returns boolean\n */\nconst useLocationMatch = (\n  submenu: React.ReactElement<SidebarSubmenuProps>,\n  location: Location,\n): boolean =>\n  useElementFilter(\n    submenu.props.children,\n    elements => {\n      let active = false;\n      elements\n        .getElements()\n        .forEach(\n          ({\n            props: { to, dropdownItems },\n          }: {\n            props: Partial<SidebarSubmenuItemProps>;\n          }) => {\n            if (!active) {\n              if (dropdownItems?.length) {\n                dropdownItems.forEach(\n                  ({ to: _to }) =>\n                    (active =\n                      active || isLocationMatch(location, resolvePath(_to))),\n                );\n                return;\n              }\n              if (to) {\n                active = isLocationMatch(location, resolvePath(to));\n              }\n            }\n          },\n        );\n      return active;\n    },\n    [location.pathname],\n  );\n\ntype SidebarItemBaseProps = {\n  icon: IconComponent;\n  text?: string;\n  hasNotifications?: boolean;\n  disableHighlight?: boolean;\n  className?: string;\n};\n\ntype SidebarItemButtonProps = SidebarItemBaseProps & {\n  onClick: (ev: React.MouseEvent) => void;\n  children?: ReactNode;\n};\n\ntype SidebarItemLinkProps = SidebarItemBaseProps & {\n  to: string;\n  onClick?: (ev: React.MouseEvent) => void;\n} & NavLinkProps;\n\ntype SidebarItemWithSubmenuProps = SidebarItemBaseProps & {\n  to?: string;\n  onClick?: (ev: React.MouseEvent) => void;\n  children: ReactNode;\n};\n\n/**\n * SidebarItem with 'to' property will be a clickable link.\n * SidebarItem with 'onClick' property and without 'to' property will be a clickable button.\n * SidebarItem which wraps a SidebarSubmenu will be a clickable button which opens a submenu.\n */\ntype SidebarItemProps =\n  | SidebarItemLinkProps\n  | SidebarItemButtonProps\n  | SidebarItemWithSubmenuProps;\n\nfunction isButtonItem(\n  props: SidebarItemProps,\n): props is SidebarItemButtonProps {\n  return (props as SidebarItemLinkProps).to === undefined;\n}\n\nconst sidebarSubmenuType = React.createElement(SidebarSubmenu).type;\n\n// TODO(Rugvip): Remove this once NavLink is updated in react-router-dom.\n//               This is needed because react-router doesn't handle the path comparison\n//               properly yet, matching for example /foobar with /foo.\nexport const WorkaroundNavLink = React.forwardRef<\n  HTMLAnchorElement,\n  NavLinkProps\n>(function WorkaroundNavLinkWithRef(\n  {\n    to,\n    end,\n    style,\n    className,\n    activeStyle,\n    caseSensitive,\n    activeClassName = 'active',\n    'aria-current': ariaCurrentProp = 'page',\n    ...rest\n  },\n  ref,\n) {\n  let { pathname: locationPathname } = useLocation();\n  let { pathname: toPathname } = useResolvedPath(to);\n\n  if (!caseSensitive) {\n    locationPathname = locationPathname.toLocaleLowerCase('en-US');\n    toPathname = toPathname.toLocaleLowerCase('en-US');\n  }\n\n  let isActive = locationPathname === toPathname;\n  if (!isActive && !end) {\n    // This is the behavior that is different from the original NavLink\n    isActive = locationPathname.startsWith(`${toPathname}/`);\n  }\n\n  const ariaCurrent = isActive ? ariaCurrentProp : undefined;\n\n  return (\n    <Link\n      {...rest}\n      to={to}\n      ref={ref}\n      aria-current={ariaCurrent}\n      style={{ ...style, ...(isActive ? activeStyle : undefined) }}\n      className={classnames([\n        className,\n        isActive ? activeClassName : undefined,\n      ])}\n    />\n  );\n});\n\n/**\n * Common component used by SidebarItem & SidebarItemWithSubmenu\n */\nconst SidebarItemBase = forwardRef<any, SidebarItemProps>((props, ref) => {\n  const {\n    icon: Icon,\n    text,\n    hasNotifications = false,\n    disableHighlight = false,\n    onClick,\n    children,\n    className,\n    ...navLinkProps\n  } = props;\n  const classes = useStyles();\n  // XXX (@koroeskohr): unsure this is optimal. But I just really didn't want to have the item component\n  // depend on the current location, and at least have it being optionally forced to selected.\n  // Still waiting on a Q answered to fine tune the implementation\n  const { isOpen } = useContext(SidebarContext);\n\n  const itemIcon = (\n    <Badge\n      color=\"secondary\"\n      variant=\"dot\"\n      overlap=\"circular\"\n      invisible={!hasNotifications}\n      className={classnames({ [classes.closedItemIcon]: !isOpen })}\n    >\n      <Icon fontSize=\"small\" />\n    </Badge>\n  );\n\n  const openContent = (\n    <>\n      <div data-testid=\"login-button\" className={classes.iconContainer}>\n        {itemIcon}\n      </div>\n      {text && (\n        <Typography variant=\"subtitle2\" className={classes.label}>\n          {text}\n        </Typography>\n      )}\n      <div className={classes.secondaryAction}>{children}</div>\n    </>\n  );\n\n  const content = isOpen ? openContent : itemIcon;\n\n  const childProps = {\n    onClick,\n    className: classnames(\n      className,\n      classes.root,\n      isOpen ? classes.open : classes.closed,\n      isButtonItem(props) && classes.buttonItem,\n      { [classes.highlightable]: !disableHighlight },\n    ),\n  };\n\n  if (isButtonItem(props)) {\n    return (\n      <button aria-label={text} {...childProps} ref={ref}>\n        {content}\n      </button>\n    );\n  }\n\n  return (\n    <WorkaroundNavLink\n      {...childProps}\n      activeClassName={classes.selected}\n      to={props.to ? props.to : ''}\n      ref={ref}\n      aria-label={text ? text : props.to}\n      {...navLinkProps}\n    >\n      {content}\n    </WorkaroundNavLink>\n  );\n});\n\nconst SidebarItemWithSubmenu = ({\n  children,\n  ...props\n}: SidebarItemBaseProps & {\n  children: React.ReactElement<SidebarSubmenuProps>;\n}) => {\n  const classes = useStyles();\n  const [isHoveredOn, setIsHoveredOn] = useState(false);\n  const location = useLocation();\n  const isActive = useLocationMatch(children, location);\n  const isSmallScreen = useMediaQuery<BackstageTheme>((theme: BackstageTheme) =>\n    theme.breakpoints.down('sm'),\n  );\n\n  const handleMouseEnter = () => {\n    setIsHoveredOn(true);\n  };\n  const handleMouseLeave = () => {\n    setIsHoveredOn(false);\n  };\n\n  const arrowIcon = () => {\n    if (isSmallScreen) {\n      return isHoveredOn ? (\n        <ArrowDropUp fontSize=\"small\" className={classes.submenuArrow} />\n      ) : (\n        <ArrowDropDown fontSize=\"small\" className={classes.submenuArrow} />\n      );\n    }\n    return (\n      !isHoveredOn && (\n        <ArrowRightIcon fontSize=\"small\" className={classes.submenuArrow} />\n      )\n    );\n  };\n\n  return (\n    <SidebarItemWithSubmenuContext.Provider\n      value={{\n        isHoveredOn,\n        setIsHoveredOn,\n      }}\n    >\n      <div\n        data-testid=\"item-with-submenu\"\n        onMouseLeave={handleMouseLeave}\n        onTouchStart={isHoveredOn ? handleMouseLeave : handleMouseEnter}\n        onMouseEnter={handleMouseEnter}\n        className={classnames(isHoveredOn && classes.highlighted)}\n      >\n        <SidebarItemBase\n          className={isActive ? classes.selected : ''}\n          {...props}\n        >\n          {arrowIcon()}\n        </SidebarItemBase>\n        {isHoveredOn && children}\n      </div>\n    </SidebarItemWithSubmenuContext.Provider>\n  );\n};\n\n/**\n * Creates a `SidebarItem`\n *\n * If children contain a `SidebarSubmenu` component the `SidebarItem` will have a expandable submenu\n */\nexport const SidebarItem = forwardRef<any, SidebarItemProps>((props, ref) => {\n  // Filter children for SidebarSubmenu components\n  const [submenu] = useElementFilter(props.children, elements =>\n    // Directly comparing child.type with SidebarSubmenu will not work with in\n    // combination with react-hot-loader\n    //\n    // https://github.com/gaearon/react-hot-loader/issues/304#issuecomment-456569720\n    elements.getElements().filter(child => child.type === sidebarSubmenuType),\n  );\n\n  if (submenu) {\n    return (\n      <SidebarItemWithSubmenu {...props}>\n        {submenu as React.ReactElement<SidebarSubmenuProps>}\n      </SidebarItemWithSubmenu>\n    );\n  }\n\n  return <SidebarItemBase {...props} ref={ref} />;\n}) as (props: SidebarItemProps) => JSX.Element;\n\ntype SidebarSearchFieldProps = {\n  onSearch: (input: string) => void;\n  to?: string;\n  icon?: IconComponent;\n};\n\nexport function SidebarSearchField(props: SidebarSearchFieldProps) {\n  const [input, setInput] = useState('');\n  const classes = useStyles();\n  const Icon = props.icon ? props.icon : SearchIcon;\n\n  const search = () => {\n    props.onSearch(input);\n    setInput('');\n  };\n\n  const handleEnter: KeyboardEventHandler = ev => {\n    if (ev.key === 'Enter') {\n      ev.preventDefault();\n      search();\n    }\n  };\n\n  const handleInput = (ev: React.ChangeEvent<HTMLInputElement>) => {\n    setInput(ev.target.value);\n  };\n\n  const handleInputClick = (ev: React.MouseEvent<HTMLInputElement>) => {\n    // Clicking into the search fields shouldn't navigate to the search page\n    ev.preventDefault();\n    ev.stopPropagation();\n  };\n\n  const handleItemClick = (ev: React.MouseEvent) => {\n    // Clicking on the search icon while should execute a query with the current field content\n    search();\n    ev.preventDefault();\n  };\n\n  return (\n    <div className={classes.searchRoot}>\n      <SidebarItem\n        icon={Icon}\n        to={props.to}\n        onClick={handleItemClick}\n        disableHighlight\n      >\n        <TextField\n          placeholder=\"Search\"\n          value={input}\n          onClick={handleInputClick}\n          onChange={handleInput}\n          onKeyDown={handleEnter}\n          className={classes.searchContainer}\n          InputProps={{\n            disableUnderline: true,\n            className: classes.searchField,\n          }}\n          inputProps={{\n            className: classes.searchFieldHTMLInput,\n          }}\n        />\n      </SidebarItem>\n    </div>\n  );\n}\n\nexport type SidebarSpaceClassKey = 'root';\n\nexport const SidebarSpace = styled('div')(\n  {\n    flex: 1,\n  },\n  { name: 'BackstageSidebarSpace' },\n) as ComponentType<ComponentProps<'div'> & StyledComponentProps<'root'>>;\n\nexport type SidebarSpacerClassKey = 'root';\n\nexport const SidebarSpacer = styled('div')(\n  {\n    height: 8,\n  },\n  { name: 'BackstageSidebarSpacer' },\n) as ComponentType<ComponentProps<'div'> & StyledComponentProps<'root'>>;\n\nexport type SidebarDividerClassKey = 'root';\n\nexport const SidebarDivider = styled('hr')(\n  {\n    height: 1,\n    width: '100%',\n    background: '#383838',\n    border: 'none',\n    margin: '12px 0px',\n  },\n  { name: 'BackstageSidebarDivider' },\n) as ComponentType<ComponentProps<'hr'> & StyledComponentProps<'root'>>;\n\nconst styledScrollbar = (theme: Theme): CreateCSSProperties => ({\n  overflowY: 'auto',\n  '&::-webkit-scrollbar': {\n    backgroundColor: theme.palette.background.default,\n    width: '5px',\n    borderRadius: '5px',\n  },\n  '&::-webkit-scrollbar-thumb': {\n    backgroundColor: theme.palette.text.hint,\n    borderRadius: '5px',\n  },\n});\n\nexport const SidebarScrollWrapper = styled('div')(({ theme }) => {\n  const scrollbarStyles = styledScrollbar(theme);\n  return {\n    flex: '0 1 auto',\n    overflowX: 'hidden',\n    // 5px space to the right of the scrollbar\n    width: 'calc(100% - 5px)',\n    // Display at least one item in the container\n    // Question: Can this be a config/theme variable - if so, which? :/\n    minHeight: '48px',\n    overflowY: 'hidden',\n    '@media (hover: none)': scrollbarStyles,\n    '&:hover': scrollbarStyles,\n  };\n}) as ComponentType<ComponentProps<'div'> & StyledComponentProps<'root'>>;\n\n/**\n * A button which allows you to expand the sidebar when clicked.\n * Use optionally to replace sidebar's expand-on-hover feature with expand-on-click.\n *\n * If you are using this you might want to set the `disableExpandOnHover` of the `Sidebar` to `true`.\n *\n * @public\n */\nexport const SidebarExpandButton = () => {\n  const classes = useStyles();\n  const { isOpen, setOpen } = useContext(SidebarContext);\n  const isSmallScreen = useMediaQuery<BackstageTheme>(\n    theme => theme.breakpoints.down('md'),\n    { noSsr: true },\n  );\n\n  if (isSmallScreen) {\n    return null;\n  }\n\n  const handleClick = () => {\n    setOpen(!isOpen);\n  };\n\n  return (\n    <button\n      onClick={handleClick}\n      className={classes.expandButton}\n      aria-label=\"Expand Sidebar\"\n      data-testid=\"sidebar-expand-button\"\n    >\n      <div className={classes.arrows}>\n        {isOpen ? <DoubleArrowLeft /> : <DoubleArrowRight />}\n      </div>\n    </button>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport Collapse from '@material-ui/core/Collapse';\nimport Link from '@material-ui/core/Link';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport React, { useContext, useState } from 'react';\nimport { useLocalStorageValue } from '@react-hookz/web';\nimport {\n  sidebarConfig,\n  SidebarContext,\n  SIDEBAR_INTRO_LOCAL_STORAGE,\n} from './config';\nimport { SidebarDivider } from './Items';\n\n/** @public */\nexport type SidebarIntroClassKey =\n  | 'introCard'\n  | 'introDismiss'\n  | 'introDismissLink'\n  | 'introDismissText'\n  | 'introDismissIcon';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    introCard: {\n      color: '#b5b5b5',\n      // XXX (@koroeskohr): should I be using a Mui theme variable?\n      fontSize: 12,\n      width: sidebarConfig.drawerWidthOpen,\n      marginTop: 18,\n      marginBottom: 12,\n      paddingLeft: sidebarConfig.iconPadding,\n      paddingRight: sidebarConfig.iconPadding,\n    },\n    introDismiss: {\n      display: 'flex',\n      justifyContent: 'flex-end',\n      alignItems: 'center',\n      marginTop: 12,\n    },\n    introDismissLink: {\n      color: '#dddddd',\n      display: 'flex',\n      alignItems: 'center',\n      marginBottom: 4,\n      '&:hover': {\n        color: theme.palette.linkHover,\n        transition: theme.transitions.create('color', {\n          easing: theme.transitions.easing.sharp,\n          duration: theme.transitions.duration.shortest,\n        }),\n      },\n    },\n    introDismissText: {\n      fontSize: '0.7rem',\n      fontWeight: 'bold',\n      textTransform: 'uppercase',\n      letterSpacing: 1,\n    },\n    introDismissIcon: {\n      width: 18,\n      height: 18,\n      marginRight: 12,\n    },\n  }),\n  { name: 'BackstageSidebarIntro' },\n);\n\ntype IntroCardProps = {\n  text: string;\n  onClose: () => void;\n};\n\n/**\n * Closable card with information from Navigation Sidebar\n *\n * @public\n *\n */\n\nexport function IntroCard(props: IntroCardProps) {\n  const classes = useStyles();\n  const { text, onClose } = props;\n  const handleClose = () => onClose();\n\n  return (\n    <div className={classes.introCard}>\n      <Typography variant=\"subtitle2\">{text}</Typography>\n      <div className={classes.introDismiss}>\n        <Link\n          component=\"button\"\n          onClick={handleClose}\n          underline=\"none\"\n          className={classes.introDismissLink}\n        >\n          <CloseIcon className={classes.introDismissIcon} />\n          <Typography component=\"span\" className={classes.introDismissText}>\n            Dismiss\n          </Typography>\n        </Link>\n      </div>\n    </div>\n  );\n}\n\ntype SidebarIntroLocalStorage = {\n  starredItemsDismissed: boolean;\n  recentlyViewedItemsDismissed: boolean;\n};\n\ntype SidebarIntroCardProps = {\n  text: string;\n  onDismiss: () => void;\n};\n\nconst SidebarIntroCard = (props: SidebarIntroCardProps) => {\n  const { text, onDismiss } = props;\n  const [collapsing, setCollapsing] = useState(false);\n  const startDismissing = () => {\n    setCollapsing(true);\n  };\n  return (\n    <Collapse in={!collapsing} onExited={onDismiss}>\n      <IntroCard text={text} onClose={startDismissing} />\n    </Collapse>\n  );\n};\n\nconst starredIntroText = `Fun fact! As you explore all the awesome plugins in Backstage, you can actually pin them to this side nav.\nKeep an eye out for the little star icon () next to the plugin name and give it a click!`;\nconst recentlyViewedIntroText =\n  'And your recently viewed plugins will pop up here!';\n\nexport function SidebarIntro(_props: {}) {\n  const { isOpen } = useContext(SidebarContext);\n  const defaultValue = {\n    starredItemsDismissed: false,\n    recentlyViewedItemsDismissed: false,\n  };\n  const [dismissedIntro, setDismissedIntro] =\n    useLocalStorageValue<SidebarIntroLocalStorage>(SIDEBAR_INTRO_LOCAL_STORAGE);\n\n  const { starredItemsDismissed, recentlyViewedItemsDismissed } =\n    dismissedIntro ?? {};\n\n  const dismissStarred = () => {\n    setDismissedIntro(state => ({\n      ...defaultValue,\n      ...state,\n      starredItemsDismissed: true,\n    }));\n  };\n  const dismissRecentlyViewed = () => {\n    setDismissedIntro(state => ({\n      ...defaultValue,\n      ...state,\n      recentlyViewedItemsDismissed: true,\n    }));\n  };\n\n  if (!isOpen) {\n    return null;\n  }\n\n  return (\n    <>\n      {!starredItemsDismissed && (\n        <>\n          <SidebarIntroCard\n            text={starredIntroText}\n            onDismiss={dismissStarred}\n          />\n          <SidebarDivider />\n        </>\n      )}\n      {!recentlyViewedItemsDismissed && (\n        <SidebarIntroCard\n          text={recentlyViewedIntroText}\n          onDismiss={dismissRecentlyViewed}\n        />\n      )}\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport classNames from 'classnames';\nimport React, { PropsWithChildren } from 'react';\nimport { useContent } from '../Sidebar';\n\n/** @public */\nexport type BackstageContentClassKey = 'root' | 'stretch' | 'noPadding';\n\nconst useStyles = makeStyles(\n  (theme: Theme) => ({\n    root: {\n      gridArea: 'pageContent',\n      minWidth: 0,\n      paddingTop: theme.spacing(3),\n      paddingBottom: theme.spacing(3),\n      paddingLeft: theme.spacing(2),\n      paddingRight: theme.spacing(2),\n      [theme.breakpoints.up('sm')]: {\n        paddingLeft: theme.spacing(3),\n        paddingRight: theme.spacing(3),\n      },\n    },\n    stretch: {\n      display: 'flex',\n      flexDirection: 'column',\n      flexGrow: 1,\n    },\n    noPadding: {\n      padding: 0,\n    },\n  }),\n  { name: 'BackstageContent' },\n);\n\ntype Props = {\n  stretch?: boolean;\n  noPadding?: boolean;\n  className?: string;\n};\n\n/**\n * The main content part inside a {@link Page}.\n *\n * @public\n *\n */\n\nexport function Content(props: PropsWithChildren<Props>) {\n  const { className, stretch, noPadding, children, ...restProps } = props;\n\n  const { contentRef } = useContent();\n\n  const classes = useStyles();\n  return (\n    <article\n      ref={contentRef}\n      tabIndex={-1}\n      {...restProps}\n      className={classNames(classes.root, className, {\n        [classes.stretch]: stretch,\n        [classes.noPadding]: noPadding,\n      })}\n    >\n      {children}\n    </article>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// TODO(blam): Remove this implementation when the Tabs are ready\n// This is just a temporary solution to implementing tabs for now\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport TabUI, { TabProps } from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport React, { useEffect, useState } from 'react';\n\n/** @public */\nexport type HeaderTabsClassKey =\n  | 'tabsWrapper'\n  | 'defaultTab'\n  | 'selected'\n  | 'tabRoot';\n\nconst useStyles = makeStyles(\n  theme => ({\n    tabsWrapper: {\n      gridArea: 'pageSubheader',\n      backgroundColor: theme.palette.background.paper,\n      paddingLeft: theme.spacing(3),\n    },\n    defaultTab: {\n      padding: theme.spacing(3, 3),\n      ...theme.typography.caption,\n      textTransform: 'uppercase',\n      fontWeight: 'bold',\n      color: theme.palette.text.secondary,\n    },\n    selected: {\n      color: theme.palette.text.primary,\n    },\n    tabRoot: {\n      '&:hover': {\n        backgroundColor: theme.palette.background.default,\n        color: theme.palette.text.primary,\n      },\n    },\n  }),\n  { name: 'BackstageHeaderTabs' },\n);\n\nexport type Tab = {\n  id: string;\n  label: string;\n  tabProps?: TabProps<React.ElementType, { component?: React.ElementType }>;\n};\n\ntype HeaderTabsProps = {\n  tabs: Tab[];\n  onChange?: (index: number) => void;\n  selectedIndex?: number;\n};\n\n/**\n * Horizontal Tabs component\n *\n * @public\n *\n */\nexport function HeaderTabs(props: HeaderTabsProps) {\n  const { tabs, onChange, selectedIndex } = props;\n  const [selectedTab, setSelectedTab] = useState<number>(selectedIndex ?? 0);\n  const styles = useStyles();\n\n  const handleChange = (_: React.ChangeEvent<{}>, index: number) => {\n    if (selectedIndex === undefined) {\n      setSelectedTab(index);\n    }\n    if (onChange) onChange(index);\n  };\n\n  useEffect(() => {\n    if (selectedIndex !== undefined) {\n      setSelectedTab(selectedIndex);\n    }\n  }, [selectedIndex]);\n\n  return (\n    <div className={styles.tabsWrapper}>\n      <Tabs\n        selectionFollowsFocus\n        indicatorColor=\"primary\"\n        textColor=\"inherit\"\n        variant=\"scrollable\"\n        scrollButtons=\"auto\"\n        aria-label=\"scrollable auto tabs example\"\n        onChange={handleChange}\n        value={selectedTab}\n      >\n        {tabs.map((tab, index) => (\n          <TabUI\n            {...tab.tabProps}\n            data-testid={`header-tab-${index}`}\n            label={tab.label}\n            key={tab.id}\n            value={index}\n            className={styles.defaultTab}\n            classes={{ selected: styles.selected, root: styles.tabRoot }}\n          />\n        ))}\n      </Tabs>\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useMemo } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { matchRoutes, useNavigate, useParams, useRoutes } from 'react-router';\nimport { Content } from '../../layout/Content';\nimport { HeaderTabs } from '../../layout/HeaderTabs';\nimport { SubRoute } from './types';\n\nexport function useSelectedSubRoute(subRoutes: SubRoute[]): {\n  index: number;\n  route: SubRoute;\n  element: JSX.Element;\n} {\n  const params = useParams();\n\n  const routes = subRoutes.map(({ path, children }) => ({\n    caseSensitive: false,\n    path: `${path}/*`,\n    element: children,\n  }));\n\n  // TODO: remove once react-router updated\n  const sortedRoutes = routes.sort((a, b) =>\n    // remove \"/*\" symbols from path end before comparing\n    b.path.replace(/\\/\\*$/, '').localeCompare(a.path.replace(/\\/\\*$/, '')),\n  );\n\n  const element = useRoutes(sortedRoutes) ?? subRoutes[0].children;\n\n  const [matchedRoute] = matchRoutes(sortedRoutes, `/${params['*']}`) ?? [];\n  const foundIndex = matchedRoute\n    ? subRoutes.findIndex(t => `${t.path}/*` === matchedRoute.route.path)\n    : 0;\n\n  return {\n    index: foundIndex === -1 ? 0 : foundIndex,\n    element,\n    route: subRoutes[foundIndex] ?? subRoutes[0],\n  };\n}\n\nexport function RoutedTabs(props: { routes: SubRoute[] }) {\n  const { routes } = props;\n  const navigate = useNavigate();\n  const { index, route, element } = useSelectedSubRoute(routes);\n  const headerTabs = useMemo(\n    () =>\n      routes.map(t => ({\n        id: t.path,\n        label: t.title,\n        tabProps: t.tabProps,\n      })),\n    [routes],\n  );\n\n  const onTabChange = (tabIndex: number) =>\n    // Remove trailing /*\n    // And remove leading / for relative navigation\n    // Note! route resolves relative to the position in the React tree,\n    // not relative to current location\n    navigate(routes[tabIndex].path.replace(/\\/\\*$/, '').replace(/^\\//, ''));\n\n  return (\n    <>\n      <HeaderTabs\n        tabs={headerTabs}\n        selectedIndex={index}\n        onChange={onTabChange}\n      />\n      <Content>\n        <Helmet title={route.title} />\n        {element}\n      </Content>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { attachComponentData } from '@backstage/core-plugin-api';\nimport React, {\n  Children,\n  Fragment,\n  isValidElement,\n  PropsWithChildren,\n  ReactNode,\n} from 'react';\nimport { RoutedTabs } from './RoutedTabs';\nimport { TabProps } from '@material-ui/core/Tab';\n\ntype SubRoute = {\n  path: string;\n  title: string;\n  children: JSX.Element;\n  tabProps?: TabProps<React.ElementType, { component?: React.ElementType }>;\n};\n\nconst Route: (props: SubRoute) => null = () => null;\n\n// This causes all mount points that are discovered within this route to use the path of the route itself\nattachComponentData(Route, 'core.gatherMountPoints', true);\n\nexport function createSubRoutesFromChildren(\n  childrenProps: ReactNode,\n): SubRoute[] {\n  // Directly comparing child.type with Route will not work with in\n  // combination with react-hot-loader in storybook\n  // https://github.com/gaearon/react-hot-loader/issues/304\n  const routeType = (\n    <Route path=\"\" title=\"\">\n      <div />\n    </Route>\n  ).type;\n\n  return Children.toArray(childrenProps).flatMap(child => {\n    if (!isValidElement(child)) {\n      return [];\n    }\n\n    if (child.type === Fragment) {\n      return createSubRoutesFromChildren(child.props.children);\n    }\n\n    if (child.type !== routeType) {\n      throw new Error('Child of TabbedLayout must be an TabbedLayout.Route');\n    }\n\n    const { path, title, children, tabProps } = child.props;\n    return [{ path, title, children, tabProps }];\n  });\n}\n\n/**\n * TabbedLayout is a compound component, which allows you to define a layout for\n * pages using a sub-navigation mechanism.\n *\n * Consists of two parts: TabbedLayout and TabbedLayout.Route\n *\n * @example\n * ```jsx\n * <TabbedLayout>\n *   <TabbedLayout.Route path=\"/example\" title=\"Example tab\">\n *     <div>This is rendered under /example/anything-here route</div>\n *   </TabbedLayout.Route>\n * </TabbedLayout>\n * ```\n */\nexport function TabbedLayout(props: PropsWithChildren<{}>) {\n  const routes = createSubRoutesFromChildren(props.children);\n\n  return <RoutedTabs routes={routes} />;\n}\n\nTabbedLayout.Route = Route;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles } from '@material-ui/core/styles';\n\nexport type SubvalueCellClassKey = 'value' | 'subvalue';\n\nconst useSubvalueCellStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    value: {\n      marginBottom: '6px',\n    },\n    subvalue: {\n      color: theme.palette.textSubtle,\n      fontWeight: 'normal',\n    },\n  }),\n  { name: 'BackstageSubvalueCell' },\n);\n\ntype SubvalueCellProps = {\n  value: React.ReactNode;\n  subvalue: React.ReactNode;\n};\n\nexport function SubvalueCell(props: SubvalueCellProps) {\n  const { value, subvalue } = props;\n  const classes = useSubvalueCellStyles();\n\n  return (\n    <>\n      <div className={classes.value}>{value}</div>\n      <div className={classes.subvalue}>{subvalue}</div>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport { Select } from '../Select';\nimport { SelectProps } from '../Select/Select';\n\nexport type TableFiltersClassKey = 'root' | 'value' | 'heder' | 'filters';\n\nconst useFilterStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    root: {\n      height: '100%',\n      width: '315px',\n      display: 'flex',\n      flexDirection: 'column',\n      marginRight: theme.spacing(3),\n    },\n    value: {\n      fontWeight: 'bold',\n      fontSize: 18,\n    },\n    header: {\n      display: 'flex',\n      alignItems: 'center',\n      height: '60px',\n      justifyContent: 'space-between',\n      borderBottom: `1px solid ${theme.palette.grey[500]}`,\n    },\n    filters: {\n      display: 'flex',\n      flexDirection: 'column',\n      '& > *': {\n        marginTop: theme.spacing(2),\n      },\n    },\n  }),\n  { name: 'BackstageTableFilters' },\n);\n\nexport type Without<T, K> = Pick<T, Exclude<keyof T, K>>;\n\nexport type Filter = {\n  type: 'select' | 'multiple-select';\n  element: Without<SelectProps, 'onChange'>;\n};\n\nexport type SelectedFilters = {\n  [key: string]: string | string[];\n};\n\ntype Props = {\n  filters: Filter[];\n  selectedFilters?: SelectedFilters;\n  onChangeFilters: (arg: any) => any;\n};\n\nexport const Filters = (props: Props) => {\n  const classes = useFilterStyles();\n\n  const { onChangeFilters } = props;\n\n  const [selectedFilters, setSelectedFilters] = useState<SelectedFilters>({\n    ...props.selectedFilters,\n  });\n  const [reset, triggerReset] = useState(false);\n\n  // Trigger re-rendering\n  const handleClick = () => {\n    setSelectedFilters({});\n    triggerReset(el => !el);\n  };\n\n  useEffect(() => {\n    onChangeFilters(selectedFilters);\n  }, [selectedFilters, onChangeFilters]);\n\n  // As material table doesn't provide a way to add a column filter tab we will make our own filter logic\n  return (\n    <div className={classes.root}>\n      <div className={classes.header}>\n        <div className={classes.value}>Filters</div>\n        <Button color=\"primary\" onClick={handleClick}>\n          Clear all\n        </Button>\n      </div>\n      <div className={classes.filters}>\n        {props.filters?.length &&\n          props.filters.map(filter => (\n            <Select\n              triggerReset={reset}\n              key={filter.element.label}\n              {...(filter.element as SelectProps)}\n              selected={selectedFilters[filter.element.label]}\n              onChange={el =>\n                setSelectedFilters({\n                  ...selectedFilters,\n                  [filter.element.label]: el as any,\n                })\n              }\n            />\n          ))}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles, useTheme, withStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\n// Material-table is not using the standard icons available in in material-ui. https://github.com/mbrn/material-table/issues/51\nimport AddBox from '@material-ui/icons/AddBox';\nimport ArrowUpward from '@material-ui/icons/ArrowUpward';\nimport Check from '@material-ui/icons/Check';\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\nimport ChevronRight from '@material-ui/icons/ChevronRight';\nimport Clear from '@material-ui/icons/Clear';\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\nimport Edit from '@material-ui/icons/Edit';\nimport FilterList from '@material-ui/icons/FilterList';\nimport FirstPage from '@material-ui/icons/FirstPage';\nimport LastPage from '@material-ui/icons/LastPage';\nimport Remove from '@material-ui/icons/Remove';\nimport SaveAlt from '@material-ui/icons/SaveAlt';\nimport ViewColumn from '@material-ui/icons/ViewColumn';\nimport { isEqual, transform } from 'lodash';\nimport MTable, {\n  Column,\n  Icons,\n  MaterialTableProps,\n  MTableBody,\n  MTableHeader,\n  MTableToolbar,\n  Options,\n} from '@material-table/core';\nimport React, {\n  forwardRef,\n  MutableRefObject,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useState,\n} from 'react';\nimport { SelectProps } from '../Select/Select';\nimport { Filter, Filters, SelectedFilters, Without } from './Filters';\n\nconst tableIcons: Icons = {\n  Add: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\n  DetailPanel: forwardRef((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  PreviousPage: forwardRef((props, ref) => (\n    <ChevronLeft {...props} ref={ref} />\n  )),\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Search: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref} />),\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />),\n};\n\n// TODO: Material table might already have such a function internally that we can use?\nfunction extractValueByField(data: any, field: string): any | undefined {\n  const path = field.split('.');\n  let value = data[path[0]];\n\n  for (let i = 1; i < path.length; ++i) {\n    if (value === undefined) {\n      return value;\n    }\n\n    const f = path[i];\n    value = value[f];\n  }\n\n  return value;\n}\n\nexport type TableHeaderClassKey = 'header';\n\nconst StyledMTableHeader = withStyles(\n  theme => ({\n    header: {\n      padding: theme.spacing(1, 2, 1, 2.5),\n      borderTop: `1px solid ${theme.palette.grey.A100}`,\n      borderBottom: `1px solid ${theme.palette.grey.A100}`,\n      // withStyles hasn't a generic overload for theme\n      color: (theme as BackstageTheme).palette.textSubtle,\n      fontWeight: theme.typography.fontWeightBold,\n      position: 'static',\n      wordBreak: 'normal',\n    },\n  }),\n  { name: 'BackstageTableHeader' },\n)(MTableHeader);\n\nexport type TableToolbarClassKey = 'root' | 'title' | 'searchField';\n\nconst StyledMTableToolbar = withStyles(\n  theme => ({\n    root: {\n      padding: theme.spacing(3, 0, 2.5, 2.5),\n    },\n    title: {\n      '& > h6': {\n        fontWeight: 'bold',\n      },\n    },\n    searchField: {\n      paddingRight: theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageTableToolbar' },\n)(MTableToolbar);\n\n/** @public */\nexport type FiltersContainerClassKey = 'root' | 'title';\n\nconst useFilterStyles = makeStyles<BackstageTheme>(\n  () => ({\n    root: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n    },\n    title: {\n      fontWeight: 'bold',\n      fontSize: 18,\n      whiteSpace: 'nowrap',\n    },\n  }),\n  { name: 'BackstageTableFiltersContainer' },\n);\n\nexport type TableClassKey = 'root';\n\nconst useTableStyles = makeStyles<BackstageTheme>(\n  () => ({\n    root: {\n      display: 'flex',\n      alignItems: 'start',\n    },\n  }),\n  { name: 'BackstageTable' },\n);\n\nfunction convertColumns<T extends object>(\n  columns: TableColumn<T>[],\n  theme: BackstageTheme,\n): TableColumn<T>[] {\n  return columns.map(column => {\n    const headerStyle: React.CSSProperties = {};\n\n    let cellStyle = column.cellStyle || {};\n\n    if (column.highlight) {\n      headerStyle.color = theme.palette.textContrast;\n\n      if (typeof cellStyle === 'object') {\n        (cellStyle as React.CSSProperties).fontWeight =\n          theme.typography.fontWeightBold;\n      } else {\n        const cellStyleFn = cellStyle as (\n          data: any,\n          rowData: T,\n          column?: Column<T>,\n        ) => React.CSSProperties;\n        cellStyle = (data, rowData, rowColumn) => {\n          const style = cellStyleFn(data, rowData, rowColumn);\n          return { ...style, fontWeight: theme.typography.fontWeightBold };\n        };\n      }\n    }\n\n    return {\n      ...column,\n      headerStyle,\n      cellStyle,\n    };\n  });\n}\n\nfunction removeDefaultValues(state: any, defaultState: any): any {\n  return transform(state, (result, value, key) => {\n    if (!isEqual(value, defaultState[key])) {\n      result[key] = value;\n    }\n  });\n}\n\nconst defaultInitialState = {\n  search: '',\n  filtersOpen: false,\n  filters: {},\n};\n\nexport interface TableColumn<T extends object = {}> extends Column<T> {\n  highlight?: boolean;\n  width?: string;\n}\n\nexport type TableFilter = {\n  column: string;\n  type: 'select' | 'multiple-select';\n};\n\nexport type TableState = {\n  search?: string;\n  filtersOpen?: boolean;\n  filters?: SelectedFilters;\n};\n\nexport interface TableProps<T extends object = {}>\n  extends MaterialTableProps<T> {\n  columns: TableColumn<T>[];\n  subtitle?: string;\n  filters?: TableFilter[];\n  initialState?: TableState;\n  emptyContent?: ReactNode;\n  onStateChange?: (state: TableState) => any;\n}\n\nexport function TableToolbar(toolbarProps: {\n  toolbarRef: MutableRefObject<any>;\n  setSearch: (value: string) => void;\n  onSearchChanged: (value: string) => void;\n  toggleFilters: () => void;\n  hasFilters: boolean;\n  selectedFiltersLength: number;\n}) {\n  const {\n    toolbarRef,\n    setSearch,\n    hasFilters,\n    selectedFiltersLength,\n    toggleFilters,\n  } = toolbarProps;\n  const filtersClasses = useFilterStyles();\n  const onSearchChanged = useCallback(\n    (searchText: string) => {\n      toolbarProps.onSearchChanged(searchText);\n      setSearch(searchText);\n    },\n    [toolbarProps, setSearch],\n  );\n\n  if (hasFilters) {\n    return (\n      <div className={filtersClasses.root}>\n        <div className={filtersClasses.root}>\n          <IconButton onClick={toggleFilters} aria-label=\"filter list\">\n            <FilterList />\n          </IconButton>\n          <Typography className={filtersClasses.title}>\n            Filters ({selectedFiltersLength})\n          </Typography>\n        </div>\n        <StyledMTableToolbar\n          {...toolbarProps}\n          ref={toolbarRef}\n          onSearchChanged={onSearchChanged}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <StyledMTableToolbar\n      {...toolbarProps}\n      ref={toolbarRef}\n      onSearchChanged={onSearchChanged}\n    />\n  );\n}\n\nexport function Table<T extends object = {}>(props: TableProps<T>) {\n  const {\n    data,\n    columns,\n    options,\n    title,\n    subtitle,\n    filters,\n    initialState,\n    emptyContent,\n    onStateChange,\n    ...restProps\n  } = props;\n  const tableClasses = useTableStyles();\n\n  const theme = useTheme<BackstageTheme>();\n\n  const calculatedInitialState = { ...defaultInitialState, ...initialState };\n\n  const [filtersOpen, setFiltersOpen] = useState(\n    calculatedInitialState.filtersOpen,\n  );\n  const toggleFilters = useCallback(\n    () => setFiltersOpen(v => !v),\n    [setFiltersOpen],\n  );\n  const [selectedFiltersLength, setSelectedFiltersLength] = useState(0);\n  const [tableData, setTableData] = useState(data as any[]);\n  const [selectedFilters, setSelectedFilters] = useState(\n    calculatedInitialState.filters,\n  );\n\n  const MTColumns = convertColumns(columns, theme);\n\n  const [search, setSearch] = useState(calculatedInitialState.search);\n\n  useEffect(() => {\n    if (onStateChange) {\n      const state = removeDefaultValues(\n        {\n          search,\n          filtersOpen,\n          filters: selectedFilters,\n        },\n        defaultInitialState,\n      );\n\n      onStateChange(state);\n    }\n  }, [search, filtersOpen, selectedFilters, onStateChange]);\n\n  const defaultOptions: Options<T> = {\n    headerStyle: {\n      textTransform: 'uppercase',\n    },\n  };\n\n  const getFieldByTitle = useCallback(\n    (titleValue: string | keyof T) =>\n      columns.find(el => el.title === titleValue)?.field,\n    [columns],\n  );\n\n  useEffect(() => {\n    if (typeof data === 'function') {\n      return;\n    }\n    if (!selectedFilters) {\n      setTableData(data as any[]);\n      return;\n    }\n\n    const selectedFiltersArray = Object.values(selectedFilters);\n    if (data && selectedFiltersArray.flat().length) {\n      const newData = (data as any[]).filter(\n        el =>\n          !!Object.entries(selectedFilters)\n            .filter(([, value]) => !!value.length)\n            .every(([key, filterValue]) => {\n              const fieldValue = extractValueByField(\n                el,\n                getFieldByTitle(key) as string,\n              );\n\n              if (Array.isArray(fieldValue) && Array.isArray(filterValue)) {\n                return fieldValue.some(v => filterValue.includes(v));\n              } else if (Array.isArray(fieldValue)) {\n                return fieldValue.includes(filterValue);\n              } else if (Array.isArray(filterValue)) {\n                return filterValue.includes(fieldValue);\n              }\n\n              return fieldValue === filterValue;\n            }),\n      );\n      setTableData(newData);\n    } else {\n      setTableData(data as any[]);\n    }\n    setSelectedFiltersLength(selectedFiltersArray.flat().length);\n  }, [data, selectedFilters, getFieldByTitle]);\n\n  const constructFilters = (\n    filterConfig: TableFilter[],\n    dataValue: any[] | undefined,\n  ): Filter[] => {\n    const extractDistinctValues = (field: string | keyof T): Set<any> => {\n      const distinctValues = new Set<any>();\n      const addValue = (value: any) => {\n        if (value !== undefined && value !== null) {\n          distinctValues.add(value);\n        }\n      };\n\n      if (dataValue) {\n        dataValue.forEach(el => {\n          const value = extractValueByField(\n            el,\n            getFieldByTitle(field) as string,\n          );\n\n          if (Array.isArray(value)) {\n            (value as []).forEach(addValue);\n          } else {\n            addValue(value);\n          }\n        });\n      }\n\n      return distinctValues;\n    };\n\n    const constructSelect = (\n      filter: TableFilter,\n    ): Without<SelectProps, 'onChange'> => {\n      return {\n        placeholder: 'All results',\n        label: filter.column,\n        multiple: filter.type === 'multiple-select',\n        items: [...extractDistinctValues(filter.column)].sort().map(value => ({\n          label: value,\n          value,\n        })),\n      };\n    };\n\n    return filterConfig.map(filter => ({\n      type: filter.type,\n      element: constructSelect(filter),\n    }));\n  };\n\n  const hasFilters = !!filters?.length;\n  const Toolbar = useCallback(\n    toolbarProps => {\n      return (\n        <TableToolbar\n          setSearch={setSearch}\n          hasFilters={hasFilters}\n          selectedFiltersLength={selectedFiltersLength}\n          toggleFilters={toggleFilters}\n          {...toolbarProps}\n        />\n      );\n    },\n    [toggleFilters, hasFilters, selectedFiltersLength, setSearch],\n  );\n\n  const hasNoRows = typeof data !== 'function' && data.length === 0;\n  const columnCount = columns.length;\n  const Body = useCallback(\n    bodyProps => {\n      if (emptyContent && hasNoRows) {\n        return (\n          <tbody>\n            <tr>\n              <td colSpan={columnCount}>{emptyContent}</td>\n            </tr>\n          </tbody>\n        );\n      }\n\n      return <MTableBody {...bodyProps} />;\n    },\n    [hasNoRows, emptyContent, columnCount],\n  );\n\n  return (\n    <div className={tableClasses.root}>\n      {filtersOpen && data && typeof data !== 'function' && filters?.length && (\n        <Filters\n          filters={constructFilters(filters, data as any[])}\n          selectedFilters={selectedFilters}\n          onChangeFilters={setSelectedFilters}\n        />\n      )}\n      <MTable<T>\n        components={{\n          Header: StyledMTableHeader,\n          Toolbar,\n          Body,\n        }}\n        options={{ ...defaultOptions, ...options }}\n        columns={MTColumns}\n        icons={tableIcons}\n        title={\n          <>\n            <Typography variant=\"h5\" component=\"h3\">\n              {title}\n            </Typography>\n            {subtitle && (\n              <Typography color=\"textSecondary\" variant=\"body1\">\n                {subtitle}\n              </Typography>\n            )}\n          </>\n        }\n        data={typeof data === 'function' ? data : tableData}\n        style={{ width: '100%' }}\n        localization={{ toolbar: { searchPlaceholder: 'Filter' } }}\n        {...restProps}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function chunkArray<T>(array: T[], chunkSize: number): T[][] {\n  if (chunkSize <= 0) {\n    return [array];\n  }\n\n  const result: T[][] = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    result.push(array.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { PropsWithChildren } from 'react';\nimport Box from '@material-ui/core/Box';\n\nexport interface TabPanelProps {\n  value?: any;\n  index?: number;\n}\n\nexport const TabPanel = (props: PropsWithChildren<TabPanelProps>) => {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      aria-labelledby={`scrollable-auto-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box p={3}>{children}</Box>}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport { BackstageTheme } from '@backstage/theme';\n\ninterface StyledIconProps {\n  ariaLabel: string;\n  children: any;\n  isNext?: boolean;\n  onClick: any;\n}\n\nexport type TabIconClassKey = 'root';\n\nconst useStyles = makeStyles<BackstageTheme, StyledIconProps>(\n  () => ({\n    root: {\n      color: '#6E6E6E',\n      overflow: 'visible',\n      fontSize: '1.5rem',\n      textAlign: 'center',\n      borderRadius: '50%',\n      backgroundColor: '#E6E6E6',\n      marginLeft: props => (props.isNext ? 'auto' : '0'),\n      marginRight: props => (props.isNext ? '0' : '10px'),\n      '&:hover': {\n        backgroundColor: '#E6E6E6',\n        opacity: '1',\n      },\n    },\n  }),\n  { name: 'BackstageTabIcon' },\n);\n\nexport const StyledIcon = (props: StyledIconProps) => {\n  const classes = useStyles(props);\n  const { ariaLabel, onClick } = props;\n  return (\n    <IconButton\n      onClick={onClick}\n      className={classes.root}\n      size=\"small\"\n      disableRipple\n      disableFocusRipple\n      aria-label={ariaLabel}\n    >\n      {props.children}\n    </IconButton>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tab from '@material-ui/core/Tab';\nimport { BackstageTheme } from '@backstage/theme';\n\ninterface StyledTabProps {\n  label?: string;\n  icon?: any; // TODO: define type for material-ui icons\n  isFirstNav?: boolean;\n  isFirstIndex?: boolean;\n  value?: any;\n}\n\nconst tabMarginLeft = (isFirstNav: boolean, isFirstIndex: boolean) => {\n  if (isFirstIndex) {\n    if (isFirstNav) {\n      return '20px';\n    }\n    return '0';\n  }\n  return '40px';\n};\n\nconst useStyles = makeStyles<BackstageTheme, StyledTabProps>(theme => ({\n  root: {\n    textTransform: 'none',\n    height: '64px',\n    fontWeight: theme.typography.fontWeightBold,\n    fontSize: theme.typography.pxToRem(13),\n    color: theme.palette.textSubtle,\n    marginLeft: props =>\n      tabMarginLeft(props.isFirstNav as boolean, props.isFirstIndex as boolean),\n    width: '130px',\n    minWidth: '130px',\n    '&:hover': {\n      outline: 'none',\n      backgroundColor: 'transparent',\n      color: theme.palette.textSubtle,\n    },\n  },\n}));\n\nexport const StyledTab = (props: StyledTabProps) => {\n  const classes = useStyles(props);\n  const { isFirstNav, isFirstIndex, ...rest } = props;\n  return <Tab className={classes.root} disableRipple {...rest} />;\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { PropsWithChildren } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tabs from '@material-ui/core/Tabs';\nimport { BackstageTheme } from '@backstage/theme';\n\ninterface StyledTabsProps {\n  value: number | boolean;\n  selectionFollowsFocus: boolean;\n  onChange: (event: React.ChangeEvent<{}>, newValue: number) => void;\n}\n\nexport type TabBarClassKey = 'indicator' | 'flexContainer' | 'root';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    indicator: {\n      display: 'flex',\n      justifyContent: 'center',\n      backgroundColor: theme.palette.tabbar.indicator,\n      height: '4px',\n    },\n    flexContainer: {\n      alignItems: 'center',\n    },\n    root: {\n      '&:last-child': {\n        marginLeft: 'auto',\n      },\n    },\n  }),\n  { name: 'BackstageTabBar' },\n);\n\nexport const StyledTabs = (props: PropsWithChildren<StyledTabsProps>) => {\n  const classes = useStyles(props);\n  return (\n    <Tabs\n      classes={classes}\n      {...props}\n      TabIndicatorProps={{ children: <span /> }}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef, useEffect, MutableRefObject, useState } from 'react';\nimport { BackstageTheme } from '@backstage/theme';\nimport AppBar from '@material-ui/core/AppBar';\nimport { makeStyles } from '@material-ui/core/styles';\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport { chunkArray } from './utils';\nimport useWindowSize from 'react-use/lib/useWindowSize';\n\n/* Import Components */\n\nimport { TabPanel } from './TabPanel';\nimport { StyledIcon } from './TabIcon';\nimport { StyledTab } from './Tab';\nimport { StyledTabs } from './TabBar';\n\n/* Props Types */\n\nexport interface TabProps {\n  content: any;\n  label?: string;\n  icon?: any; // TODO: define type for material-ui icons\n}\n\nexport interface TabsProps {\n  tabs: TabProps[];\n}\n\nexport type TabsClassKey = 'root' | 'styledTabs' | 'appbar';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    root: {\n      flexGrow: 1,\n      width: '100%',\n    },\n    styledTabs: {\n      backgroundColor: theme.palette.background.paper,\n    },\n    appbar: {\n      boxShadow: 'none',\n      backgroundColor: theme.palette.background.paper,\n      paddingLeft: '10px',\n      paddingRight: '10px',\n    },\n  }),\n  { name: 'BackstageTabs' },\n);\n\nexport function Tabs(props: TabsProps) {\n  const { tabs } = props;\n  const classes = useStyles();\n  const [value, setValue] = useState([0, 0]); // [selectedChunkedNavIndex, selectedIndex]\n  const [navIndex, setNavIndex] = useState(0);\n  const [numberOfChunkedElement, setNumberOfChunkedElement] = useState(0);\n  const [chunkedTabs, setChunkedTabs] = useState<TabProps[][]>([[]]);\n  const wrapper = useRef() as MutableRefObject<HTMLDivElement>;\n\n  const { width } = useWindowSize();\n\n  const handleChange = (_: React.ChangeEvent<{}>, newValue: number) => {\n    setValue([navIndex, newValue]);\n  };\n\n  const navigateToPrevChunk = () => {\n    setNavIndex(navIndex - 1);\n  };\n\n  const navigateToNextChunk = () => {\n    setNavIndex(navIndex + 1);\n  };\n\n  const hasNextNavIndex = () => navIndex + 1 < chunkedTabs.length;\n\n  useEffect(() => {\n    // Each time the window is resized we calculate how many tabs we can render given the window width\n    const padding = 20; // The AppBar padding\n\n    const numberOfTabIcons = navIndex === 0 ? 1 : 2;\n    const wrapperWidth =\n      wrapper.current.offsetWidth - padding - numberOfTabIcons * 30;\n    const flattenIndex = value[0] * numberOfChunkedElement + value[1];\n    const newChunkedElementSize = Math.floor(wrapperWidth / 170);\n\n    setNumberOfChunkedElement(newChunkedElementSize);\n    setChunkedTabs(chunkArray(tabs, newChunkedElementSize));\n    setValue([\n      Math.floor(flattenIndex / newChunkedElementSize),\n      flattenIndex % newChunkedElementSize,\n    ]);\n    // eslint-disable-next-line\n  }, [width, tabs]);\n\n  const currentIndex = navIndex === value[0] ? value[1] : false;\n\n  return (\n    <div className={classes.root}>\n      <AppBar ref={wrapper} className={classes.appbar} position=\"static\">\n        <div>\n          <StyledTabs\n            value={currentIndex}\n            onChange={handleChange}\n            selectionFollowsFocus\n          >\n            {navIndex !== 0 && (\n              <StyledIcon\n                onClick={navigateToPrevChunk}\n                ariaLabel=\"navigate-before\"\n              >\n                <NavigateBeforeIcon />\n              </StyledIcon>\n            )}\n            {chunkedTabs[navIndex].map((tab, index) => (\n              <StyledTab\n                value={index}\n                isFirstIndex={index === 0}\n                isFirstNav={navIndex === 0}\n                key={index}\n                icon={tab.icon || undefined}\n                label={tab.label || undefined}\n              />\n            ))}\n            {hasNextNavIndex() && (\n              <StyledIcon\n                isNext\n                onClick={navigateToNextChunk}\n                ariaLabel=\"navigate-next\"\n              >\n                <NavigateNextIcon />\n              </StyledIcon>\n            )}\n          </StyledTabs>\n        </div>\n      </AppBar>\n      {currentIndex !== false ? (\n        chunkedTabs[navIndex].map((tab, index) => (\n          <TabPanel key={index} value={index} index={currentIndex}>\n            {tab.content}\n          </TabPanel>\n        ))\n      ) : (\n        // Render if the selected tab index is outside the current rendered chunked array\n        <TabPanel\n          key=\"panel_outside_chunked_array\"\n          value={value[1]}\n          index={value[1]}\n        >\n          {chunkedTabs[value[0]][value[1]].content}\n        </TabPanel>\n      )}\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  Sparklines,\n  SparklinesLine,\n  SparklinesLineProps,\n  SparklinesProps,\n} from 'react-sparklines';\nimport { useTheme } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\n\nfunction color(data: number[], theme: BackstageTheme): string | undefined {\n  const lastNum = data[data.length - 1];\n  if (!lastNum) return undefined;\n  if (lastNum >= 0.9) return theme.palette.status.ok;\n  if (lastNum >= 0.5) return theme.palette.status.warning;\n  return theme.palette.status.error;\n}\n\nexport function TrendLine(\n  props: SparklinesProps &\n    Pick<SparklinesLineProps, 'color'> & { title?: string },\n) {\n  const theme = useTheme<BackstageTheme>();\n\n  if (!props.data) return null;\n  return (\n    <Sparklines width={120} height={30} min={0} max={1} {...props}>\n      {props.title && <title>{props.title}</title>}\n      <SparklinesLine color={props.color ?? color(props.data, theme)} />\n    </Sparklines>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * TODO favoriteable capability\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React, { PropsWithChildren, ReactNode } from 'react';\nimport { Helmet } from 'react-helmet';\n\n/** @public */\nexport type ContentHeaderClassKey =\n  | 'container'\n  | 'leftItemsBox'\n  | 'rightItemsBox'\n  | 'description'\n  | 'title';\n\nconst useStyles = (props: ContentHeaderProps) =>\n  makeStyles(\n    theme => ({\n      container: {\n        width: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        flexWrap: 'wrap',\n        justifyContent: 'flex-end',\n        alignItems: 'center',\n        marginBottom: theme.spacing(2),\n        textAlign: props.textAlign,\n      },\n      leftItemsBox: {\n        flex: '1 1 auto',\n        minWidth: 0,\n        overflow: 'visible',\n      },\n      rightItemsBox: {\n        flex: '0 1 auto',\n        display: 'flex',\n        flexDirection: 'row',\n        flexWrap: 'wrap',\n        alignItems: 'center',\n        marginLeft: theme.spacing(1),\n        minWidth: 0,\n        overflow: 'visible',\n      },\n      description: {},\n      title: {\n        display: 'inline-flex',\n        marginBottom: 0,\n      },\n    }),\n    { name: 'BackstageContentHeader' },\n  );\n\ntype ContentHeaderTitleProps = {\n  title?: string;\n  className?: string;\n};\n\nconst ContentHeaderTitle = ({\n  title = 'Unknown page',\n  className,\n}: ContentHeaderTitleProps) => (\n  <Typography\n    variant=\"h4\"\n    component=\"h2\"\n    className={className}\n    data-testid=\"header-title\"\n  >\n    {title}\n  </Typography>\n);\n\ntype ContentHeaderProps = {\n  title?: ContentHeaderTitleProps['title'];\n  titleComponent?: ReactNode;\n  description?: string;\n  textAlign?: 'left' | 'right' | 'center';\n};\n\n/**\n *  A header at the top inside a {@link Content}.\n *\n * @public\n *\n */\n\nexport function ContentHeader(props: PropsWithChildren<ContentHeaderProps>) {\n  const {\n    description,\n    title,\n    titleComponent: TitleComponent = undefined,\n    children,\n    textAlign = 'left',\n  } = props;\n  const classes = useStyles({ textAlign })();\n\n  const renderedTitle = TitleComponent ? (\n    TitleComponent\n  ) : (\n    <ContentHeaderTitle title={title} className={classes.title} />\n  );\n\n  return (\n    <>\n      <Helmet title={title} />\n      <div className={classes.container}>\n        <div className={classes.leftItemsBox}>\n          {renderedTitle}\n          {description && (\n            <Typography className={classes.description} variant=\"body2\">\n              {description}\n            </Typography>\n          )}\n        </div>\n        <div className={classes.rightItemsBox}>{children}</div>\n      </div>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MicDropSvgUrl from './mic-drop.svg';\n\nconst useStyles = makeStyles(\n  theme => ({\n    micDrop: {\n      maxWidth: '60%',\n      position: 'absolute',\n      bottom: theme.spacing(2),\n      right: theme.spacing(2),\n      [theme.breakpoints.down('xs')]: {\n        maxWidth: '96%',\n        position: 'relative',\n        bottom: 'unset',\n        right: 'unset',\n        margin: `${theme.spacing(10)}px auto ${theme.spacing(4)}px`,\n      },\n    },\n  }),\n  { name: 'BackstageErrorPageMicDrop' },\n);\n\nexport type MicDropClassKey = 'micDrop';\n\nexport const MicDrop = () => {\n  const classes = useStyles();\n  return (\n    <img\n      src={MicDropSvgUrl}\n      className={classes.micDrop}\n      alt=\"Girl dropping mic from her hands\"\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { useNavigate } from 'react-router';\nimport { Link } from '../../components/Link';\nimport { useSupportConfig } from '../../hooks';\nimport { MicDrop } from './MicDrop';\n\ninterface IErrorPageProps {\n  status: string;\n  statusMessage: string;\n  additionalInfo?: React.ReactNode;\n  supportUrl?: string;\n}\n\n/** @public */\nexport type ErrorPageClassKey = 'container' | 'title' | 'subtitle';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    container: {\n      padding: theme.spacing(8),\n      [theme.breakpoints.down('xs')]: {\n        padding: theme.spacing(2),\n      },\n    },\n    title: {\n      paddingBottom: theme.spacing(5),\n      [theme.breakpoints.down('xs')]: {\n        paddingBottom: theme.spacing(4),\n        fontSize: 32,\n      },\n    },\n    subtitle: {\n      color: theme.palette.textSubtle,\n    },\n  }),\n  { name: 'BackstageErrorPage' },\n);\n\n/**\n * Error page with status and description\n *\n * @public\n *\n */\nexport function ErrorPage(props: IErrorPageProps) {\n  const { status, statusMessage, additionalInfo, supportUrl } = props;\n  const classes = useStyles();\n  const navigate = useNavigate();\n  const support = useSupportConfig();\n\n  return (\n    <Grid container spacing={0} className={classes.container}>\n      <MicDrop />\n      <Grid item xs={12} sm={8} md={4}>\n        <Typography\n          data-testid=\"error\"\n          variant=\"body1\"\n          className={classes.subtitle}\n        >\n          ERROR {status}: {statusMessage}\n        </Typography>\n        <Typography variant=\"body1\" className={classes.subtitle}>\n          {additionalInfo}\n        </Typography>\n        <Typography variant=\"h2\" className={classes.title}>\n          Looks like someone dropped the mic!\n        </Typography>\n        <Typography variant=\"h6\">\n          <Link to=\"#\" data-testid=\"go-back-link\" onClick={() => navigate(-1)}>\n            Go back\n          </Link>\n          ... or please{' '}\n          <Link to={supportUrl || support.url}>contact support</Link> if you\n          think this is a bug.\n        </Typography>\n      </Grid>\n    </Grid>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport MaterialBreadcrumbs from '@material-ui/core/Breadcrumbs';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport Popover from '@material-ui/core/Popover';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React, { ComponentProps, Fragment } from 'react';\n\ntype Props = ComponentProps<typeof MaterialBreadcrumbs>;\n\n/** @public */\nexport type BreadcrumbsClickableTextClassKey = 'root';\n\nconst ClickableText = withStyles(\n  {\n    root: {\n      textDecoration: 'underline',\n      cursor: 'pointer',\n    },\n  },\n  { name: 'BackstageBreadcrumbsClickableText' },\n)(Typography);\n\n/** @public */\nexport type BreadcrumbsStyledBoxClassKey = 'root';\n\nconst StyledBox = withStyles(\n  {\n    root: {\n      textDecoration: 'underline',\n      color: 'inherit',\n    },\n  },\n  { name: 'BackstageBreadcrumbsStyledBox' },\n)(Box);\n\n/**\n * Breadcrumbs component to show navigation hierarchical structure\n *\n * @public\n *\n */\nexport function Breadcrumbs(props: Props) {\n  const { children, ...restProps } = props;\n  const [anchorEl, setAnchorEl] = React.useState<HTMLButtonElement | null>(\n    null,\n  );\n\n  const childrenArray = React.Children.toArray(children);\n\n  const [firstPage, secondPage, ...expandablePages] = childrenArray;\n  const currentPage = expandablePages.length\n    ? expandablePages.pop()\n    : childrenArray[childrenArray.length - 1];\n  const hasHiddenBreadcrumbs = childrenArray.length > 3;\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const open = Boolean(anchorEl);\n  return (\n    <Fragment>\n      <MaterialBreadcrumbs aria-label=\"breadcrumb\" {...restProps}>\n        {childrenArray.length > 1 && <StyledBox clone>{firstPage}</StyledBox>}\n        {childrenArray.length > 2 && <StyledBox clone>{secondPage}</StyledBox>}\n        {hasHiddenBreadcrumbs && (\n          <ClickableText onClick={handleClick}>...</ClickableText>\n        )}\n        <Box style={{ fontStyle: 'italic' }}>{currentPage}</Box>\n      </MaterialBreadcrumbs>\n      <Popover\n        open={open}\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        <List>\n          {expandablePages.map((pageLink, index) => (\n            <ListItem key={index} button>\n              <StyledBox clone>{pageLink}</StyledBox>\n            </ListItem>\n          ))}\n        </List>\n      </Popover>\n    </Fragment>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { configApiRef, useApi } from '@backstage/core-plugin-api';\nimport { BackstageTheme } from '@backstage/theme';\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport React, { CSSProperties, PropsWithChildren, ReactNode } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { Link } from '../../components/Link';\nimport { Breadcrumbs } from '../Breadcrumbs';\n\n/** @public */\nexport type HeaderClassKey =\n  | 'header'\n  | 'leftItemsBox'\n  | 'rightItemsBox'\n  | 'title'\n  | 'subtitle'\n  | 'type'\n  | 'breadcrumb'\n  | 'breadcrumbType'\n  | 'breadcrumbTitle';\n\nconst useStyles = makeStyles<BackstageTheme>(\n  theme => ({\n    header: {\n      gridArea: 'pageHeader',\n      padding: theme.spacing(3),\n      width: '100%',\n      boxShadow: theme.shadows[4],\n      position: 'relative',\n      zIndex: 100,\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n      backgroundImage: theme.page.backgroundImage,\n      backgroundPosition: 'center',\n      backgroundSize: 'cover',\n      [theme.breakpoints.down('sm')]: {\n        flexWrap: 'wrap',\n      },\n    },\n    leftItemsBox: {\n      maxWidth: '100%',\n      flexGrow: 1,\n    },\n    rightItemsBox: {\n      width: 'auto',\n    },\n    title: {\n      color: theme.palette.bursts.fontColor,\n      wordBreak: 'break-all',\n      fontSize: theme.typography.h3.fontSize,\n      marginBottom: 0,\n    },\n    subtitle: {\n      color: theme.palette.bursts.fontColor,\n      opacity: 0.8,\n      display: 'inline-block', // prevents margin collapse of adjacent siblings\n      marginTop: theme.spacing(1),\n      maxWidth: '75ch',\n    },\n    type: {\n      textTransform: 'uppercase',\n      fontSize: 11,\n      opacity: 0.8,\n      marginBottom: theme.spacing(1),\n      color: theme.palette.bursts.fontColor,\n    },\n    breadcrumb: {\n      color: theme.palette.bursts.fontColor,\n    },\n    breadcrumbType: {\n      fontSize: 'inherit',\n      opacity: 0.7,\n      marginRight: -theme.spacing(0.3),\n      marginBottom: theme.spacing(0.3),\n    },\n    breadcrumbTitle: {\n      fontSize: 'inherit',\n      marginLeft: -theme.spacing(0.3),\n      marginBottom: theme.spacing(0.3),\n    },\n  }),\n  { name: 'BackstageHeader' },\n);\n\ntype HeaderStyles = ReturnType<typeof useStyles>;\n\ntype Props = {\n  component?: ReactNode;\n  pageTitleOverride?: string;\n  style?: CSSProperties;\n  subtitle?: ReactNode;\n  title: ReactNode;\n  tooltip?: string;\n  type?: string;\n  typeLink?: string;\n};\n\ntype TypeFragmentProps = {\n  classes: HeaderStyles;\n  pageTitle: string | ReactNode;\n  type?: Props['type'];\n  typeLink?: Props['typeLink'];\n};\n\ntype TitleFragmentProps = {\n  classes: HeaderStyles;\n  pageTitle: string | ReactNode;\n  tooltip?: Props['tooltip'];\n};\n\ntype SubtitleFragmentProps = {\n  classes: HeaderStyles;\n  subtitle?: Props['subtitle'];\n};\n\nconst TypeFragment = ({\n  type,\n  typeLink,\n  classes,\n  pageTitle,\n}: TypeFragmentProps) => {\n  if (!type) {\n    return null;\n  }\n\n  if (!typeLink) {\n    return <Typography className={classes.type}>{type}</Typography>;\n  }\n\n  return (\n    <Breadcrumbs className={classes.breadcrumb}>\n      <Link to={typeLink}>{type}</Link>\n      <Typography>{pageTitle}</Typography>\n    </Breadcrumbs>\n  );\n};\n\nconst TitleFragment = ({ pageTitle, classes, tooltip }: TitleFragmentProps) => {\n  const FinalTitle = (\n    <Typography className={classes.title} variant=\"h1\">\n      {pageTitle}\n    </Typography>\n  );\n\n  if (!tooltip) {\n    return FinalTitle;\n  }\n\n  return (\n    <Tooltip title={tooltip} placement=\"top-start\">\n      {FinalTitle}\n    </Tooltip>\n  );\n};\n\nconst SubtitleFragment = ({ classes, subtitle }: SubtitleFragmentProps) => {\n  if (!subtitle) {\n    return null;\n  }\n\n  if (typeof subtitle !== 'string') {\n    return <>{subtitle}</>;\n  }\n\n  return (\n    <Typography\n      className={classes.subtitle}\n      variant=\"subtitle2\"\n      component=\"span\"\n    >\n      {subtitle}\n    </Typography>\n  );\n};\n/**\n * Backstage main header with abstract color background in multiple variants\n *\n * @public\n *\n */\nexport function Header(props: PropsWithChildren<Props>) {\n  const {\n    children,\n    pageTitleOverride,\n    style,\n    subtitle,\n    title,\n    tooltip,\n    type,\n    typeLink,\n  } = props;\n  const classes = useStyles();\n  const configApi = useApi(configApiRef);\n  const appTitle = configApi.getOptionalString('app.title') || 'Backstage';\n  const documentTitle = pageTitleOverride || title;\n  const pageTitle = title || pageTitleOverride;\n  const titleTemplate = `${documentTitle} | %s | ${appTitle}`;\n  const defaultTitle = `${documentTitle} | ${appTitle}`;\n\n  return (\n    <>\n      <Helmet titleTemplate={titleTemplate} defaultTitle={defaultTitle} />\n      <header style={style} className={classes.header}>\n        <Box className={classes.leftItemsBox}>\n          <TypeFragment\n            classes={classes}\n            type={type}\n            typeLink={typeLink}\n            pageTitle={pageTitle}\n          />\n          <TitleFragment\n            classes={classes}\n            pageTitle={pageTitle}\n            tooltip={tooltip}\n          />\n          <SubtitleFragment classes={classes} subtitle={subtitle} />\n        </Box>\n        <Grid container className={classes.rightItemsBox} spacing={4}>\n          {children}\n        </Grid>\n      </header>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { Link } from '../../components/Link';\n\n/** @public */\nexport type HeaderLabelClassKey = 'root' | 'label' | 'value';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      textAlign: 'left',\n    },\n    label: {\n      color: theme.palette.common.white,\n      fontWeight: 'bold',\n      letterSpacing: 0,\n      fontSize: theme.typography.fontSize,\n      marginBottom: theme.spacing(1) / 2,\n      lineHeight: 1,\n    },\n    value: {\n      color: 'rgba(255, 255, 255, 0.8)',\n      fontSize: theme.typography.fontSize,\n      lineHeight: 1,\n    },\n  }),\n  { name: 'BackstageHeaderLabel' },\n);\n\ntype HeaderLabelContentProps = {\n  value: React.ReactNode;\n  className: string;\n};\n\nconst HeaderLabelContent = ({ value, className }: HeaderLabelContentProps) => (\n  <Typography className={className}>{value}</Typography>\n);\n\ntype HeaderLabelProps = {\n  label: string;\n  value?: HeaderLabelContentProps['value'];\n  url?: string;\n};\n\n/**\n * Additional label to main {@link Header}\n *\n * @public\n *\n */\nexport function HeaderLabel(props: HeaderLabelProps) {\n  const { label, value, url } = props;\n  const classes = useStyles();\n  const content = (\n    <HeaderLabelContent\n      className={classes.value}\n      value={value || '<Unknown>'}\n    />\n  );\n  return (\n    <Grid item>\n      <span className={classes.root}>\n        <Typography className={classes.label}>{label}</Typography>\n        {url ? <Link to={url}>{content}</Link> : content}\n      </span>\n    </Grid>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { HeaderLabel } from '../HeaderLabel';\nimport { ConfigApi, useApi, configApiRef } from '@backstage/core-plugin-api';\n\nconst timeFormat: Intl.DateTimeFormatOptions = {\n  hour: '2-digit',\n  minute: '2-digit',\n};\n\ntype TimeObj = {\n  time: string;\n  label: string;\n};\n\nfunction getTimes(configApi: ConfigApi) {\n  const d = new Date();\n  const lang = window.navigator.language;\n\n  const clocks: TimeObj[] = [];\n\n  if (!configApi.has('homepage.clocks')) {\n    return clocks;\n  }\n\n  const clockConfigs = configApi.getConfigArray('homepage.clocks');\n\n  for (const clock of clockConfigs) {\n    if (clock.has('label') && clock.has('timezone')) {\n      let label = clock.getString('label');\n\n      const options: Intl.DateTimeFormatOptions = {\n        timeZone: clock.getString('timezone'),\n        ...timeFormat,\n      };\n\n      try {\n        new Date().toLocaleString(lang, options);\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `The timezone ${options.timeZone} is invalid. Defaulting to GMT`,\n        );\n        options.timeZone = 'GMT';\n        label = 'GMT';\n      }\n\n      const time = d.toLocaleTimeString(lang, options);\n      clocks.push({ time, label });\n    }\n  }\n  return clocks;\n}\n\n/**\n * Please use the HeaderWorldClock in the home plugin\n *\n * @public\n * @deprecated in favor of the HeaderWorldClock which is found in the to home plugin\n */\nexport function HomepageTimer(_props: {}) {\n  const configApi = useApi(configApiRef);\n\n  const defaultTimes: TimeObj[] = [];\n  const [clocks, setTimes] = React.useState(defaultTimes);\n\n  React.useEffect(() => {\n    setTimes(getTimes(configApi));\n\n    const intervalId = setInterval(() => {\n      setTimes(getTimes(configApi));\n    }, 1000);\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [configApi]);\n\n  if (clocks.length !== 0) {\n    return (\n      <>\n        {clocks.map(clock => (\n          <HeaderLabel\n            label={clock.label}\n            value={clock.time}\n            key={clock.label}\n          />\n        ))}\n      </>\n    );\n  }\n  return null;\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createStyles, makeStyles, WithStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { BackstageTheme } from '@backstage/theme';\n\n/** @public */\nexport type ItemCardHeaderClassKey = 'root';\n\nconst styles = (theme: BackstageTheme) =>\n  createStyles({\n    root: {\n      color: theme.palette.common.white,\n      padding: theme.spacing(2, 2, 3),\n      backgroundImage: theme.palette.bursts.gradient.linear,\n      backgroundPosition: 0,\n      backgroundSize: 'inherit',\n    },\n  });\n\nconst useStyles = makeStyles(styles, { name: 'BackstageItemCardHeader' });\n\n/** @public */\nexport type ItemCardHeaderProps = Partial<WithStyles<typeof styles>> & {\n  /**\n   * A large title to show in the header, providing the main heading.\n   *\n   * Use this if you want to have the default styling and placement of a title.\n   */\n  title?: React.ReactNode;\n  /**\n   * A slightly smaller title to show in the header, providing additional\n   * details.\n   *\n   * Use this if you want to have the default styling and placement of a\n   * subtitle.\n   */\n  subtitle?: React.ReactNode;\n  /**\n   * Custom children to draw in the header.\n   *\n   * If the title and/or subtitle were specified, the children are drawn below\n   * those.\n   */\n  children?: React.ReactNode;\n};\n\n/**\n * A simple card header, rendering a default look for \"item cards\" - cards that\n * are arranged in a grid for users to select among several options.\n *\n * This component expects to be placed within a MUI <CardMedia>.\n *\n * Styles for the header can be overridden using the `classes` prop, e.g.:\n *\n * `<ItemCardHeader title=\"Hello\" classes={{ root: myClassName }} />`\n *\n * @public\n */\nexport function ItemCardHeader(props: ItemCardHeaderProps) {\n  const { title, subtitle, children } = props;\n  const classes = useStyles(props);\n  return (\n    <div className={classes.root}>\n      {subtitle && (\n        <Typography variant=\"subtitle2\" component=\"h3\">\n          {subtitle}\n        </Typography>\n      )}\n      {title && (\n        <Typography variant=\"h6\" component=\"h4\">\n          {title}\n        </Typography>\n      )}\n      {children}\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Chip from '@material-ui/core/Chip';\nimport React, { ReactNode } from 'react';\nimport { Button } from '../../components';\nimport { ItemCardHeader } from './ItemCardHeader';\n\ntype ItemCardProps = {\n  description?: string;\n  tags?: string[];\n  title: string;\n  /** @deprecated Use subtitle instead */\n  type?: string;\n  subtitle?: ReactNode;\n  label: string;\n  onClick?: () => void;\n  href?: string;\n};\n\n/**\n * This card type has been deprecated. Instead use plain MUI Card and helpers\n * where appropriate.\n *\n * ```\n *   <Card>\n *     <CardMedia>\n *       <ItemCardHeader title=\"My Card\" subtitle=\"neat!\" />\n *     </CardMedia>\n *     <CardContent>\n *        Some text\n *     </CardContent>\n *     <CardActions>\n *       <Button color=\"primary\" to=\"https://backstage.io\">\n *         Get Started\n *       </Button>\n *     </CardActions>\n *   </Card>\n * ```\n *\n * @deprecated Use plain MUI `<Card>` and composable helpers instead.\n * @see https://material-ui.com/components/cards/\n */\nexport function ItemCard(props: ItemCardProps) {\n  const { description, tags, title, type, subtitle, label, onClick, href } =\n    props;\n  return (\n    <Card>\n      <CardMedia>\n        <ItemCardHeader title={title} subtitle={subtitle || type} />\n      </CardMedia>\n      <CardContent>\n        {tags?.length ? (\n          <Box>\n            {tags.map((tag, i) => (\n              <Chip size=\"small\" label={tag} key={i} />\n            ))}\n          </Box>\n        ) : null}\n        {description}\n      </CardContent>\n      <CardActions>\n        {!href && (\n          <Button to=\"#\" onClick={onClick} color=\"primary\">\n            {label}\n          </Button>\n        )}\n        {href && (\n          <Button to={href} color=\"primary\">\n            {label}\n          </Button>\n        )}\n      </CardActions>\n    </Card>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createStyles,\n  makeStyles,\n  Theme,\n  WithStyles,\n} from '@material-ui/core/styles';\nimport React from 'react';\n\n/** @public */\nexport type ItemCardGridClassKey = 'root';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'grid',\n      gridTemplateColumns: 'repeat(auto-fill, minmax(22em, 1fr))',\n      gridAutoRows: '1fr',\n      gridGap: theme.spacing(2),\n    },\n  });\n\nconst useStyles = makeStyles(styles, { name: 'BackstageItemCardGrid' });\n\n/** @public */\nexport type ItemCardGridProps = Partial<WithStyles<typeof styles>> & {\n  /**\n   * The Card items of the grid.\n   */\n  children?: React.ReactNode;\n};\n\n/**\n * A default grid to use when arranging \"item cards\" - cards that let users\n * select among several options.\n *\n * The immediate children are expected to be MUI Card components.\n *\n * Styles for the grid can be overridden using the `classes` prop, e.g.:\n *\n * `<ItemCardGrid title=\"Hello\" classes={{ root: myClassName }} />`\n *\n * This can be useful for e.g. overriding gridTemplateColumns to adapt the\n * minimum size of the cells to fit the content better.\n *\n * @public\n */\nexport function ItemCardGrid(props: ItemCardGridProps) {\n  const { children, ...otherProps } = props;\n  const classes = useStyles(otherProps);\n  return (\n    <div className={classes.root} {...otherProps}>\n      {children}\n    </div>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useContext } from 'react';\nimport { BackstageTheme } from '@backstage/theme';\nimport { makeStyles, ThemeProvider } from '@material-ui/core/styles';\nimport { SidebarPinStateContext } from '../Sidebar/Page';\n\nexport type PageClassKey = 'root';\n\nconst useStyles = makeStyles<BackstageTheme, { isMobile?: boolean }>(\n  () => ({\n    root: ({ isMobile }) => ({\n      display: 'grid',\n      gridTemplateAreas:\n        \"'pageHeader pageHeader pageHeader' 'pageSubheader pageSubheader pageSubheader' 'pageNav pageContent pageSidebar'\",\n      gridTemplateRows: 'max-content auto 1fr',\n      gridTemplateColumns: 'auto 1fr auto',\n      height: isMobile ? '100%' : '100vh',\n      overflowY: 'auto',\n    }),\n  }),\n  { name: 'BackstagePage' },\n);\n\ntype Props = {\n  themeId: string;\n  children?: React.ReactNode;\n};\n\nexport function Page(props: Props) {\n  const { themeId, children } = props;\n  const { isMobile } = useContext(SidebarPinStateContext);\n  const classes = useStyles({ isMobile });\n  return (\n    <ThemeProvider\n      theme={(baseTheme: BackstageTheme) => ({\n        ...baseTheme,\n        page: baseTheme.getPageTheme({ themeId }),\n      })}\n    >\n      <div className={classes.root}>{children}</div>\n    </ThemeProvider>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { PropsWithChildren, ComponentProps } from 'react';\n\nimport { Header } from '../Header';\nimport { Page } from './Page';\n\ntype PageWithHeaderProps = ComponentProps<typeof Header> & {\n  themeId: string;\n};\n\nexport function PageWithHeader(props: PropsWithChildren<PageWithHeaderProps>) {\n  const { themeId, children, ...restProps } = props;\n  return (\n    <Page themeId={themeId}>\n      <Header {...restProps} />\n      {children}\n    </Page>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageIdentityResponse,\n  ProfileInfo,\n} from '@backstage/core-plugin-api';\nimport { z } from 'zod';\n\nexport const proxiedSessionSchema = z.object({\n  providerInfo: z.object({}).catchall(z.unknown()).optional(),\n  profile: z.object({\n    email: z.string().optional(),\n    displayName: z.string().optional(),\n    picture: z.string().optional(),\n  }),\n  backstageIdentity: z.object({\n    token: z.string(),\n    identity: z.object({\n      type: z.literal('user'),\n      userEntityRef: z.string(),\n      ownershipEntityRefs: z.array(z.string()),\n    }),\n  }),\n});\n\n/**\n * Generic session information for proxied sign-in providers, e.g. common\n * reverse authenticating proxy implementations.\n *\n * @public\n */\nexport type ProxiedSession = {\n  providerInfo?: { [key: string]: unknown };\n  profile: ProfileInfo;\n  backstageIdentity: Omit<BackstageIdentityResponse, 'id'>;\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageUserIdentity,\n  discoveryApiRef,\n  IdentityApi,\n  ProfileInfo,\n} from '@backstage/core-plugin-api';\nimport { ResponseError } from '@backstage/errors';\nimport { ProxiedSession, proxiedSessionSchema } from './types';\n\nexport const DEFAULTS = {\n  // The amount of time between token refreshes, if we fail to get an actual\n  // value out of the exp claim\n  defaultTokenExpiryMillis: 5 * 60 * 1000,\n  // The amount of time before the actual expiry of the Backstage token, that we\n  // shall start trying to get a new one\n  tokenExpiryMarginMillis: 5 * 60 * 1000,\n} as const;\n\n// When the token expires, with some margin\nexport function tokenToExpiry(jwtToken: string | undefined): Date {\n  const fallback = new Date(Date.now() + DEFAULTS.defaultTokenExpiryMillis);\n  if (!jwtToken) {\n    return fallback;\n  }\n\n  const [_header, rawPayload, _signature] = jwtToken.split('.');\n  const payload = JSON.parse(atob(rawPayload));\n  if (typeof payload.exp !== 'number') {\n    return fallback;\n  }\n\n  return new Date(payload.exp * 1000 - DEFAULTS.tokenExpiryMarginMillis);\n}\n\ntype ProxiedSignInIdentityOptions = {\n  provider: string;\n  discoveryApi: typeof discoveryApiRef.T;\n};\n\ntype State =\n  | {\n      type: 'empty';\n    }\n  | {\n      type: 'fetching';\n      promise: Promise<ProxiedSession>;\n      previous: ProxiedSession | undefined;\n    }\n  | {\n      type: 'active';\n      session: ProxiedSession;\n      expiresAt: Date;\n    }\n  | {\n      type: 'failed';\n      error: Error;\n    };\n\n/**\n * An identity API that gets the user auth information solely based on a\n * provider's `/refresh` endpoint.\n */\nexport class ProxiedSignInIdentity implements IdentityApi {\n  private readonly options: ProxiedSignInIdentityOptions;\n  private readonly abortController: AbortController;\n  private state: State;\n\n  constructor(options: ProxiedSignInIdentityOptions) {\n    this.options = options;\n    this.abortController = new AbortController();\n    this.state = { type: 'empty' };\n  }\n\n  async start() {\n    // Try to make a first fetch, bubble up any errors to the caller\n    await this.getSessionAsync();\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getUserId} */\n  getUserId(): string {\n    const { backstageIdentity } = this.getSessionSync();\n    const ref = backstageIdentity.identity.userEntityRef;\n    const match = /^([^:/]+:)?([^:/]+\\/)?([^:/]+)$/.exec(ref);\n    if (!match) {\n      throw new TypeError(`Invalid user entity reference \"${ref}\"`);\n    }\n\n    return match[3];\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getIdToken} */\n  async getIdToken(): Promise<string | undefined> {\n    const session = await this.getSessionAsync();\n    return session.backstageIdentity.token;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getProfile} */\n  getProfile(): ProfileInfo {\n    const session = this.getSessionSync();\n    return session.profile;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getProfileInfo} */\n  async getProfileInfo(): Promise<ProfileInfo> {\n    const session = await this.getSessionAsync();\n    return session.profile;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getBackstageIdentity} */\n  async getBackstageIdentity(): Promise<BackstageUserIdentity> {\n    const session = await this.getSessionAsync();\n    return session.backstageIdentity.identity;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getCredentials} */\n  async getCredentials(): Promise<{ token?: string | undefined }> {\n    const session = await this.getSessionAsync();\n    return {\n      token: session.backstageIdentity.token,\n    };\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.signOut} */\n  async signOut(): Promise<void> {\n    this.abortController.abort();\n  }\n\n  getSessionSync(): ProxiedSession {\n    if (this.state.type === 'active') {\n      return this.state.session;\n    } else if (this.state.type === 'fetching' && this.state.previous) {\n      return this.state.previous;\n    }\n    throw new Error('No session available. Try reloading your browser page.');\n  }\n\n  async getSessionAsync(): Promise<ProxiedSession> {\n    if (this.state.type === 'fetching') {\n      return this.state.promise;\n    } else if (\n      this.state.type === 'active' &&\n      new Date() < this.state.expiresAt\n    ) {\n      return this.state.session;\n    }\n\n    const previous =\n      this.state.type === 'active' ? this.state.session : undefined;\n\n    const promise = this.fetchSession().then(\n      session => {\n        this.state = {\n          type: 'active',\n          session,\n          expiresAt: tokenToExpiry(session.backstageIdentity.token),\n        };\n        return session;\n      },\n      error => {\n        this.state = {\n          type: 'failed',\n          error,\n        };\n        throw error;\n      },\n    );\n\n    this.state = {\n      type: 'fetching',\n      promise,\n      previous,\n    };\n\n    return promise;\n  }\n\n  async fetchSession(): Promise<ProxiedSession> {\n    const baseUrl = await this.options.discoveryApi.getBaseUrl('auth');\n\n    // Note that we do not use the fetchApi here, since this all happens before\n    // sign-in completes so there can be no automatic token injection and\n    // similar.\n    const response = await fetch(\n      `${baseUrl}/${this.options.provider}/refresh`,\n      {\n        signal: this.abortController.signal,\n        headers: { 'x-requested-with': 'XMLHttpRequest' },\n        credentials: 'include',\n      },\n    );\n\n    if (!response.ok) {\n      throw await ResponseError.fromResponse(response);\n    }\n\n    return proxiedSessionSchema.parse(await response.json());\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  discoveryApiRef,\n  SignInPageProps,\n  useApi,\n} from '@backstage/core-plugin-api';\nimport React from 'react';\nimport { useAsync, useMountEffect } from '@react-hookz/web';\nimport { ErrorPanel } from '../../components/ErrorPanel';\nimport { Progress } from '../../components/Progress';\nimport { ProxiedSignInIdentity } from './ProxiedSignInIdentity';\n\n/**\n * Props for {@link ProxiedSignInPage}.\n *\n * @public\n */\nexport type ProxiedSignInPageProps = SignInPageProps & {\n  /**\n   * The provider to use, e.g. \"gcp-iap\" or \"aws-alb\". This must correspond to\n   * a properly configured auth provider ID in the auth backend.\n   */\n  provider: string;\n};\n\n/**\n * A sign-in page that has no user interface of its own. Instead, it relies on\n * sign-in being performed by a reverse authenticating proxy that Backstage is\n * deployed behind, and leverages its session handling.\n *\n * @remarks\n *\n * This sign-in page is useful when you are using products such as Google\n * Identity-Aware Proxy or AWS Application Load Balancer or similar, to front\n * your Backstage installation. This sign-in page implementation will silently\n * and regularly punch through the proxy to the auth backend to refresh your\n * frontend session information, without requiring user interaction.\n *\n * @public\n */\nexport const ProxiedSignInPage = (props: ProxiedSignInPageProps) => {\n  const discoveryApi = useApi(discoveryApiRef);\n\n  const [{ status, error }, { execute }] = useAsync(async () => {\n    const identity = new ProxiedSignInIdentity({\n      provider: props.provider,\n      discoveryApi,\n    });\n\n    await identity.start();\n\n    props.onSignInSuccess(identity);\n  });\n\n  useMountEffect(execute);\n\n  if (status === 'loading') {\n    return <Progress />;\n  } else if (error) {\n    return (\n      <ErrorPanel\n        title=\"You do not appear to be signed in. Please try reloading the browser page.\"\n        error={error}\n      />\n    );\n  }\n\n  return null;\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  IdentityApi,\n  ProfileInfo,\n  BackstageUserIdentity,\n} from '@backstage/core-plugin-api';\n\nexport class GuestUserIdentity implements IdentityApi {\n  getUserId(): string {\n    return 'guest';\n  }\n\n  async getIdToken(): Promise<string | undefined> {\n    return undefined;\n  }\n\n  getProfile(): ProfileInfo {\n    return {\n      email: 'guest@example.com',\n      displayName: 'Guest',\n    };\n  }\n\n  async getProfileInfo(): Promise<ProfileInfo> {\n    return {\n      email: 'guest@example.com',\n      displayName: 'Guest',\n    };\n  }\n\n  async getBackstageIdentity(): Promise<BackstageUserIdentity> {\n    const userEntityRef = `user:default/guest`;\n    return {\n      type: 'user',\n      userEntityRef,\n      ownershipEntityRefs: [userEntityRef],\n    };\n  }\n\n  async getCredentials(): Promise<{ token?: string | undefined }> {\n    return {};\n  }\n\n  async signOut(): Promise<void> {}\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  IdentityApi,\n  ProfileInfo,\n  BackstageUserIdentity,\n} from '@backstage/core-plugin-api';\n\nfunction parseJwtPayload(token: string) {\n  const [_header, payload, _signature] = token.split('.');\n  return JSON.parse(atob(payload));\n}\n\ntype LegacySignInResult = {\n  userId: string;\n  profile: ProfileInfo;\n  getIdToken?: () => Promise<string>;\n  signOut?: () => Promise<void>;\n};\n\n/** @internal */\nexport class LegacyUserIdentity implements IdentityApi {\n  private constructor(private readonly result: LegacySignInResult) {}\n\n  getUserId(): string {\n    return this.result.userId;\n  }\n\n  static fromResult(result: LegacySignInResult): LegacyUserIdentity {\n    return new LegacyUserIdentity(result);\n  }\n\n  async getIdToken(): Promise<string | undefined> {\n    return this.result.getIdToken?.();\n  }\n\n  getProfile(): ProfileInfo {\n    return this.result.profile;\n  }\n\n  async getProfileInfo(): Promise<ProfileInfo> {\n    return this.result.profile;\n  }\n\n  async getBackstageIdentity(): Promise<BackstageUserIdentity> {\n    const token = await this.getIdToken();\n\n    if (!token) {\n      const userEntityRef = `user:default/${this.getUserId()}`;\n      return {\n        type: 'user',\n        userEntityRef,\n        ownershipEntityRefs: [userEntityRef],\n      };\n    }\n\n    const { sub, ent } = parseJwtPayload(token);\n    return {\n      type: 'user',\n      userEntityRef: sub,\n      ownershipEntityRefs: ent ?? [],\n    };\n  }\n\n  async getCredentials(): Promise<{ token?: string | undefined }> {\n    const token = await this.result.getIdToken?.();\n    return { token };\n  }\n\n  async signOut(): Promise<void> {\n    return this.result.signOut?.();\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  IdentityApi,\n  ProfileInfo,\n  ProfileInfoApi,\n  BackstageUserIdentity,\n  BackstageIdentityApi,\n  SessionApi,\n} from '@backstage/core-plugin-api';\n\nimport { GuestUserIdentity } from './GuestUserIdentity';\nimport { LegacyUserIdentity } from './LegacyUserIdentity';\n\n// TODO(Rugvip): This and the other IdentityApi implementations still implement\n//               the old removed methods. This is to allow for backwards compatibility\n//               with old plugins that still consume this API. We will leave these in\n//               place as a hidden compatibility for a couple of months.\n//               The AppIdentityProxy warns in case any of these methods are called.\n\n/**\n * An implementation of the IdentityApi that is constructed using\n * various backstage user identity representations.\n *\n * @public\n */\nexport class UserIdentity implements IdentityApi {\n  private profilePromise?: Promise<ProfileInfo>;\n  /**\n   * Creates a new IdentityApi that acts as a Guest User.\n   *\n   * @public\n   */\n  static createGuest(): IdentityApi {\n    return new GuestUserIdentity();\n  }\n\n  /**\n   * Creates a new IdentityApi using a legacy SignInResult object.\n   *\n   * @public\n   */\n  static fromLegacy(result: {\n    /**\n     * User ID that will be returned by the IdentityApi\n     */\n    userId: string;\n\n    profile: ProfileInfo;\n\n    /**\n     * Function used to retrieve an ID token for the signed in user.\n     */\n    getIdToken?: () => Promise<string>;\n\n    /**\n     * Sign out handler that will be called if the user requests to sign out.\n     */\n    signOut?: () => Promise<void>;\n  }): IdentityApi {\n    return LegacyUserIdentity.fromResult(result);\n  }\n\n  /**\n   * Creates a new IdentityApi implementation using a user identity\n   * and an auth API that will be used to request backstage tokens.\n   *\n   * @public\n   */\n  static create(options: {\n    identity: BackstageUserIdentity;\n    authApi: ProfileInfoApi & BackstageIdentityApi & SessionApi;\n    /**\n     * Passing a profile synchronously allows the deprecated `getProfile` method to be\n     * called by consumers of the {@link @backstage/core-plugin-api#IdentityApi}. If you\n     * do not have any consumers of that method then this is safe to leave out.\n     *\n     * @deprecated Only provide this if you have plugins that call the synchronous `getProfile` method, which is also deprecated.\n     */\n    profile?: ProfileInfo;\n  }): IdentityApi {\n    return new UserIdentity(options.identity, options.authApi, options.profile);\n  }\n\n  private constructor(\n    private readonly identity: BackstageUserIdentity,\n    private readonly authApi: ProfileInfoApi &\n      BackstageIdentityApi &\n      SessionApi,\n    private readonly profile?: ProfileInfo,\n  ) {}\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getUserId} */\n  getUserId(): string {\n    const ref = this.identity.userEntityRef;\n    const match = /^([^:/]+:)?([^:/]+\\/)?([^:/]+)$/.exec(ref);\n    if (!match) {\n      throw new TypeError(`Invalid user entity reference \"${ref}\"`);\n    }\n\n    return match[3];\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getIdToken} */\n  async getIdToken(): Promise<string | undefined> {\n    const identity = await this.authApi.getBackstageIdentity();\n    return identity!.token;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getProfile} */\n  getProfile(): ProfileInfo {\n    if (!this.profile) {\n      throw new Error(\n        'The identity API does not implement synchronous profile fetching, use getProfileInfo() instead',\n      );\n    }\n    return this.profile;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getProfileInfo} */\n  async getProfileInfo(): Promise<ProfileInfo> {\n    if (this.profilePromise) {\n      return await this.profilePromise;\n    }\n\n    try {\n      this.profilePromise = this.authApi.getProfile() as Promise<ProfileInfo>;\n      return await this.profilePromise;\n    } catch (ex) {\n      this.profilePromise = undefined;\n      throw ex;\n    }\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getBackstageIdentity} */\n  async getBackstageIdentity(): Promise<BackstageUserIdentity> {\n    return this.identity;\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.getCredentials} */\n  async getCredentials(): Promise<{ token?: string | undefined }> {\n    const identity = await this.authApi.getBackstageIdentity();\n    return { token: identity!.token };\n  }\n\n  /** {@inheritdoc @backstage/core-plugin-api#IdentityApi.signOut} */\n  async signOut(): Promise<void> {\n    return this.authApi.signOut();\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\n\nexport type SignInPageClassKey = 'container' | 'item';\n\nexport const useStyles = makeStyles(\n  {\n    container: {\n      padding: 0,\n      listStyle: 'none',\n    },\n    item: {\n      display: 'flex',\n      flexDirection: 'column',\n      width: '100%',\n      maxWidth: '400px',\n      margin: 0,\n      padding: 0,\n    },\n  },\n  { name: 'BackstageSignInPage' },\n);\n\nexport const GridItem = ({ children }: { children: JSX.Element }) => {\n  const classes = useStyles();\n\n  return (\n    <Grid component=\"li\" item classes={classes}>\n      {children}\n    </Grid>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport { InfoCard } from '../InfoCard/InfoCard';\nimport {\n  ProviderComponent,\n  ProviderLoader,\n  SignInProvider,\n  SignInProviderConfig,\n} from './types';\nimport { useApi, errorApiRef } from '@backstage/core-plugin-api';\nimport { GridItem } from './styles';\nimport { ForwardedError } from '@backstage/errors';\nimport { UserIdentity } from './UserIdentity';\n\nconst Component: ProviderComponent = ({ config, onSignInSuccess }) => {\n  const { apiRef, title, message } = config as SignInProviderConfig;\n  const authApi = useApi(apiRef);\n  const errorApi = useApi(errorApiRef);\n\n  const handleLogin = async () => {\n    try {\n      const identityResponse = await authApi.getBackstageIdentity({\n        instantPopup: true,\n      });\n      if (!identityResponse) {\n        throw new Error(\n          `The ${title} provider is not configured to support sign-in`,\n        );\n      }\n\n      const profile = await authApi.getProfile();\n\n      onSignInSuccess(\n        UserIdentity.create({\n          identity: identityResponse.identity,\n          profile,\n          authApi,\n        }),\n      );\n    } catch (error) {\n      errorApi.post(new ForwardedError('Login failed', error));\n    }\n  };\n\n  return (\n    <GridItem>\n      <InfoCard\n        variant=\"fullHeight\"\n        title={title}\n        actions={\n          <Button color=\"primary\" variant=\"outlined\" onClick={handleLogin}>\n            Sign In\n          </Button>\n        }\n      >\n        <Typography variant=\"body1\">{message}</Typography>\n      </InfoCard>\n    </GridItem>\n  );\n};\n\nconst loader: ProviderLoader = async (apis, apiRef) => {\n  const authApi = apis.get(apiRef)!;\n\n  const identityResponse = await authApi.getBackstageIdentity({\n    optional: true,\n  });\n\n  if (!identityResponse) {\n    return undefined;\n  }\n\n  const profile = await authApi.getProfile();\n\n  return UserIdentity.create({\n    identity: identityResponse.identity,\n    profile,\n    authApi,\n  });\n};\n\nexport const commonProvider: SignInProvider = { Component, loader };\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport { InfoCard } from '../InfoCard/InfoCard';\nimport { GridItem } from './styles';\nimport { ProviderComponent, ProviderLoader, SignInProvider } from './types';\nimport { GuestUserIdentity } from './GuestUserIdentity';\n\nconst Component: ProviderComponent = ({ onSignInSuccess }) => (\n  <GridItem>\n    <InfoCard\n      title=\"Guest\"\n      variant=\"fullHeight\"\n      actions={\n        <Button\n          color=\"primary\"\n          variant=\"outlined\"\n          onClick={() => onSignInSuccess(new GuestUserIdentity())}\n        >\n          Enter\n        </Button>\n      }\n    >\n      <Typography variant=\"body1\">\n        Enter as a Guest User.\n        <br />\n        You will not have a verified identity,\n        <br />\n        meaning some features might be unavailable.\n      </Typography>\n    </InfoCard>\n  </GridItem>\n);\n\nconst loader: ProviderLoader = async () => {\n  return new GuestUserIdentity();\n};\n\nexport const guestProvider: SignInProvider = { Component, loader };\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { useForm, UseFormRegisterReturn } from 'react-hook-form';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport isEmpty from 'lodash/isEmpty';\nimport { InfoCard } from '../InfoCard/InfoCard';\nimport { ProviderComponent, ProviderLoader, SignInProvider } from './types';\nimport { GridItem } from './styles';\nimport { UserIdentity } from './UserIdentity';\n\n// accept base64url format according to RFC7515 (https://tools.ietf.org/html/rfc7515#section-3)\nconst ID_TOKEN_REGEX = /^[a-z0-9_\\-]+\\.[a-z0-9_\\-]+\\.[a-z0-9_\\-]+$/i;\n\n/** @public */\nexport type CustomProviderClassKey = 'form' | 'button';\n\nconst useFormStyles = makeStyles(\n  theme => ({\n    form: {\n      display: 'flex',\n      flexFlow: 'column nowrap',\n    },\n    button: {\n      alignSelf: 'center',\n      marginTop: theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageCustomProvider' },\n);\n\ntype Data = {\n  userId: string;\n  idToken?: string;\n};\n\nconst asInputRef = (renderResult: UseFormRegisterReturn) => {\n  const { ref, ...rest } = renderResult;\n  return {\n    inputRef: ref,\n    ...rest,\n  };\n};\n\nconst Component: ProviderComponent = ({ onSignInSuccess }) => {\n  const classes = useFormStyles();\n  const { register, handleSubmit, formState } = useForm<Data>({\n    mode: 'onChange',\n  });\n\n  const { errors } = formState;\n\n  const handleResult = ({ userId }: Data) => {\n    onSignInSuccess(\n      UserIdentity.fromLegacy({\n        userId,\n        profile: {\n          email: `${userId}@example.com`,\n        },\n      }),\n    );\n  };\n\n  return (\n    <GridItem>\n      <InfoCard title=\"Custom User\" variant=\"fullHeight\">\n        <Typography variant=\"body1\">\n          Enter your own User ID and credentials.\n          <br />\n          This selection will not be stored.\n        </Typography>\n\n        <form className={classes.form} onSubmit={handleSubmit(handleResult)}>\n          <FormControl>\n            <TextField\n              {...asInputRef(register('userId', { required: true }))}\n              label=\"User ID\"\n              margin=\"normal\"\n              error={Boolean(errors.userId)}\n            />\n            {errors.userId && (\n              <FormHelperText error>{errors.userId.message}</FormHelperText>\n            )}\n          </FormControl>\n          <FormControl>\n            <TextField\n              {...asInputRef(\n                register('idToken', {\n                  required: false,\n                  validate: token =>\n                    !token ||\n                    ID_TOKEN_REGEX.test(token) ||\n                    'Token is not a valid OpenID Connect JWT Token',\n                }),\n              )}\n              label=\"ID Token (optional)\"\n              margin=\"normal\"\n              autoComplete=\"off\"\n              error={Boolean(errors.idToken)}\n            />\n            {errors.idToken && (\n              <FormHelperText error>{errors.idToken.message}</FormHelperText>\n            )}\n          </FormControl>\n          <Button\n            type=\"submit\"\n            color=\"primary\"\n            variant=\"outlined\"\n            className={classes.button}\n            disabled={!formState?.isDirty || !isEmpty(errors)}\n          >\n            Continue\n          </Button>\n        </form>\n      </InfoCard>\n    </GridItem>\n  );\n};\n\n// Custom provider doesn't store credentials\nconst loader: ProviderLoader = async () => undefined;\n\nexport const customProvider: SignInProvider = { Component, loader };\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageUserIdentity,\n  IdentityApi,\n  ProfileInfo,\n} from '@backstage/core-plugin-api';\n\n// Similar to the AppIdentityApi we provide backwards compatibility for a limited time\ntype CompatibilityIdentityApi = IdentityApi & {\n  getUserId?(): string;\n  getIdToken?(): Promise<string | undefined>;\n  getProfile?(): ProfileInfo;\n};\n\nexport class IdentityApiSignOutProxy implements IdentityApi {\n  private constructor(\n    private readonly config: {\n      identityApi: CompatibilityIdentityApi;\n      signOut: IdentityApi['signOut'];\n    },\n  ) {}\n\n  static from(config: {\n    identityApi: CompatibilityIdentityApi;\n    signOut: IdentityApi['signOut'];\n  }): IdentityApi {\n    return new IdentityApiSignOutProxy(config);\n  }\n\n  getUserId(): string {\n    if (!this.config.identityApi.getUserId) {\n      throw new Error(`SignOutProxy IdentityApi.getUserId is not implemented`);\n    }\n    return this.config.identityApi.getUserId();\n  }\n\n  getIdToken(): Promise<string | undefined> {\n    if (!this.config.identityApi.getIdToken) {\n      throw new Error(`SignOutProxy IdentityApi.getIdToken is not implemented`);\n    }\n    return this.config.identityApi.getIdToken();\n  }\n\n  getProfile(): ProfileInfo {\n    if (!this.config.identityApi.getProfile) {\n      throw new Error(`SignOutProxy IdentityApi.getProfile is not implemented`);\n    }\n    return this.config.identityApi.getProfile();\n  }\n\n  getProfileInfo(): Promise<ProfileInfo> {\n    return this.config.identityApi.getProfileInfo();\n  }\n\n  getBackstageIdentity(): Promise<BackstageUserIdentity> {\n    return this.config.identityApi.getBackstageIdentity();\n  }\n\n  getCredentials(): Promise<{ token?: string | undefined }> {\n    return this.config.identityApi.getCredentials();\n  }\n\n  signOut(): Promise<void> {\n    return this.config.signOut();\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useLayoutEffect, useState, useMemo, useCallback } from 'react';\nimport {\n  SignInPageProps,\n  useApi,\n  useApiHolder,\n  errorApiRef,\n  IdentityApi,\n} from '@backstage/core-plugin-api';\nimport {\n  IdentityProviders,\n  SignInProvider,\n  SignInProviderConfig,\n} from './types';\nimport { commonProvider } from './commonProvider';\nimport { guestProvider } from './guestProvider';\nimport { customProvider } from './customProvider';\nimport { IdentityApiSignOutProxy } from './IdentityApiSignOutProxy';\n\nconst PROVIDER_STORAGE_KEY = '@backstage/core:SignInPage:provider';\n\nexport type SignInProviderType = {\n  [key: string]: {\n    components: SignInProvider;\n    id: string;\n    config?: SignInProviderConfig;\n  };\n};\n\nconst signInProviders: { [key: string]: SignInProvider } = {\n  guest: guestProvider,\n  custom: customProvider,\n  common: commonProvider,\n};\n\nfunction validateIDs(id: string, providers: SignInProviderType): void {\n  if (id in providers)\n    throw new Error(\n      `\"${id}\" ID is duplicated. IDs of identity providers have to be unique.`,\n    );\n}\n\nexport function getSignInProviders(\n  identityProviders: IdentityProviders,\n): SignInProviderType {\n  const providers = identityProviders.reduce(\n    (acc: SignInProviderType, config) => {\n      if (typeof config === 'string') {\n        validateIDs(config, acc);\n        acc[config] = { components: signInProviders[config], id: config };\n\n        return acc;\n      }\n\n      const { id } = config as SignInProviderConfig;\n      validateIDs(id, acc);\n\n      acc[id] = { components: signInProviders.common, id, config };\n\n      return acc;\n    },\n    {},\n  );\n\n  return providers;\n}\n\nexport const useSignInProviders = (\n  providers: SignInProviderType,\n  onSignInSuccess: SignInPageProps['onSignInSuccess'],\n) => {\n  const errorApi = useApi(errorApiRef);\n  const apiHolder = useApiHolder();\n  const [loading, setLoading] = useState(true);\n\n  // This decorates the result with sign out logic from this hook\n  const handleWrappedResult = useCallback(\n    (identityApi: IdentityApi) => {\n      onSignInSuccess(\n        IdentityApiSignOutProxy.from({\n          identityApi,\n          signOut: async () => {\n            localStorage.removeItem(PROVIDER_STORAGE_KEY);\n            await identityApi.signOut?.();\n          },\n        }),\n      );\n    },\n    [onSignInSuccess],\n  );\n\n  // In this effect we check if the user has already selected an existing login\n  // provider, and in that case try to load an existing session for the provider.\n  useLayoutEffect(() => {\n    if (!loading) {\n      return undefined;\n    }\n\n    // We can't use storageApi here, as it might have a dependency on the IdentityApi\n    const selectedProviderId = localStorage.getItem(\n      PROVIDER_STORAGE_KEY,\n    ) as string;\n\n    // No provider selected, let the user pick one\n    if (selectedProviderId === null) {\n      setLoading(false);\n      return undefined;\n    }\n\n    const provider = providers[selectedProviderId];\n    if (!provider) {\n      setLoading(false);\n      return undefined;\n    }\n\n    let didCancel = false;\n\n    provider.components\n      .loader(apiHolder, provider.config?.apiRef!)\n      .then(result => {\n        if (didCancel) {\n          return;\n        }\n        if (result) {\n          handleWrappedResult(result);\n        } else {\n          setLoading(false);\n        }\n      })\n      .catch(error => {\n        if (didCancel) {\n          return;\n        }\n        localStorage.removeItem(PROVIDER_STORAGE_KEY);\n        errorApi.post(error);\n        setLoading(false);\n      });\n\n    return () => {\n      didCancel = true;\n    };\n  }, [\n    loading,\n    errorApi,\n    onSignInSuccess,\n    apiHolder,\n    providers,\n    handleWrappedResult,\n  ]);\n\n  // This renders all available sign-in providers\n  const elements = useMemo(\n    () =>\n      Object.keys(providers).map(key => {\n        const provider = providers[key];\n\n        const { Component } = provider.components;\n\n        const handleSignInSuccess = (result: IdentityApi) => {\n          localStorage.setItem(PROVIDER_STORAGE_KEY, provider.id);\n\n          handleWrappedResult(result);\n        };\n\n        return (\n          <Component\n            key={provider.id}\n            config={provider.config!}\n            onSignInSuccess={handleSignInSuccess}\n          />\n        );\n      }),\n    [providers, handleWrappedResult],\n  );\n\n  return [loading, elements];\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageIdentityResponse,\n  configApiRef,\n  SignInPageProps,\n  useApi,\n} from '@backstage/core-plugin-api';\nimport { UserIdentity } from './UserIdentity';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport React, { useState } from 'react';\nimport { useMountEffect } from '@react-hookz/web';\nimport { Progress } from '../../components/Progress';\nimport { Content } from '../Content/Content';\nimport { ContentHeader } from '../ContentHeader/ContentHeader';\nimport { Header } from '../Header';\nimport { InfoCard } from '../InfoCard';\nimport { Page } from '../Page';\nimport { getSignInProviders, useSignInProviders } from './providers';\nimport { GridItem, useStyles } from './styles';\nimport { IdentityProviders, SignInProviderConfig } from './types';\n\ntype MultiSignInPageProps = SignInPageProps & {\n  providers: IdentityProviders;\n  title?: string;\n  align?: 'center' | 'left';\n};\n\ntype SingleSignInPageProps = SignInPageProps & {\n  provider: SignInProviderConfig;\n  auto?: boolean;\n};\n\nexport type Props = MultiSignInPageProps | SingleSignInPageProps;\n\nexport const MultiSignInPage = ({\n  onSignInSuccess,\n  providers = [],\n  title,\n  align = 'left',\n}: MultiSignInPageProps) => {\n  const configApi = useApi(configApiRef);\n  const classes = useStyles();\n\n  const signInProviders = getSignInProviders(providers);\n  const [loading, providerElements] = useSignInProviders(\n    signInProviders,\n    onSignInSuccess,\n  );\n\n  if (loading) {\n    return <Progress />;\n  }\n\n  return (\n    <Page themeId=\"home\">\n      <Header title={configApi.getString('app.title')} />\n      <Content>\n        {title && <ContentHeader title={title} textAlign={align} />}\n        <Grid\n          container\n          justifyContent={align === 'center' ? align : 'flex-start'}\n          spacing={2}\n          component=\"ul\"\n          classes={classes}\n        >\n          {providerElements}\n        </Grid>\n      </Content>\n    </Page>\n  );\n};\n\nexport const SingleSignInPage = ({\n  provider,\n  auto,\n  onSignInSuccess,\n}: SingleSignInPageProps) => {\n  const classes = useStyles();\n  const authApi = useApi(provider.apiRef);\n  const configApi = useApi(configApiRef);\n\n  const [error, setError] = useState<Error>();\n\n  // The SignIn component takes some time to decide whether the user is logged-in or not.\n  // showLoginPage is used to prevent a glitch-like experience where the sign-in page is\n  // displayed for a split second when the user is already logged-in.\n  const [showLoginPage, setShowLoginPage] = useState<boolean>(false);\n\n  type LoginOpts = { checkExisting?: boolean; showPopup?: boolean };\n  const login = async ({ checkExisting, showPopup }: LoginOpts) => {\n    try {\n      let identityResponse: BackstageIdentityResponse | undefined;\n      if (checkExisting) {\n        // Do an initial check if any logged-in session exists\n        identityResponse = await authApi.getBackstageIdentity({\n          optional: true,\n        });\n      }\n\n      // If no session exists, show the sign-in page\n      if (!identityResponse && (showPopup || auto)) {\n        // Unless auto is set to true, this step should not happen.\n        // When user intentionally clicks the Sign In button, autoShowPopup is set to true\n        setShowLoginPage(true);\n        identityResponse = await authApi.getBackstageIdentity({\n          instantPopup: true,\n        });\n        if (!identityResponse) {\n          throw new Error(\n            `The ${provider.title} provider is not configured to support sign-in`,\n          );\n        }\n      }\n\n      if (!identityResponse) {\n        setShowLoginPage(true);\n        return;\n      }\n\n      const profile = await authApi.getProfile();\n      onSignInSuccess(\n        UserIdentity.create({\n          identity: identityResponse.identity,\n          authApi,\n          profile,\n        }),\n      );\n    } catch (err: any) {\n      // User closed the sign-in modal\n      setError(err);\n      setShowLoginPage(true);\n    }\n  };\n\n  useMountEffect(() => login({ checkExisting: true }));\n\n  return showLoginPage ? (\n    <Page themeId=\"home\">\n      <Header title={configApi.getString('app.title')} />\n      <Content>\n        <Grid\n          container\n          justifyContent=\"center\"\n          spacing={2}\n          component=\"ul\"\n          classes={classes}\n        >\n          <GridItem>\n            <InfoCard\n              variant=\"fullHeight\"\n              title={provider.title}\n              actions={\n                <Button\n                  color=\"primary\"\n                  variant=\"outlined\"\n                  onClick={() => {\n                    login({ showPopup: true });\n                  }}\n                >\n                  Sign In\n                </Button>\n              }\n            >\n              <Typography variant=\"body1\">{provider.message}</Typography>\n              {error && error.name !== 'PopupRejectedError' && (\n                <Typography variant=\"body1\" color=\"error\">\n                  {error.message}\n                </Typography>\n              )}\n            </InfoCard>\n          </GridItem>\n        </Grid>\n      </Content>\n    </Page>\n  ) : (\n    <Progress />\n  );\n};\n\nexport function SignInPage(props: Props) {\n  if ('provider' in props) {\n    return <SingleSignInPage {...props} />;\n  }\n\n  return <MultiSignInPage {...props} />;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardHeader from '@material-ui/core/CardHeader';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport Tab, { TabProps } from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport React, {\n  PropsWithChildren,\n  ReactElement,\n  ReactNode,\n  useState,\n} from 'react';\nimport { BottomLink, BottomLinkProps } from '../BottomLink';\nimport { ErrorBoundary, ErrorBoundaryProps } from '../ErrorBoundary';\n\nexport type TabbedCardClassKey = 'root' | 'indicator';\n\nconst useTabsStyles = makeStyles(\n  theme => ({\n    root: {\n      padding: theme.spacing(0, 2, 0, 2.5),\n      minHeight: theme.spacing(3),\n    },\n    indicator: {\n      backgroundColor: theme.palette.info.main,\n      height: theme.spacing(0.3),\n    },\n  }),\n  { name: 'BackstageTabbedCard' },\n);\n\n/** @public */\nexport type BoldHeaderClassKey = 'root' | 'title' | 'subheader';\n\nconst BoldHeader = withStyles(\n  theme => ({\n    root: { padding: theme.spacing(2, 2, 2, 2.5), display: 'inline-block' },\n    title: { fontWeight: 700 },\n    subheader: { paddingTop: theme.spacing(1) },\n  }),\n  { name: 'BackstageTabbedCardBoldHeader' },\n)(CardHeader);\n\ntype Props = {\n  /** @deprecated Use errorBoundaryProps instead */\n  slackChannel?: string;\n  errorBoundaryProps?: ErrorBoundaryProps;\n  children?: ReactElement<TabProps>[];\n  onChange?: (event: React.ChangeEvent<{}>, value: number | string) => void;\n  title?: string;\n  value?: number | string;\n  deepLink?: BottomLinkProps;\n};\n\nexport function TabbedCard(props: PropsWithChildren<Props>) {\n  const {\n    slackChannel,\n    errorBoundaryProps,\n    children,\n    title,\n    deepLink,\n    value,\n    onChange,\n  } = props;\n  const tabsClasses = useTabsStyles();\n  const [selectedIndex, selectIndex] = useState(0);\n\n  const handleChange = onChange\n    ? onChange\n    : (_ev: unknown, newSelectedIndex: number) => selectIndex(newSelectedIndex);\n\n  let selectedTabContent: ReactNode;\n  if (!value) {\n    React.Children.map(children, (child, index) => {\n      if (React.isValidElement(child) && index === selectedIndex) {\n        selectedTabContent = child?.props.children;\n      }\n    });\n  } else {\n    React.Children.map(children, child => {\n      if (React.isValidElement(child) && child?.props.value === value) {\n        selectedTabContent = child?.props.children;\n      }\n    });\n  }\n\n  const errProps: ErrorBoundaryProps =\n    errorBoundaryProps || (slackChannel ? { slackChannel } : {});\n\n  return (\n    <Card>\n      <ErrorBoundary {...errProps}>\n        {title && <BoldHeader title={title} />}\n        <Tabs\n          selectionFollowsFocus\n          classes={tabsClasses}\n          value={value || selectedIndex}\n          onChange={handleChange}\n        >\n          {children}\n        </Tabs>\n        <Divider />\n        <CardContent>{selectedTabContent}</CardContent>\n        {deepLink && <BottomLink {...deepLink} />}\n      </ErrorBoundary>\n    </Card>\n  );\n}\n\n/** @public */\nexport type CardTabClassKey = 'root' | 'selected';\n\nconst useCardTabStyles = makeStyles(\n  theme => ({\n    root: {\n      minWidth: theme.spacing(6),\n      minHeight: theme.spacing(3),\n      margin: theme.spacing(0, 2, 0, 0),\n      padding: theme.spacing(0.5, 0, 0.5, 0),\n      textTransform: 'none',\n      '&:hover': {\n        opacity: 1,\n        backgroundColor: 'transparent',\n        color: theme.palette.text.primary,\n      },\n    },\n    selected: {\n      fontWeight: 'bold',\n    },\n  }),\n  { name: 'BackstageCardTab' },\n);\n\ntype CardTabProps = TabProps & {\n  children: ReactNode;\n};\n\n/**\n * Card tab component used in {@link TabbedCard}\n *\n * @public\n *\n */\nexport function CardTab(props: PropsWithChildren<CardTabProps>) {\n  const { children, ...restProps } = props;\n  const classes = useCardTabStyles();\n\n  return <Tab disableRipple classes={classes} {...restProps} />;\n}\n"],"names":["useStyles","MaterialLink","RouterLink","MaterialButton","Button","makeStyles","renderDefault","useTheme","Close","Link","classnames","ChevronRightIcon","Component","Table","useLocation","ArrowDropUp","ArrowDropDown","Tabs","TabUI","useFilterStyles","Select","ChevronLeft","styles","loader"],"mappings":"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"}