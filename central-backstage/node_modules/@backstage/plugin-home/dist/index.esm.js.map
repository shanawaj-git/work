{"version":3,"file":"index.esm.js","sources":["../src/components/SettingsModal.tsx","../src/components/HeaderWorldClock/HeaderWorldClock.tsx","../src/extensions.tsx","../src/routes.ts","../src/plugin.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n} from '@material-ui/core';\n\nexport const SettingsModal = ({\n  open,\n  close,\n  componentName,\n  children,\n}: {\n  open: boolean;\n  close: Function;\n  componentName: string;\n  children: JSX.Element;\n}) => {\n  return (\n    <Dialog open={open} onClose={() => close()}>\n      <DialogTitle>Settings - {componentName}</DialogTitle>\n      <DialogContent>{children}</DialogContent>\n      <DialogActions>\n        <Button onClick={() => close()} color=\"primary\" variant=\"contained\">\n          Close\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { HeaderLabel } from '@backstage/core-components';\n\nconst timeFormat: Intl.DateTimeFormatOptions = {\n  hour: '2-digit',\n  minute: '2-digit',\n};\n\ntype TimeObj = {\n  time: string;\n  label: string;\n};\n\nexport type ClockConfig = {\n  label: string;\n  timeZone: string;\n};\n\nfunction getTimes(clockConfigs: ClockConfig[]) {\n  const d = new Date();\n  const lang = window.navigator.language;\n\n  const clocks: TimeObj[] = [];\n\n  if (!clockConfigs) {\n    return clocks;\n  }\n\n  for (const clockConfig of clockConfigs) {\n    let label = clockConfig.label;\n\n    const options: Intl.DateTimeFormatOptions = {\n      timeZone: clockConfig.timeZone,\n      ...timeFormat,\n    };\n\n    try {\n      new Date().toLocaleString(lang, options);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `The timezone ${options.timeZone} is invalid. Defaulting to GMT`,\n      );\n      options.timeZone = 'GMT';\n      label = 'GMT';\n    }\n\n    const time = d.toLocaleTimeString(lang, options);\n    clocks.push({ time, label });\n  }\n\n  return clocks;\n}\n\nexport const HeaderWorldClock = ({\n  clockConfigs,\n}: {\n  clockConfigs: ClockConfig[];\n}) => {\n  const defaultTimes: TimeObj[] = [];\n  const [clocks, setTimes] = React.useState(defaultTimes);\n\n  React.useEffect(() => {\n    setTimes(getTimes(clockConfigs));\n\n    const intervalId = setInterval(() => {\n      setTimes(getTimes(clockConfigs));\n    }, 1000);\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [clockConfigs]);\n\n  if (clocks.length !== 0) {\n    return (\n      <>\n        {clocks.map(clock => (\n          <HeaderLabel\n            label={clock.label}\n            value={clock.time}\n            key={clock.label}\n          />\n        ))}\n      </>\n    );\n  }\n  return null;\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { Suspense } from 'react';\nimport { IconButton } from '@material-ui/core';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { InfoCard } from '@backstage/core-components';\nimport { SettingsModal } from './components';\nimport { createReactExtension, useApp } from '@backstage/core-plugin-api';\n\nexport type ComponentRenderer = {\n  Renderer?: (props: RendererProps) => JSX.Element;\n};\n\ntype ComponentParts = {\n  Content: (props?: any) => JSX.Element;\n  Actions?: () => JSX.Element;\n  Settings?: () => JSX.Element;\n  ContextProvider?: (props: any) => JSX.Element;\n};\n\ntype RendererProps = { title: string } & ComponentParts;\n\ntype CardExtensionProps<T> = ComponentRenderer & { title?: string } & T;\n\n/**\n * An extension creator to create card based components for the homepage\n *\n * @public\n */\nexport function createCardExtension<T>({\n  title,\n  components,\n  name,\n}: {\n  title: string;\n  components: () => Promise<ComponentParts>;\n  name?: string;\n}) {\n  return createReactExtension({\n    name,\n    component: {\n      lazy: () =>\n        components().then(({ Content, Actions, Settings, ContextProvider }) => {\n          const CardExtension = (props: CardExtensionProps<T>) => {\n            const { Renderer, title: overrideTitle, ...childProps } = props;\n            const app = useApp();\n            const { Progress } = app.getComponents();\n            const [settingsOpen, setSettingsOpen] = React.useState(false);\n\n            if (Renderer) {\n              return (\n                <Suspense fallback={<Progress />}>\n                  <Renderer\n                    title={overrideTitle || title}\n                    {...{\n                      Content,\n                      ...(Actions ? { Actions } : {}),\n                      ...(Settings ? { Settings } : {}),\n                      ...(ContextProvider ? { ContextProvider } : {}),\n                      ...childProps,\n                    }}\n                  />\n                </Suspense>\n              );\n            }\n\n            const cardProps = {\n              title: overrideTitle ?? title,\n              ...(Settings\n                ? {\n                    action: (\n                      <IconButton onClick={() => setSettingsOpen(true)}>\n                        <SettingsIcon>Settings</SettingsIcon>\n                      </IconButton>\n                    ),\n                  }\n                : {}),\n              ...(Actions\n                ? {\n                    actions: <Actions />,\n                  }\n                : {}),\n            };\n\n            const innerContent = (\n              <InfoCard {...cardProps}>\n                {Settings && (\n                  <SettingsModal\n                    open={settingsOpen}\n                    componentName={title}\n                    close={() => setSettingsOpen(false)}\n                  >\n                    <Settings />\n                  </SettingsModal>\n                )}\n                <Content {...childProps} />\n              </InfoCard>\n            );\n\n            return (\n              <Suspense fallback={<Progress />}>\n                {ContextProvider ? (\n                  <ContextProvider {...childProps}>\n                    {innerContent}\n                  </ContextProvider>\n                ) : (\n                  innerContent\n                )}\n              </Suspense>\n            );\n          };\n          return CardExtension;\n        }),\n    },\n  });\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createRouteRef } from '@backstage/core-plugin-api';\n\nexport const rootRouteRef = createRouteRef({\n  id: 'home',\n});\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  createComponentExtension,\n  createPlugin,\n  createRoutableExtension,\n} from '@backstage/core-plugin-api';\nimport { createCardExtension } from './extensions';\nimport { ToolkitContentProps } from './homePageComponents';\n\nimport { rootRouteRef } from './routes';\n\nexport const homePlugin = createPlugin({\n  id: 'home',\n  routes: {\n    root: rootRouteRef,\n  },\n});\n\nexport const HomepageCompositionRoot = homePlugin.provide(\n  createRoutableExtension({\n    name: 'HomepageCompositionRoot',\n    component: () =>\n      import('./components').then(m => m.HomepageCompositionRoot),\n    mountPoint: rootRouteRef,\n  }),\n);\n\nexport const ComponentAccordion = homePlugin.provide(\n  createComponentExtension({\n    name: 'ComponentAccordion',\n    component: {\n      lazy: () =>\n        import('./componentRenderers').then(m => m.ComponentAccordion),\n    },\n  }),\n);\nexport const ComponentTabs = homePlugin.provide(\n  createComponentExtension({\n    name: 'ComponentTabs',\n    component: {\n      lazy: () => import('./componentRenderers').then(m => m.ComponentTabs),\n    },\n  }),\n);\nexport const ComponentTab = homePlugin.provide(\n  createComponentExtension({\n    name: 'ComponentTab',\n    component: {\n      lazy: () => import('./componentRenderers').then(m => m.ComponentTab),\n    },\n  }),\n);\n\n/**\n * A component to display a playful greeting for the user.\n *\n * @public\n */\nexport const WelcomeTitle = homePlugin.provide(\n  createComponentExtension({\n    name: 'WelcomeTitle',\n    component: {\n      lazy: () =>\n        import('./homePageComponents/WelcomeTitle').then(m => m.WelcomeTitle),\n    },\n  }),\n);\n\n/**\n * A component to display a company logo for the user.\n *\n * @public\n */\nexport const HomePageCompanyLogo = homePlugin.provide(\n  createComponentExtension({\n    name: 'CompanyLogo',\n    component: {\n      lazy: () =>\n        import('./homePageComponents/CompanyLogo').then(m => m.CompanyLogo),\n    },\n  }),\n);\n\nexport const HomePageRandomJoke = homePlugin.provide(\n  createCardExtension<{ defaultCategory?: 'any' | 'programming' }>({\n    name: 'HomePageRandomJoke',\n    title: 'Random Joke',\n    components: () => import('./homePageComponents/RandomJoke'),\n  }),\n);\n\n/**\n * A component to display a list of tools for the user.\n *\n * @public\n */\nexport const HomePageToolkit = homePlugin.provide(\n  createCardExtension<ToolkitContentProps>({\n    name: 'HomePageToolkit',\n    title: 'Toolkit',\n    components: () => import('./homePageComponents/Toolkit'),\n  }),\n);\n\n/**\n * A component to display a list of starred entities for the user.\n *\n * @public\n */\nexport const HomePageStarredEntities = homePlugin.provide(\n  createCardExtension({\n    name: 'HomePageStarredEntities',\n    title: 'Your Starred Entities',\n    components: () => import('./homePageComponents/StarredEntities'),\n  }),\n);\n"],"names":[],"mappings":"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"}